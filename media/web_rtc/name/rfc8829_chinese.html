<!DOCTYPE html>
<!-- saved from url=(0045)https://datatracker.ietf.org/doc/html/rfc8829 -->
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>

    rfc8829

</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>

  @media only screen
    and (min-width: 992px)
    and (max-width: 1199px) {
      body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen
    and (min-width: 768px)
    and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen
    and (min-width: 480px)
    and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen
    and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen
    and (min-device-width : 375px)
    and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0; }
        }
  @media only screen
    and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
      font-weight: bold;
            /* line-height: 0pt; */
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
      font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
  .pre {
      white-space: pre;
      font-family: monospace;
  }
  .header{
      font-weight: bold;
  }
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        @media print {
            body {
                margin-top: 5em;
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }

            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
  @media screen {
      .grey, .grey a:link, .grey a:visited {
    color: #777;
      }
            .meta-info {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .pad {
                padding-top: 7px;
                line-height: 24px;
                padding-bottom: 4px;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
  }



.bgwhite  { background-color: white; }
.bgred    { background-color: #F44; }
.bggrey   { background-color: #666; }
.bgbrown  { background-color: #840; }
.bgorange { background-color: #FA0; }
.bgyellow { background-color: #EE0; }
.bgmagenta{ background-color: #F4F; }
.bgblue   { background-color: #66F; }
.bgcyan   { background-color: #4DD; }
.bggreen  { background-color: #4F4; }

.draftcontent { margin-top:0px !important;}


    </style>


  <link rel="alternate" type="application/atom+xml" title="Document changes" href="https://datatracker.ietf.org/feed/document-changes/draft-ietf-rtcweb-jsep/">
  <meta name="description" content="JavaScript Session Establishment Protocol (JSEP) (RFC )">



    <link rel="shortcut icon" href="https://www.ietf.org/lib/dt/7.41.0/ietf/images/ietf-icon-blue3.png">

    <link rel="apple-touch-icon" href="https://www.ietf.org/lib/dt/7.41.0/ietf/images/apple-touch-icon.png">
  </head>

  <body style="padding-top: 0;">

	  <div class="content" id="content">

  <!-- template: /a/www/ietf-datatracker/web/ietf/templates/doc/document_html.html -->

  <div class="rfcmarkup">
    <div class="noprint" style="height: 6px;">
      <div onmouseover="this.style.cursor=&#39;pointer&#39;;" onclick="showLegend();" onmouseout="hideLegend()" style="height: 6px; min-height: 6px; width: 96ex; position: absolute; margin-top:0; " class="meta-info bgblue" title="Click for colour legend.">&nbsp;</div>
      <div id="legend" class="meta-info noprint pre legend" style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; " onmouseover="showLegend();" onmouseout="hideLegend();">
      </div>
    </div>


      <div class="noprint">
	 <pre class="pre meta-info">[<a href="https://datatracker.ietf.org/" title="Document search and retrieval page">Search</a>] [<a href="https://www.rfc-editor.org/rfc/rfc8829.txt" title="Plaintext version of this document">txt</a>|<a href="https://www.rfc-editor.org/rfc/rfc8829.html" title="HTML version of this document, from XML2RFC">html</a>|<a href="https://www.rfc-editor.org/rfc/rfc8829.xml" title="XML source for this document">xml</a>|<a href="https://www.rfc-editor.org/rfc/rfc8829.pdf" title="PDF version of this document">pdf</a>|<a href="https://datatracker.ietf.org/doc/rfc8829/bibtex" title="BibTex entry for this document">bibtex</a>] [<a href="https://datatracker.ietf.org/doc/rfc8829/" title="Datatracker information for this document">Tracker</a>] [<a href="https://datatracker.ietf.org/group/rtcweb/" title="The working group handling this document">WG</a>] [<a href="mailto:draft-ietf-rtcweb-jsep@ietf.org?subject=draft-ietf-rtcweb-jsep" title="Send email to the document authors">Email</a>] [<a href="https://www.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=draft-ietf-rtcweb-jsep-26.txt" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://www.ietf.org/rfcdiff?url2=draft-ietf-rtcweb-jsep-26.txt" title="Side-by-side diff">Diff2</a>] [<a href="https://www.ietf.org/tools/idnits?url=https://www.ietf.org/archive/id/draft-ietf-rtcweb-jsep-26.txt" title="Run an idnits check of this document">Nits</a>]

From: <a href="https://datatracker.ietf.org/doc/html/draft-ietf-rtcweb-jsep-26">draft-ietf-rtcweb-jsep-26</a>                        Proposed Standard</pre>
      </div>


    <div class="draftcontent">
    <pre>Internet Engineering Task Force (IETF)                         J. Uberti
Request for Comments: 8829                                        Google
Category: Standards Track                                    C. Jennings
ISSN: 2070-1721                                                    Cisco
                                                        E. Rescorla, Ed.
                                                                 Mozilla
                                                            January 2021


            <span class="h1">JavaScript 会话建立协议 (JSEP)</span>

摘要

   该文档用于描述 JavaScrip 应用通过 W3C RTCPeerConnection API 指定的接口控制多
   媒体会话的信令层(signaling plane) 的机制，同时演示如何利用现有的协议。


该备忘录状态

   这是一个互联网标准追踪文档。

   该文档时互联网工程工作组(IETF)的产出。它代表了 IETF 社区的共识。它已经接受了公众
   检查，并已获互联网工程指导小组(IESG)发布批准。  有关互联网标准的更多资料，请参阅
   <a href="https://datatracker.ietf.org/doc/html/rfc7841#section-2">Section&nbsp;2 of RFC 7841</a>.

   有关本文档当前状态的信息，勘误表以及如何提供反馈可以在
   <a href="https://www.rfc-editor.org/info/rfc8829">https://www.rfc-editor.org/info/rfc8829</a>查看。

版权公告

   版权所有(c)2021 IETF信托基金和认定的文档作者所有权利。

   本文件须遵守<a href="https://datatracker.ietf.org/doc/html/bcp78">BCP 78</a>和自本文件发布之日起生效的IETF信托基金关于IETF文件
   (<a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a>)的法律规定的约束。请仔细阅读这些文件，
   因为它描述了对于本文件你拥有的权利和义务。从本文档中提取的代码组件必须包括简化的
   BSD 许可 4.e 节的许可文本，并且根据简化的 BSD 许可的规定不提供担保。


目录

   1.  前言
     1.1.  JSEP 的整体设计
     1.2.  淘汰的方案
     1.3.  bundle-only "m=" 块的矛盾
   2.  术语
   3.  语义和语法
     3.1.  信令模型
     3.2.  会话描述和状态机
     3.3.  会话描述的格式
     3.4.  会话描述的控制
       3.4.1.  RtpTransceivers
       3.4.2.  RtpSenders
       3.4.3.  RtpReceivers
     3.5.  ICE
       3.5.1.  ICE 收集概述
       3.5.2.  ICE 候选网络涓流
         3.5.2.1.  ICE 候选网络格式
       3.5.3.  ICE 候选策略
       3.5.4.  ICE 候选网络池
       3.5.5.  ICE 版本
     3.6.  视频尺寸协商
       3.6.1.  创建 imageattr 属性
       3.6.2.  解析 imageattr 属性
     3.7.  联播
     3.8.  分叉的影响
       3.8.1.  顺序分支
       3.8.2.  平行分叉
   4.  接口
     4.1.  PeerConnection
       4.1.1.  Constructor
       4.1.2.  addTrack
       4.1.3.  removeTrack
       4.1.4.  addTransceiver
       4.1.5.  onaddtrack Event
       4.1.6.  createDataChannel
       4.1.7.  ondatachannel Event
       4.1.8.  createOffer
       4.1.9.  createAnswer
       4.1.10. SessionDescriptionType
         4.1.10.1.  使用临时应答
         4.1.10.2.  回退
       4.1.11. setLocalDescription
       4.1.12. setRemoteDescription
       4.1.13. currentLocalDescription
       4.1.14. pendingLocalDescription
       4.1.15. currentRemoteDescription
       4.1.16. pendingRemoteDescription
       4.1.17. canTrickleIceCandidates
       4.1.18. setConfiguration
       4.1.19. addIceCandidate
       4.1.20. onicecandidate Event
     4.2.  RtpTransceiver
       4.2.1.  stop
       4.2.2.  stopped
       4.2.3.  setDirection
       4.2.4.  direction
       4.2.5.  currentDirection
       4.2.6.  setCodecPreferences
   5.  SDP 的交换过程
     5.1.  要求概述
       5.1.1.  使用要求
       5.1.2.  配置文件名称和互操作性
     5.2.  构建一个邀约
       5.2.1.  初始邀约
       5.2.2.  后继邀约
       5.2.3.  选项处理
         5.2.3.1.  IceRestart
         5.2.3.2.  VoiceActivityDetection
     5.3.  生成应答
       5.3.1.  初始应答
       5.3.2.  后继应答
       5.3.3.  选项处理
         5.3.3.1.  VoiceActivityDetection
     5.4.  更改邀约和应答
     5.5.  处理本端描述
     5.6.  处理远端描述
     5.7.  处理回退
     5.8.  解析会话描述
       5.8.1.  会话层解析
       5.8.2.  媒体部分解析
       5.8.3.  语义验证
     5.9.  应用本地描述
     5.10. 应用远程描述
     5.11. 应用一个应答
   6.  处理 RTP/RTCP
   7.  实例
     7.1.  简单示例
     7.2.  详细示例
     7.3.  早期传输示例
   8.  考虑安全因素
   9.  考虑 IANA 因素
   10. 参考文献
     10.1.  标准文献
     10.2.  信息参考文献
   <a href="https://datatracker.ietf.org/doc/html/rfc8829#appendix-A">附录 A</a>.  SDP ABNF 语法
   鸣谢
   作者的地址

<span class="h2"><a class="selflink" id="section-1" href="https://datatracker.ietf.org/doc/html/rfc8829#section-1">1</a>.  前言</span>

   该文档描述 W3C 网页实时通信 (WebRTC) RTCPeerConnection 接口[<a href="https://datatracker.ietf.org/doc/html/rfc8829#ref-W3C.webrtc">W3C.webrtc</a>]如何
   用于控制多媒体会话的建立、管理和结束。

<span class="h3"><a class="selflink" id="section-1.1" href="https://datatracker.ietf.org/doc/html/rfc8829#section-1.1">1.1</a>.  JSEP 的整体设计</span>

   WebRTC 呼叫建立被设计为专注于控制媒体层，尽量将信令层行为交给应用。 理由是不同的
   应用可能更愿意使用不同的协议，如现有的 SIP 呼叫信令协议， 或针对特定应用程序对于
   一个新的用例定制的协议。这种实现中，需要交换的关键信息是对媒体会话信息，用于指定建
   立媒体层所需的传输和媒体配置信息。

   基于以上的思想，该文档的 JavaScript 会话建立协议(JSEP) 允许 JavaScript
   完全控制信令状态机。如前所述，JSEP 假定了 JavaScript 运行在一个具有 WebRTC
   APIs (JSEP 的实现)的运行环境的模型中。JSEP 实现几乎完全从信令流中脱离，而是由
   JavaScript 通过如下两类 API 处理： (1) 传递本地和远端的会话描述以及 (2) 与交
   互式媒体建立状态机交互(ICE)[<a href="https://datatracker.ietf.org/doc/html/rfc8445" title="&quot;Interactive Connectivity Establishment (ICE): A Protocol for Network Address Translator (NAT) Traversal&quot;">RFC8445</a>].
   在该文档中将 JSEP 实现和 JavaScript 应用程序的整体称为“JSEP 端点”。

   该文档中描述的 JSEP 使用总是发生在 JSEP 端点之间。尽管有很多发生在 JSEP 断点和
   某种服务器之间用例，例如网关或多点控制单元(MCU)。这种不同对于 JSEP 端点是透明的；
   它只是遵循 API 的规定。

   JSEP 的会话描述非常简单直接。每次需要交换 offer/answer 的时候，发起端通过调用
   createOffer API 创建一个 offer。然后应用使用创建的 offer 通过
   setLocalDescription API 调用设置本地的配置。该 offer 最终通过用户选择的信令
   机制(e.g.,WebSockets)发送给远端；远端一旦收到该 offer，就通过 setRemoteDescription
   API 进行设置。

   为了完成 offer/answer 交换, 远端通过 createAnswer API 产生一个对应的 answer，
   并通过信令渠道将其返还给发起端。当发起端收到 answer后就使用 setRemoteDescription
   API 进行设置。可以重复该过程进行更多的 offer/answer 交换。

   关于 ICE [<a href="https://datatracker.ietf.org/doc/html/rfc8445" title="&quot;Interactive Connectivity Establishment (ICE): A Protocol for Network Address Translator (NAT) Traversal&quot;">RFC8445</a>], JSEP将ICE状态机从整个信令状态机中解耦出来。
   ICE 状态机也必须在 JSEP 中实现，因为只有该实现具有必要的候选者和传输信息。
   实行分离在协议上提供了额外的灵活性，将话描述从传输中解耦。例如，传统的SIP中，每个
   offer 和 answer 包括会话描述和传输信息都是独立的。 提供或回答都是自包含的。
   然而， [<a href="https://datatracker.ietf.org/doc/html/rfc8840" title="&quot;A Session Initiation Protocol (SIP) Usage for Incremental Provisioning of Candidates for the Interactive Connectivity Establishment (Trickle ICE)&quot;">RFC8840</a>] 允许 SIP 用于 ICE 涓流
   [<a href="https://datatracker.ietf.org/doc/html/rfc8838" title="&quot;Trickle ICE: Incremental Provisioning of Candidates for the Interactive Connectivity Establishment (ICE) Protocol&quot;">RFC8838</a>]，即会话描述可以立即发送而
   传输信息可以等获取到才发送。传输信息分离发送可以加速 ICE 和 DTLS 设置，因为
   ICE 检查可以在任意传输信息获取到即可开始，而不必等到所有的传输信息。JSEP 对 ICE
   和信令状态机的解耦使其能够适应这两种模型。

   尽管 JSEP 已经抽象了信令，但其要求应用知道信令的流程。而应用建立通话并不需要理解
   会话描述的内容，应用必须在正确的时间调用对应的 API，将会话描述和 ICE 信息转换为
   所选信令协议定义的消息格式, 在另一端再将信令消息转换回来。

   将这一流程简化的一个方法是提供一个 JavaScript 库以将复杂性对开发者隐藏；该库将
   实现给定的信令协议及其状态机和序列化代码，为应用程序开发人员提供更高级别的面向调用
   的接口。例如，在 JSEP API 之上的，已有的 SIP [<a href="https://datatracker.ietf.org/doc/html/rfc3261" title="&quot;SIP: Session Initiation Protocol&quot;">RFC3261</a>] 实现库和
   以及可扩展的消息传递协议 (XMPP) [<a href="https://datatracker.ietf.org/doc/html/rfc6120" title="&quot;Extensible Messaging and Presence Protocol (XMPP): Core&quot;">RFC6120</a>] 信令协议。
   因此，JSEP 为经验丰富的开发人员提供更多的控制能力，而不会给新手带来任何额外的复杂性。

<span class="h3"><a class="selflink" id="section-1.2" href="https://datatracker.ietf.org/doc/html/rfc8829#section-1.2">1.2</a>.  淘汰的方案</span>

   考虑过的一种 JSEP 替代实现是提供一个轻量级的信令协议。相比于会话描述的 API，该 API
   将自我产生和消费消息。然而提供这样一个 API 将更多的信令控制交给 JSEP 实现，迫使其理
   解和处理 signaling glare (see <a href="https://datatracker.ietf.org/doc/html/rfc3264#section-4">[RFC3264], Section&nbsp;4</a>)的概念。

   另一种没有使用的方案是将媒体控制对象的管理与会话描述解耦，取而代之的是提供可以直接控制
   每个组件的 API。这个提议被拒绝的原因是是：要求对应用程序开发者暴露这种级别的复杂性对
   他们没有好处；这将 (1) 导致这样即使是一个简单的例子，也需要大量的 API 来协调所有需要
   的交互，以及(2) 创建一个大型的 API 界面，需要各方达成一致并形成文档。此外，这些 API
   点可以按任何顺序调用，导致与媒体子系统的交互集比 JSEP 指定如何产生和应用媒体描述的方法
   更复杂。

   JSEP 的一种变体是保留基本的面向会话描述的 API，但将生成 offer 和 answer 的机制移出
   JSEP 的实现。该方法将暴露 getCapabilities API，而不是提供 createOffer/
   createAnswer 方法，getCapabilities API 将向应用程序提供自己生成会话描述所需的信息。
   这大大增加了应用程序的工作量；它需要知道如何从具有的功能信息生成会话描述，特别是如何从任
   意 offer 和支持的功能正确生成 answer。当然这可以通过使用类似于上面提到的库来解决，但
   它却迫使我们使用该库，即使是对于一个简单的例子。提供 createoffer/createanswer 避免了
   此问题。

<span class="h3"><a class="selflink" id="section-1.3" href="https://datatracker.ietf.org/doc/html/rfc8829#section-1.3">1.3</a>.  关于“m=”块中 bundle-only 的矛盾</span>

   自从 WebRTC 规范文档获得批准以来，IETF 已经意识到指定 JSEP 的文档和指定 BUNDLE (this RFC and [<a href="https://datatracker.ietf.org/doc/html/rfc8843" title="&quot;Negotiating Media Multiplexing Using the Session Description Protocol (SDP)&quot;">RFC8843</a>],
   respectively) 的文档之间存在不一致。相比于为了达成一致决议而进一步推迟公布，该
   文档按照原有的计划进行发布。IETF 打算重新启动这些技术的工作，一旦有了解决方案，
   这些文件的修订版将会发布。

   这个问题涉及到对 “m=” 部分的处理，正如该 RFC <a href="https://datatracker.ietf.org/doc/html/rfc8829#section-4.1.1">Section 4.1.1</a>
   讨论的这些部分被设计为 bundle-only。当前 JSEP 和 BUNDLE 以及这些规范和现有浏
   览器实现之间的差异是：

   *  JSEP 规定，“m=”部分应该使用端口 0，并在初始 offer 中添加 “a=bundle-only”
      属性，而在 answer 或后续 offer 中不包含。

   *  BUNDLE 规定 "m=" 部分对该部分描述应该跟前一描述一致，即在所有的 offer 和
      answer 中。

   *  大多数当前的浏览器不使用 0 端口标记 ”m=” 部分并且对所有标记为 bundled 的
      “m=” 部分使用相同的端口；其它一些则遵守 JSEP 的行为。

<span class="h2"><a class="selflink" id="section-2" href="https://datatracker.ietf.org/doc/html/rfc8829#section-2">2</a>.  术语</span>

   关键词 "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD",
   "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", 和 "OPTIONAL"
   在该文档中应该遵循<a href="https://datatracker.ietf.org/doc/html/bcp14">BCP 14</a> [<a href="https://datatracker.ietf.org/doc/html/rfc2119" title="&quot;Key words for use in RFCs to Indicate Requirement Levels&quot;">RFC2119</a>] [<a href="https://datatracker.ietf.org/doc/html/rfc8174" title="&quot;Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words&quot;">RFC8174</a>] 解释，当和仅当，它们以大写形式出现，如下所示。

<span class="h2"><a class="selflink" id="section-3" href="https://datatracker.ietf.org/doc/html/rfc8829#section-3">3</a>.  语义和语法</span>

<span class="h3"><a class="selflink" id="section-3.1" href="https://datatracker.ietf.org/doc/html/rfc8829#section-3.1">3.1</a>.  信令模型</span>

   JSEP 没有指定特定的信令模型或状态机，而是使用 [<a href="https://datatracker.ietf.org/doc/html/rfc3264" title="&quot;An Offer/Answer Model with Session Description Protocol (SDP)&quot;">RFC3264</a>] (offer/answer) 描述的通用的会话描述(提供答案)，
   以便会话双方知道如何进行会话。JSEP 提供创建 offers 和 answers，以及
   将其应用于会话的机制。然而，JSEP 实现完全与实际的机制解耦，offer 和 answer通
   过这种机制传递到远程端，包括寻址、重传、分叉和 glare（眩光）处理。 这些问题完全
   取决于应用程序，应用程序对哪个 offers 和 answers 以及何时交给 JSEP 具有完全
   的控制。

         +-----------+                               +-----------+
         |  Web App  |&lt;------- 应用选择的信令 ---------&gt;|  Web App  |
         +-----------+                               +-----------+
               ^                                            ^
               |  SDP                                       |  SDP
               V                                            V
         +-----------+                                +-----------+
         |   JSEP    |&lt;----------- Media ------------&gt;|   JSEP    |
         |   Impl.   |                                |   Impl.   |
         +-----------+                                +-----------+

                       Figure 1: JSEP 信令模型

<span class="h3"><a class="selflink" id="section-3.2" href="https://datatracker.ietf.org/doc/html/rfc8829#section-3.2">3.2</a>.  会话描述和状态机</span>

   为了建立多媒体层，JSEP 实现需要指定参数来指示向远端传输什么，以及如何处理收到的
   媒体。这些参数是通过交换 offer/answer 会话描述来确定的，而且该流程中有一些细节
   必须在 JSEP API 中处理。

   会话描述是应用在本端还是远端影响到会话描述的意义。例如，发送给远端的编解码列表表
   示本端将接收何种编解码格式，当与远程端支持的编解码器集相交时，指定远程端应该发送
   什么。然而，不是所有的参数遵循该规则；有些参数是声明性的，远程端必须接受或完全拒
   绝它们。一个示例是使用在 DTLS [<a href="https://datatracker.ietf.org/doc/html/rfc6347" title="&quot;Datagram Transport Layer Security Version 1.2&quot;">RFC6347</a>] 上线文的 TLS 指纹 [<a href="https://datatracker.ietf.org/doc/html/rfc8122" title="&quot;Connection-Oriented Media Transport over the Transport Layer Security (TLS) Protocol in the Session Description Protocol (SDP)&quot;">RFC8122</a>]；
   这些指纹是基于本地提供的证书计算的，不受协商的影响。

   此外，不同的 RFC 对 offers 和 answers 的格式提出了不同的要求。例如，offer 可
   以提供任意数量的 “m=” 部分 (i.e., media descriptions as described in <a href="https://datatracker.ietf.org/doc/html/rfc4566#section-5.14">[RFC4566], Section&nbsp;5.14</a>)，
   但 answer 必须包含与 offer 相同的数量的 “m=” 部分。

   最后，虽然确切的媒体参数只有在一个 offer 和 answer 交换之后才知道，但呼叫者可能
   会在收到 offer 之前收到 ICE 检查和可能的媒体(例如，在一个连接建立后的重新邀约)。
   在这种情况下，为了正确处理传入的媒体，呼叫方的媒体处理程序必须在 answer 到达之前
   了解 offer 的细节。

   因此，为了正确处理会话描述，JSEP实现需要：

   1.  了解会话描述是属于本端还是远端。

   2.  了解一个会话描述是一个 offer 还是 answer。

   3.  允许 offer 独立于 answer 进行设置。

   JSEP 通过添加 setLocalDescription 和 setRemoteDescription 方法来解决这
   个问题，并让会话描述对象包含一个类型字段，指示所提供的会话描述的类型。这满足了上
   面列出的要求，呼叫者首先调用 setLocalDescription(sdp [offer])，然后再调用
   setRemoteDescription(sdp [answer])，而应答者，首先调用 setRemoteDescription(sdp [offer])，
   然后再调用 setLocalDescription(sdp [answer])。

   在 offer/answer 交换过程中，未完成的 offer 在呼叫者和应答者看来是“未决的”，
   因为它可以被接受或拒绝。 如果这是再次呼叫的话，每侧也将具有 “当前” 本地和远端
   的描述，即最后一个 offer/answer 交换的结果。<a href="https://datatracker.ietf.org/doc/html/rfc8829#section-4.1.14">4.1.14</a>, <a href="https://datatracker.ietf.org/doc/html/rfc8829#section-4.1.16">4.1.16</a>,
   4.1.13, 和 4.1.15 章节提供关于待处理和当前描述的更多细节。

   JSEP 还允许应用程序将 offer 视为临时应答。临时 anwer 为应答者提供了一种将初
   始会话参数反馈给呼叫者的方法，以开始会话，同时允许应答者稍后指定最终 answer。
   最终 answer 的概念对 offer/answer 模型很重要；当接收到这样一个答案时，呼叫者
   分配的任何额外资源都可以被释放，因为现在已经知道确切的会话配置了。这些“资源” 包括
   额外的 ICE 组件、NAT 候选中继的遍历(TURN)或视频解码器。另一方面，临时的 answers
   没有这样的释放资源；因此，在呼叫建立期间多个不同的临时 answer 可以有不同的编解码
   器，传输参数等选择，请注意，最终 answer 可能与收到的任何临时 answer 不同。

   在 [<a href="https://datatracker.ietf.org/doc/html/rfc3264" title="&quot;An Offer/Answer Model with Session Description Protocol (SDP)&quot;">RFC3264</a>]中，信令层的限制是对于指定
   会话仅能产生一个 offer，但在 JSEP 的信令层，可以在任意时间点产生一个新 offer。
   例如，在使用 SIP 作为信令时，当一个 offer 发送后随即被 SIP CANCEL 终止，即便
   没有收到 answer 也能再产生一个 offer。为了支持这一点，无论何时 JavaScript 需
   要一个 offer 时，只需调用 JSEP 媒体层的 createOffer 方法就能得到一个 offer。
   应答者可以发回零个或多个的临时 answer，最后发送一个最终 answer 来结束 offer/
   answer 的交换。其状态机是这样的：

                       setRemote(OFFER)               setLocal(PRANSWER)
                           /-----\                               /-----\
                           |     |                               |     |
                           v     |                               v     |
            +---------------+    |                +---------------+    |
            |               |----/                |               |----/
            |  have-        | setLocal(PRANSWER)  | have-         |
            |  remote-offer |------------------- &gt;| local-pranswer|
            |               |                     |               |
            |               |                     |               |
            +---------------+                     +---------------+
                 ^   |                                   |
                 |   | setLocal(ANSWER)                  |
   setRemote(OFFER)  |                                   |
                 |   V                  setLocal(ANSWER) |
            +---------------+                            |
            |               |                            |
            |               |&lt;---------------------------+
            |    stable     |
            |               |&lt;---------------------------+
            |               |                            |
            +---------------+          setRemote(ANSWER) |
                 ^   |                                   |
                 |   | setLocal(OFFER)                   |
   setRemote(ANSWER) |                                   |
                 |   V                                   |
            +---------------+                     +---------------+
            |               |                     |               |
            |  have-        | setRemote(PRANSWER) |have-          |
            |  local-offer  |------------------- &gt;|remote-pranswer|
            |               |                     |               |
            |               |----\                |               |----\
            +---------------+    |                +---------------+    |
                           ^     |                               ^     |
                           |     |                               |     |
                           \-----/                               \-----/
                       setLocal(OFFER)               setRemote(PRANSWER)

                        Figure 2: JSEP 状态机

   除了这些状态转换之外，处理临时 (“pranswer”) 和最终 (“answer”) 之间没有其他区别。

<span class="h3"><a class="selflink" id="section-3.3" href="https://datatracker.ietf.org/doc/html/rfc8829#section-3.3">3.3</a>.  媒体描述的格式</span>

   JSEP 的用于内部表示的会话描述使用的是会话描述协议(SDP)的语法。虽然这种格式用于
   JavaScript 操作不是最佳的，但它被广泛使用，并经常更新其特性；任何会话描述的替代
   编码都必须与 SDP 的变化保持兼容，至少在新的编码取代 SDP 流行之前是如此。然而，
   为了再未来提供灵活性，SDP 语法被封装在 SessionDescription 对象中，该对象可以
   从 SDP 构造并序列化到 SDP。如果未来的规范对会话描述采用 JSON 格式达成一致，我们
   可以很容易地让这个对象生成和使用 JSON 格式。

   如下所述，大多数应用程序应该能够将各种 API 调用产生和使用的 SessionDescription
   视为不混沌的整体；也就是说，应用程序不需要读取或更改它们。

<span class="h3"><a class="selflink" id="section-3.4" href="https://datatracker.ietf.org/doc/html/rfc8829#section-3.4">3.4</a>.  会话描述的控制</span>

   为了让应用程序控制各种常见会话参数，JSEP 提供了控制面以控制 JSEP 实现如何生成
   会话描述。大多数情况下这避免了 JavaScript 修改会话描述的需要。

   对这些对象的更改导致改变由后续调用 createOffer/createAnswer 生成的会话描述的。

<span class="h4"><a class="selflink" id="section-3.4.1" href="https://datatracker.ietf.org/doc/html/rfc8829#section-3.4.1">3.4.1</a>.  RtpTransceivers</span>

   RtpTransceivers 允许应用程序控制与一个 "m=" 部分相关联的 RTP 媒体。每个
   RtpTransceiver 有一个 RtpSender 和一个 RtpReceiver，应用程序可以使用它们
   来控制 RTP 媒体的发送和接收。应用程序也可以直接修改 RtpTransceiver，例如，停
   止它。

   通常 RtpTransceivers 与"m=" section 是 1:1 的映射，尽管当 RtpTransceivers
   被创建但还没有关联到 "m=" 块时，或者 RtpTransceivers 已经停止并从 "m=" 块
   中剥离，RtpTransceivers 可能比 "m=" 块多。如果 RtpTransceiver 的媒体标识
   (mid)属性是非空的，则认为该 RtpTransceiver 与 “m=” 块已关联；否则，它被认为
   是游离的。关联的 “m=” 部分由收发器和 “m=” 块的索引通过通过映射确定的，当创建一
   个 offer 或应用一个远程 offer 时形成。

   一个 RtpTransceiver 只与一个 "m=" 块关联，一旦一个会话描述应用，一个 "m=" 块
   总是一个固定的 RtpTransceiver 关联。但是，在某些情况下，“m=” 部分已被拒绝，如
   下 <a href="https://datatracker.ietf.org/doc/html/rfc8829#section-5.2.2">5.2.2 节</a>，"m=" 块将被回收并且使用新的 MID 值与新的 RtpTransceiver 关联。

   RtpTransceivers 可以由应用程序显式创建，也可以通过调用 setRemoteDescription
   时 offer 中带有一个 “m=” 块来隐式创建。

<span class="h4"><a class="selflink" id="section-3.4.2" href="https://datatracker.ietf.org/doc/html/rfc8829#section-3.4.2">3.4.2</a>.  RtpSenders</span>

   RtpSenders 允许应用程序控制 RTP媒体的发送方式。RtpSender 在概念上负责 “m=”
   块中描述的 RTP 输出流。包括对依附的 MediaStreamTrack进行编码，发送 RTP
   媒体包，并为输出的 RTP 流生成/处理 RTP 控制协议(RTCP)。

<span class="h4"><a class="selflink" id="section-3.4.3" href="https://datatracker.ietf.org/doc/html/rfc8829#section-3.4.3">3.4.3</a>.  RtpReceivers</span>

   RtpReceivers 允许应用程序控制如何接收 RTP媒体。RtpReceiver 在概念上负责 “m=”
   块中描述的 RTP 输出流。包括处理接收到的 RTP 媒体包，解码远端 MediaStreamTrack
   产生传入的流，以及为传入的 RTP 流生成/处理 RTCP。

<span class="h3"><a class="selflink" id="section-3.5" href="https://datatracker.ietf.org/doc/html/rfc8829#section-3.5">3.5</a>.  ICE</span>

<span class="h4"><a class="selflink" id="section-3.5.1" href="https://datatracker.ietf.org/doc/html/rfc8829#section-3.5.1">3.5.1</a>.  ICE 收集概述</span>

   JSEP 根据应用程序的需要收集 ICE 候选。ICE 候选的收集被称为收集阶段，这是由添加
   一个新的或回收一个 “m=” 块 到本地会话描述或描述中表明 ICE 重启的新的 ICE 凭证
   触发的。新 ICE 凭证的使用可以由应用程序显式触发，也可以为了响应 ICE 配置中的更改
   由 JSEP 实现隐式触发。

   当 ICE 配置发生变化需要一个新的收集阶段时，就会设置一个 “needs-ice-restart”
   位。设置了这个位后，调用 createOffer API 将生成新的 ICE 凭证。这个位通过将带
   有的新的 ICE 凭证的 offer 或 answer 作为参数来调用 setLocalDescription
   API 来清除，即本地或远程初始的 ICE 重置。

   当一个新的收集阶段开始时，ICE 代理将通过状态更改事件通知应用程序正在进行收集。然
   后，当每个新的 ICE 候选可用时，ICE 代理将通过一个 onIcecandidate 事件将其返给
   给应用；这些候选对象也将自动添加到当前和/或挂起的本地会话描述中。最后，当收集完所
   有的候选后，将发送一个 final onicecandidate 事件，以表明收集过程已经完成。

   注意，收集阶段只收集新/回收/重新启动的 “m=” 块所需的候选；其他 “m=” 部分继续使用
   它们现有的候选。同样，如果一个 “m=” 块 被捆绑(通过一个 bundle 协商成功或者被标记
   为 bundle-only)，那么当且仅当 “m=” 块的 MID 项是一个 BUNDLE-tag时，候选将被
   收集并交换，正如[<a href="https://datatracker.ietf.org/doc/html/rfc8843" title="&quot;Negotiating Media Multiplexing Using the Session Description Protocol (SDP)&quot;">RFC8843</a>]所述。

<span class="h4"><a class="selflink" id="section-3.5.2" href="https://datatracker.ietf.org/doc/html/rfc8829#section-3.5.2">3.5.2</a>.  ICE 候选涓流(Trickling)</span>

   候选涓流是一种呼叫者可以在发出初始 offer 后，逐步地向被呼叫者提供候选的技术；“ICE
   涓流” 的语义在[<a href="https://datatracker.ietf.org/doc/html/rfc8838" title="&quot;Trickle ICE: Incremental Provisioning of Candidates for the Interactive Connectivity Establishment (ICE) Protocol&quot;">RFC8838</a>]中定义。这个过程允许被呼叫者快速响应呼叫，并立即建立ICE(可能
   还有DTLS)连接，而不必等待呼叫者收集所有可能的候选。在之前没有执行过收集的情况下，
   这将带来更快的媒体连接。

   JSEP 支持候选涓流是可选的，并提供了 API，如上所述，这些 API 对 ICE 候选收集过
   程提供控制和反馈。支持候选涓流的应用程序可以立即发送初始 offer，并在收到新候选的
   通知时发送单个候选；不支持此功能的应用程序可以简单地等待收集完成的指示，然后创建和
   发送 offer 以及所有的候选。

   在收到少量的候选后，接收方将把它们应用给 ICE 代理。这将触发 ICE 代理开始使用新的
   来自远端的候选检查连接。

<span class="h5"><a class="selflink" id="section-3.5.2.1" href="https://datatracker.ietf.org/doc/html/rfc8829#section-3.5.2.1">3.5.2.1</a>.  ICE 候选的格式</span>

   在 JSEP 中，ICE 候选被抽象为一个 IceCandidate 对象，与会话描述一样，内部表示使
   用 SDP 语法。

   候选的详细信息在 IceCandidate 字段中指定，使用与 <a href="https://datatracker.ietf.org/doc/html/rfc8839#section-5.1">[RFC8839], 5.1 章节</a> 章节中定义的
   “candidate-attribute” 字段相同的 SDP 语法。注意，该字段不包含 “a=” 前缀，如
   下例所示

   candidate:1 1 UDP 1694498815 192.0.2.33 10000 typ host

   IceCandidate 对象包含一个字段，用来指明它与哪个 ICE 用户名片段(ufrag)相关联，
   如 <a href="https://datatracker.ietf.org/doc/html/rfc8839#section-5.4">[RFC8839], 5.4 章节</a> 中定义的那样。该值用于确定该 IceCandidate 属于哪个会话描
   述(以及哪个收集阶段)，这有助于解决 ICE 重启时的歧义。如果这个字段在接收到的
   IceCandidate 中不存在(可能是在与非 JSEP 端点通信时)，则假定是最新接收到的会话
   描述。

   IceCandidate 对象还包含指示与之关联的 “m =” 块的字段，可以通过以下两种方式之一
   确定：“m=” 块索引或 MID。“m=” 块索引是从零开始，其索引为 n，则该 IceCandidate
   关联的是的会话描述中的第 N+1 个 “m=” 块。MID 是一个“媒体流标识”值，如 <a href="https://datatracker.ietf.org/doc/html/rfc5888#section-4">[RFC5888]
第4节</a>中定义，它与 RTPTranseciver 对象关联（当与不支持 MID 属性的非 JSEP 端点
   交互时，可以在接收器本地生成，如下面的第 <a href="https://datatracker.ietf.org/doc/html/rfc8829#section-5.10">5.10 节</a> 中所讨论的）。
   如果在接收到的 IceCandidate 中有 MID 字段，MUST 使用它进行关联；否则，将使用索
   引关联 “m=”块。

   实现 MUST 具有接收缺少如上所述的某些字段的对象的能力。

<span class="h4"><a class="selflink" id="section-3.5.3" href="https://datatracker.ietf.org/doc/html/rfc8829#section-3.5.3">3.5.3</a>.  ICE 候选政策</span>

   通常，在收集 ICE 候选时，JSEP 实现将收集所有可能的初始候选形式 —— 主机，服务器
   反射和中继器。但是，在某些情况下，由于隐私或相关问题，应用可能希望对收集过程具有更
   具体的控制。例如，人们可能只想使用中继候选，尽可能少的泄漏位置信息（请记住，这种选
   择具有相应的成本）。为实现此目的，JSEP 允许应用程序限制会话中使用的 ICE 候选。注
   意，如 [<a href="https://datatracker.ietf.org/doc/html/rfc8828" title="&quot;WebRTC IP Address Handling Requirements&quot;">RFC8828</a>] 中所讨论的，注意，此过滤应用于实现中哪些 IP 地址允许应用程序使
   用的任何限制之上。

   也有应用程序想要在会话过程中更改候选类型的情况。一个示例是被呼叫方最初可能想要仅使
   用中继的候选，避免将位置信息泄漏到任意呼叫者，但随后一旦用户确定自己想要接听呼叫便
   改为使用所有候选（用于较低的操作成本）。对于这种场景，JSEP 实现必须允许在会话过程
   中更改候选策略，这依赖于前面提到的与本地策略的交互。

   要管理 ICE 候选策略，JSEP 实现将确定每个收集阶段开始时的设置。然后，在收集阶段，
   实现 MUST NOT 将当前策略禁止的候选返给应用程序，用它们作为连接检查来源，或者通过
   其他字段间接公开它们，例如其他 ICE 候选的 raddr/rport 属性。稍后，如果应用程序
   指定了不同的策略，则应用程序可以通过 ICE 重启来开始新的收集阶段来应用。

<span class="h4"><a class="selflink" id="section-3.5.4" href="https://datatracker.ietf.org/doc/html/rfc8829#section-3.5.4">3.5.4</a>.  ICE 候选池</span>

   应用程序通常通过提供给 setLocalDescription 的信息通知 JSEP 实现开始 ICE 收
   集，因为本地描述指示必须收集的 ICE 组件数量以及哪些候选必须收集。但是，为了加速
   应用程序要提前知道使用的 ICE 组件数量的情况，它可能会要求实现收集一池子的 ICE
   候选，以帮助确保快速媒体设置。

   当最终调用 setLocalDescription 并且 JSEP 实现准备收集所需的 ICE 候选时，它
   SHOULD 首先检查 ICE 池中是否有任何可用的候选。如果 ICE 池中有候选，则应立即通
   过 ICE 候选事件交付给应用。如果 ICE 池耗尽，因为使用了大于预期的 ICE 组件数量
   或因为 ICE 池没有足够的时间来收集候选，那么剩余的候选人将像往常一样收集。这只发生
   在第一次 offer/answer 交换中，之后候选池被清空并且不再使用。

   这个概念有用的一个例子是应用程序期望在未来某些时候一旦来电，最小化想要建立连接所
   需的时间，避免剪切初始媒体。通过将候选预先收集到池中，它几乎可以在收到呼叫时立即
   交换并开始从这些候选发送连接检查。但请注意，持有这些预先收集的候选并时刻保持激活
   的状态以备随时所需，应用程序将消耗它使用的 STUN/TURN 服务器上的资源。（“STUN”
   代表“NAT会话穿越应用程序”。）

<span class="h4"><a class="selflink" id="section-3.5.5" href="https://datatracker.ietf.org/doc/html/rfc8829#section-3.5.5">3.5.5</a>.  ICE 版本</span>

   虽然本规范形式上依赖于 [<a href="https://datatracker.ietf.org/doc/html/rfc8445" title="&quot;Interactive Connectivity Establishment (ICE): A Protocol for Network Address Translator (NAT) Traversal&quot;">RFC8445</a>]，但在发布时，大多数 WebRTC 实现支持 [<a href="https://datatracker.ietf.org/doc/html/rfc5245" title="&quot;Interactive Connectivity Establishment (ICE): A Protocol for Network Address Translator (NAT) Traversal for Offer/Answer Protocols&quot;">RFC5245</a>]
   中描述的 ICE 版本。[<a href="https://datatracker.ietf.org/doc/html/rfc8445" title="&quot;Interactive Connectivity Establishment (ICE): A Protocol for Network Address Translator (NAT) Traversal&quot;">RFC8445</a>] 中定义的 “ice2” 属性可用于检测远端使用的版本，
   并提供从旧规范到新规范的平滑过渡。实现 MUST 能够接受没有 “ice2” 属性的远程描述。

<span class="h3"><a class="selflink" id="section-3.6" href="https://datatracker.ietf.org/doc/html/rfc8829#section-3.6">3.6</a>.  Video 尺寸协商</span>

   视频大小协商是接收器可以使用 “a=imageattr” SDP 属性[<a href="https://datatracker.ietf.org/doc/html/rfc6236" title="&quot;Negotiation of Generic Image Attributes in the Session Description Protocol (SDP)&quot;">RFC6236</a>]来指示其能够接收的视频帧大
   小的过程。接收器可能对其视频解码器可以处理的内容有硬限制，或者它可能有一些由策略
   设置的最大值。通过在“a=imageattr”属性中指定这些限制，JSEP 端点可以尝试确保远
   程发送方以可接受的分辨率传输视频。 但是，当与不理解此属性的非 JSEP 端点通信时，
   可能会超出任何信号限制，而 JSEP 实现会优雅地处理此问题，例如，通过丢弃视频。

   请注意，某些编解码器支持传输宽高比不是1.0的样本(即非方形图像)。JSEP实现不会传输
   非正方形像素，而是接收和渲染具有正确长宽比的视频。然而，以下所述，样品宽高比对尺寸
   协商没有影响;所有的尺寸都是用像素来衡量的，无论图像是否是正方形。

<span class="h4"><a class="selflink" id="section-3.6.1" href="https://datatracker.ietf.org/doc/html/rfc8829#section-3.6.1">3.6.1</a>.  创建 imageattr 属性</span>

   接收器将首先结合任何本地已知的限制(例如，硬件解码器能力或本地策略)来确定它可以接收
   的确切最小和最大尺寸。如果没有本地限制，**应该** 忽略 `a=imageattr` 属性。如果
   本地限制拒绝接收任何视频，即不允许分辨率的退化情况，则 **必须** 忽略 `a=imageattr`
   属性，并且 `m=` 块 **必须** 视情况而被标记为 `sendonly/inactive`。

   否则，要创建一个方向为 `recv` 的 `a=imageattr` 属性，由上述分辨率空间形成的交
   集用于指定 `x=` 和 `y=` 值的最小值和最大值。

   这里的规则表达了一组偏好，因此，`a=imageattr` 中的 `q=` 值并不重要。它应该设置
   为 “1.0”。

   "a=imageattr" 字段是一种特定负载（payload）类型。当所有支持的视频编解码器都具有
   相同的能力时，**推荐**使用单个属性，即通配符有效负载类型(*)。然而，当支持的视频编
   解码器有不同的限制，**必须**为每个有效负载类型插入特定的 “a=imageattr”属性。

   例如，一个带有多种视频解码器的系统，它能够解码从 48x48 到 720p 的任何分辨率。 在
   这种情况下，实现将生成此属性：

             a=imageattr:* recv [x=[48:1280],y=[48:720],q=1.0]

   该声明表明接收器能够解码从48x48到1280x720像素的任何图像分辨率。

<span class="h4"><a class="selflink" id="section-3.6.2" href="https://datatracker.ietf.org/doc/html/rfc8829#section-3.6.2">3.6.2</a>.  解释 imageattr 属性</span>

   [<a id="ref-RFC6236">RFC6236</a>] 将 "a=imageattr" 定义为一个咨询字段。这意味着它不会绝对规定发送者可
   以使用的视频格式，而指出应该首选的值。

   该规范规定了更具体的行为。当一个产生特定分辨率（“轨道分辨率”）的视频的 MediaStreamTrack
   附加到一个 RtpSender上，以相同或更低的分辨率（“编码器分辨率”）对轨道视频进行编码，
   并且应用了引用远端发送方相关的描述，的包含有效“a=imageattr recv”属性的远程描述，它
   遵循以下规则以确保发件人不会传输超出属性中指定的大小标准的分辨率。只要属性仍然存在于远
   程描述中，就应遵循这些规则，包括轨道改变其分辨率或被不同轨道替换的情况。

   根据 RtpSender 的配置方式，它可能会以特定分辨率生成单个编码，或者，如果已协商联播
   (<a href="https://datatracker.ietf.org/doc/html/rfc8829#section-3.7">（第 3.7 节）</a>)，则生成多个编码，每个编码都以自己的特定分辨率生成。 此外，根据配置，每
   种编码都可以在需要时灵活地降低分辨率，或者可以锁定到特定的输出分辨率。

   对于 RtpSender 生成的每个编码，远程描述中对应的“m=”部分中的“a=imageattr recv”
   属性集将被处理，以确定应该传输什么。只考虑引用为编码选择的媒体格式的属性;从 “q=”
   值最高的属性开始，对每个这样的属性分别进行评估。如果多个属性具有相同的 "q=" 值，
   则按照它们在 "m=" 块中出现的顺序计算它们。注意，虽然 JSEP 端点每个媒体格式最多包
   含一个 "a=imageattr recv" 属性，但 JSEP 端点可以从非 JSEP 端点接收包含多个这
   样属性的 "m=" 部分的会话描述。

   对于每个 "a=imageattr recv" 属性，应用以下规则。如果处理成功，则根据规则传输编
   码，不再考虑该编码的其他属性。否则，按上述顺序评估下一个属性。如果所有的属性都不能
   成功处理，则 MUST NOT 传输该编码，并且 SHOULD 向应用程序给出错误。

   *  将属性的限制与编码器的分辨率进行比较。仅参考以下列举的特定限制; MUST 忽略其它
      任何值则，例如图片宽高比。当考虑产生旋转的视频的 MediaStreamTrack 时，MUST
      使用未旋转的分辨率用于检查。无论接收端的接收器是否支持旋转，这都是需要的(例如，
      通过协调视频方向(CVO)[<a href="https://datatracker.ietf.org/doc/html/rfc8829#ref-TS26.114" title="&quot;3rd Generation Partnership Project; Technical Specification Group Services and System Aspects; IP Multimedia Subsystem (IMS); Multimedia Telephony; Media handling and interaction (Release 16)&quot;">TS26.114</a>])，因为它极大地简化了匹配逻辑。

   *  如果属性包含一个值是非“1.0”的“sar=”(样本宽高比)，表示接收方希望接收非正方形图
      像，该需求无法被满足，MUST NOT 使用该属性。

   *  如果编码器分辨率超过属性限制的最大尺寸并且编码器允许调整其分辨率，则编码器 MUST
      降低分辨率以满足限制。降低分辨率 MUST NOT 改变图片宽高比，忽略四舍五入引起的微
      小差异。例如，如果编码器分辨率为 1280x720 且属性指定的最大值为 640x480，预期
      的输出分辨率为 640x360。如果降低分辨率无法满足天剑，则 MUST NOT 使用该属性。

   *  如果编码器的分辨率小于属性规定的最小尺寸，MUST NOT 应用该属性，禁止提高编码器分
      辨率。JSEP 的实现 SHOULD 允许接收任意小的分辨率，甚至是使用软件解码器，来避免
      这种情况。

   *  如果编码器分辨率在属性限制的最大和最小尺寸范围内，则无需任何操作。

<span class="h3"><a class="selflink" id="section-3.7" href="https://datatracker.ietf.org/doc/html/rfc8829#section-3.7">3.7</a>.  联播/多播（Simulcast）</span>

   JSEP 支持单个 MediaStreamTrack 的联播传输，即单个 “m=” 块的上下文可以传输源
   媒体的多种编码。当前的 JSEP API 被设计为应用程序可以发送联播媒体，但只能接收单
   个编码。该设计适用多用户场景，其中每个发送客户端向服务器发送多个编码，然后服务器
   为每个接收客户端选择适当的编码进行转发。

   应用程序通过在 RtpSender 上配置多个编码开启联播功能。通过生成 邀约 或 应答答，
   这些编码被标识在 SDP 中相应的“m=”块标识中，如下所述。理解并愿意接收联播的接收器
   将包含 SDP联播标识以表明他们的支持该功能，而JSEP端点则使用这些标识来确定给定
   RtpSender 是否允许进行联播。如果协商没有支持联播，RtpSender 将使用第一个配置的
   编码。

   注意，确切的联播参数取决于发送应用程序。虽然提供上述 SDP 标识是为了确保远端可以接
   收和复用多个联播编码，但用于每个编码的特定分辨率和比特率纯粹是 JSEP 中的发送端决
   定的。

   JSEP 当前不提供配置接收联播的机制。这意味着如果远程端点提供联播，则 JSEP 端点生
   成的应答将表示不支持接收联播，因此远程端点将只为每个 “m=” 块发送单个编码。

   此外，JSEP 没有提供处理来自 JSEP 端点传入的联播请求的机制。这意味着在 JSEP 端点
   收到初始邀约的情况下设置联播需要外带信令或 SDP 检查。但是，在 JSEP 端点在其初始邀
   约中设置联播的情况下，任何已建立的联播流将在收到重新邀约（re-offer）后继续生效。本
   规范的未来版本可能会添加额外的 API 来处理传入的初始化邀约场景。

   当使用 JSEP 传输来自 RtpSender 的多个编码时，将使用 [<a href="https://datatracker.ietf.org/doc/html/rfc8853" title="&quot;Using Simulcast in Session Description Protocol (SDP) and RTP Sessions&quot;">RFC8853</a>] 和 [<a href="https://datatracker.ietf.org/doc/html/rfc8851" title="&quot;RTP Payload Format Restrictions&quot;">RFC8851</a>]
   中的技术。具体来说，当一个 RtpSender 配置了多种编码时，RtpSender 的 "m=” 块将
   包含一个 “a=simulcast” 属性，定义在 <a href="https://datatracker.ietf.org/doc/html/rfc8853#section-5.1">[RFC8853] 5.1 节</a>，列出了“发送”联播每个所
   需编码的流描述，但是没有“接收”联播流描述。“m=” 块还包括每个编码的 “a=rid”属性，
   如 <a href="https://datatracker.ietf.org/doc/html/rfc8851#section-4">RTC8851 第 4 节</a>中所指定； 限制标识符（RID，也称为 rid-ids 或 RtpStreamIds）
   可以消除在同一个 “m=” 块中各个编码的歧义。

<span class="h3"><a class="selflink" id="section-3.8" href="https://datatracker.ietf.org/doc/html/rfc8829#section-3.8">3.8</a>.  Interactions with Forking</span>

   一些呼叫信令系统允许各种类型的分叉，其中一个SDP Offer可以提供给多个设备。例如，
   SIP [<a href="https://datatracker.ietf.org/doc/html/rfc3261" title="&quot;SIP: Session Initiation Protocol&quot;">RFC3261</a>] 定义了“并行搜索”和“顺序搜索”。虽然这些主要是超出JSEP范围的信令
   级问题，但它们确实对相关的媒体平面的配置有一些影响。当分叉发生在信令层时，负责信
   令的 JavaScript 应用程序需要及时决定在何种节点应该发送或接收什么媒体，以及它应
   该与哪个远程端点通信; JSEP 用于确保媒体引擎能够按照应用程序的要求执行 RTP 和媒
   体。应用程序可以让媒体引擎执行的基本操作如下：

   *  开始与给定的远程对等方交换媒体，保留接收的邀约中的所有资源。

   *  开始与给定的远程对等体交换媒体，并释放来自要约中未使用的任何资源。

<span class="h4"><a class="selflink" id="section-3.8.1" href="https://datatracker.ietf.org/doc/html/rfc8829#section-3.8.1">3.8.1</a>.  顺序分叉</span>

   顺序分叉中一个呼叫可以被分发给多个被呼叫者，每个被呼叫着都可以接受呼叫，但同一时间
   只能有一个会话建立。没有对接收的媒体进行混合。

   JSEP能够很好地处理顺序分支，允许应用程序轻松控制选择远程端点所需的策略。当一个被呼
   叫者的应答到达时，应用程序可以选择(1)一个临时应答，以保留将来使用不同应答的可能性，
   或者(2)一个最终应答，结束设置流程。

   在“先到先得”的情景下，第一个应答将作为最终应答，并且该应用程序将拒绝后续的任何应答。
   在SIP术语中，将是 ACK + BYE。

   在“最后者胜”的情景下，所有的应答都将作为临时应答，之前的呼叫将被终止。在某个点上，
   应用程序将结束设置过程，可能使用一个计时器;此时，应用程序可以重新应用挂起的远程描述
   作为最终应答。

<span class="h4"><a class="selflink" id="section-3.8.2" href="https://datatracker.ietf.org/doc/html/rfc8829#section-3.8.2">3.8.2</a>.  并行分叉</span>

   并行分叉是指将一个呼叫分派给多个远程被呼叫方，每个被呼叫方都可以接受该呼叫，从而可
   以建立多个同步活动的信令会话。如果多个调用方同时发送媒体，则处理这种情况的可能性在
   <a href="https://datatracker.ietf.org/doc/html/rfc3960#section-3.1">[RFC3960], 3.1 节</a>。目前大多数SIP设备只支持同一时刻与单个设备交换媒体，
   而不尝试混合多个早期媒体音频源，因为这会导致混乱的情况。例如，考虑将欧洲的铃声和北
   美的铃声混合在一起——结果不会像任何一种声音，而且会让用户感到困惑。如果信令应用程序
   希望一次只与一个远程端点交换媒体，那么从媒体引擎的角度来看，这与顺序分叉的情况完全
   相同。

   在并行分叉的情况下，JavaScript 应用程序希望与多个对等点同时交换媒体，流程稍微复
   杂一些，但 JavaScript 应用程序可以遵循 [<a href="https://datatracker.ietf.org/doc/html/rfc3960" title="&quot;Early Media and Ringing Tone Generation in the Session Initiation Protocol (SIP)&quot;">RFC3960</a>] 描述的策略，使用 UPDATE。
   UPDATE 方法允许信令为希望交换媒体的每个对等端建立单独的媒体流。在 JSEP 中，在
   UPDATE 中使用的提议将通过简单地创建一个新的 PeerConnection(参见<a href="https://datatracker.ietf.org/doc/html/rfc8829#section-4.1">4.1节</a>)并确保相
   同的本地媒体流已添加到这个新的 PeerConnection 中。然后，新的 PeerConnection
   对象将产生一个 SDP 邀约，信令可以使用该邀约执行 [<a href="https://datatracker.ietf.org/doc/html/rfc3960" title="&quot;Early Media and Ringing Tone Generation in the Session Initiation Protocol (SIP)&quot;">RFC3960</a>] 中讨论的 UPDATE 策略。

   共享媒体流的结果是，应用程序最终将拥有 N 个并行 PeerConnection 会话，每个会话都
   具有本地和远程描述以及自己的本地和远程地址。来自这些会话的媒体流可以使用
   setDirection(参见<a href="https://datatracker.ietf.org/doc/html/rfc8829#section-4.2.3">4.2.3节</a>))来管理，或者应用程序可以选择从所有会话中播放混合媒体。
   当然，如果应用程序只希望保留单个会话，它可以简单地终止不再需要的会话。

<span class="h2"><a class="selflink" id="section-4" href="https://datatracker.ietf.org/doc/html/rfc8829#section-4">4</a>.  Interface</span>

   本节详细介绍实现 JSEP 功能所必需的基本操作。W3C API 中实际公开的 API 可能有一些
   不同的语法，但应该很容易映射到这些概念。

<span class="h3"><a class="selflink" id="section-4.1" href="https://datatracker.ietf.org/doc/html/rfc8829#section-4.1">4.1</a>.  PeerConnection</span>

<span class="h4"><a class="selflink" id="section-4.1.1" href="https://datatracker.ietf.org/doc/html/rfc8829#section-4.1.1">4.1.1</a>.  Constructor</span>

   PeerConnection 构造函数允许应用程序为媒体会话指定全局参数，例如在收集候选对象时
   使用的 STUN/TURN 服务器和凭证，以及初始ICE候选策略和池大小，以及要使用的 bundle
   策略。

   如果指定了 ICE 候选策略，它的功能将如章节<a href="https://datatracker.ietf.org/doc/html/rfc8829#section-3.5.3">Section 3.5.3</a>所述，导致JSEP实现只向应用程序显示
   允许的候选(包括任何内部过滤实现)，并且只使用这些候选进行连通性检查。可用的策略集如
   下所示

   all: 所有实施政策允许的候选人将被收集和使用。

   relay: 除中继候选外的所有候选都将被过滤掉。 这避免可能从接收到的候选中确定远程对
      等端的位置信息。取决于应用程序部署和选择中继服务器的方式，这可能会将位置混淆到
      大都市甚至全球级别。

   默认的ICE候选策略被设置为“all”，因为这通常是所需的策略，而且通常还可以显著减少应
   用程序使用 TURN 服务器的资源。

   如果为 ICE 候选池指定了大小，则表示要为 ICE 组件预先收集候选的数量。由于预收集导
   致可能长时间使用 STUN/TURN 服务器资源，这**必须**仅发生在应用程序请求时，因此默
   认候选池大小 MUST 为零。

   应用程序可以指定其关于使用 bundle 的首选策略，即 [<a href="https://datatracker.ietf.org/doc/html/rfc8843" title="&quot;Negotiating Media Multiplexing Using the Session Description Protocol (SDP)&quot;">RFC8843</a>] 中定义的多路复用机制。
   不管策略是什么，应用程序将总是尝试将媒体流协商到单个 Transport 中，并将所有的 m= 
   块包含在一个 bundle组中；是否使用单一传输取决于应答者是否接受捆绑。然而，通过指定下
   面的策略，应用程序可以精确地控制将媒体流捆绑在一起的积极程度，这将影响它如何与不支持
   绑定包的端点进行互操作。当与不支持绑定包的端点协商时，只有未标记为仅支持绑定包
   的流才会被建立。

   可用的策略集如下所示

   balanced: 每种类型(音频、视频或应用程序)的第一个“m=”部分将包含传输参数，以允许应
      答程序解绑定该部分。每种类型的第二个和任何后续的“m=”部分将被标记为 bundle-only。
      结果是，如果有 N 种不同的媒体类型，那么将为 N 种媒体流收集候选。该策略平衡了多
      路复用与在遗留系统中确保基本的音频和视频仍然可以协商的需求。当作为应答方，如果邀
      约中没有 bundle 组，则将拒绝每种类型除第一个 “m=” 块的所有媒体。

   max-compat: 所有 "m=" 块将包含传输参数；没有一个将被标记为 bundle-only。此策
      略将允许捆绑无感知端点接收所有流，但需要为每个媒体流收集单独的候选。

   max-bundle: 只有第一个“m=”部分将包含传输参数;除第一个流外的所有流都将被标记为
      bundle-only。此策略旨在最小化候选集合并最大化复用，但代价是与遗留端点的兼容
      性较差。对于应答方，实现将拒绝除第一个 “m=” 块之外的任何 “m=” 块，除非它们与
      “m=” 节在同一个 bundle 组中。

   由于需要性能和与遗留端点的兼容性之间提供了最好的权衡，默认的包策略 MUST 为 “balanced”。

   应用程序可以使用以下策略之一指定其关于使用 RTP/RTCP 多路复用 [<a href="https://datatracker.ietf.org/doc/html/rfc5761" title="&quot;Multiplexing RTP Data and Control Packets on a Single Port&quot;">RFC5761</a>] 的首选策略:

   negotiate: JSEP 实现将同时收集 RTP 和 RTCP 候选，但也提供“a=rtcp-mux”，从而
      允许与多路复用或非多路复用端点兼容。

   require: SEP 实现将只收集 RTP 候选并将在它生成的 offer 中的任何新的 “m=” 部分
      中插入 “a=rtcpmux-only” 指示。 这使邀约方需要收集的候选数量减半。 应用带有不
      包含 “a=rtcp-mux” 属性的 “m=” 部分的描述将导致返回错误。

   默认复用策略设置为 “require”。实现可以拒绝应用程序将多路复用策略设置为 “协商” 的
   尝试。

<span class="h4"><a class="selflink" id="section-4.1.2" href="https://datatracker.ietf.org/doc/html/rfc8829#section-4.1.2">4.1.2</a>.  addTrack</span>

   addTrack 方法给 PeerConnection 添加一个 MediaStreamTrack，使用 MediaStream
   参数将一个 tracks 与另一个 tracks 关联到一个 MediaStream，以使其在创建 offer 和
   answer 时添加到保持音视频同步（LS: Lip Synchronization)的组。将音轨添加到相同的
   “LS”组表明，这些音轨的播放应该同步以进行正确的口型，如<a href="https://datatracker.ietf.org/doc/html/rfc5888#section-7">[RFC5888]，第7节</a>所述。
   addTrack 尽量保持最少的 transceiver 数量，例如：如果 PeerConnection 处于
   “have-remote-offer”状态，该 track 将被附加到第一个兼容的 transceiver 上，即
   由最近的 setRemoteDescription 调用创建的并且没有本地 track 的 transceiver。
   否则将按照 <a href="https://datatracker.ietf.org/doc/html/rfc8829#section-4.1.4">4.1.4 节</a>. 规定的新建一个 transceiver。

<span class="h4"><a class="selflink" id="section-4.1.3" href="https://datatracker.ietf.org/doc/html/rfc8829#section-4.1.3">4.1.3</a>.  removeTrack</span>

   removeTrack 方法从 PeerConnection 移除一个 MediaStreamTrack，参数 RtpSender
   标识包含哪个 sender 的 track 被移除。发送方的 track 被移除，并且停止发送。之后调用
   createOffer 将关联的 m 块标记为 recvonly(如果 transceiver.direction 是 sendrecv)
   或者 inactive (如果 transceiver.direction 是 sendonly)。

<span class="h4"><a class="selflink" id="section-4.1.4" href="https://datatracker.ietf.org/doc/html/rfc8829#section-4.1.4">4.1.4</a>.  addTransceiver</span>

   addTransceiver 添加一个 RtpTransceiver 到 PeerConnection。如果提供了 MediaStreamTrack
   参数，transceiver 将配置为其媒体类型并且 track 被依附在 transceiver上。 否则，应用 MUST
   显示指定类型；这种方式对于仅接收的 transceivers 和需要在随后依附到 transceivers 上的 track
   非常有用。

   在创建时，应用程序还可以给 transceiver 指定 direction 属性，与该 transceiver 相关联的
   （允许“LS”组分配）一组 MediaStream ，以及媒体的一组编解码（用于如上所述 <a href="https://datatracker.ietf.org/doc/html/rfc8829#section-3.7">第3.7节</A> 的Simulcast）。

<span class="h4"><a class="selflink" id="section-4.1.5" href="https://datatracker.ietf.org/doc/html/rfc8829#section-4.1.5">4.1.5</a>.  onaddtrack 事件</span>

   onaddtrack 事件在 setRemoteDescription 调用的结果有一个新的远端 track 时下发给
   应用。新 track 作为 MediaStreamTrack 对象与该 track 所在的 MediaStream 一起
   在时间中提供。

<span class="h4"><a class="selflink" id="section-4.1.6" href="https://datatracker.ietf.org/doc/html/rfc8829#section-4.1.6">4.1.6</a>.  createDataChannel</span>

   createDataChannel 方法创建一个数据通道并将其添加到 PeerConnection。如果
   PeerConnection 当前没有数据通道，需要再一次进行 offer/answer 交换。一个
   PeerConnection 的所有数据通道共享同一个 SCTP/DTLS ("SCTP" 意为 "Stream Control
   Transmission Protocol") 而且使用同一个 “m=” 块，因此，随后创建的数据通道不会对
   JSEP状态产生任何影响。

   createDataChannel 方法也包含一系列 PeerConnection 用到的参数 (例如, maxPacketLifetime)
   但不反映在 SDP 中也不影响 JSEP 状态。

<span class="h4"><a class="selflink" id="section-4.1.7" href="https://datatracker.ietf.org/doc/html/rfc8829#section-4.1.7">4.1.7</a>.  ondatachannel 时间</span>

   ondatachannel 事件在远端协商确定了有一个新的数据通道时被下发给应用，可能发生在底层
   SCTP/DTLS 建立后的任何时刻。新的数据通道对象在事件中提供。

<span class="h4"><a class="selflink" id="section-4.1.8" href="https://datatracker.ietf.org/doc/html/rfc8829#section-4.1.8">4.1.8</a>.  createOffer</span>

   createOffer 方法生成一个 SDP 格式的邀约，[<a href="https://datatracker.ietf.org/doc/html/rfc3264" title="&quot;An Offer/Answer Model with Session Description Protocol (SDP)&quot;">RFC3264</a>] 规定的会话配置，
   包括对添加到 PeerConnection 的媒体的描述，该实现支持的编解码、RTP 和 RTCP 选项,
   以及已被 ICE 代理收集的候选网络。可以在生成的邀约中通过附加选项来对提供额外的控制。
   这些选项允许应用重启 ICE, 以重新建立连接。

   在初始邀约中，生成的 SDP 将包含会话所需的所有功能(默认情况下支持但不需要的功能可以省略);
   对于每一行 SDP，SDP 的生成遵循 SDP 行定义的规范生成一个初始邀约的流程。关于生成一个
   初始邀约的详细描述在下面的<a href="https://datatracker.ietf.org/doc/html/rfc8829#section-5.2.1">5.2.1 节</a>。

   如果 createOffer 是在会话建立之后调用，createOffer 会基于已对会话进行的更改创建一
   个更改当前会话的邀约，例如，添加或者停止 RtpTransceiver，或请求重启 ICE。对于已有
   的每个流，每行 SDP 的生成都 MUST 遵循为生成 RFC 中更新 SDP 对应行定义的流程。对于
   新的流，SDP 的生成必须遵循生成一个初始邀约的流程，正如之前所述的。如果没有任何更改，
   或者更改对生成邀约没有影响，邀约仅包含最后 offer/answer 交换达成协商的参数。处理
   随后邀约的细节在接下来的 <a href="https://datatracker.ietf.org/doc/html/rfc8829#section-5.2.2">5.2.2 节</a>。

   由 createOffer 生成的会话描述 MUST 立即可被 setLocalDescription 使用；如果一个
   系统有有限的资源(例如，解码器的数量有限)，createOffer SHOULD 返回一个反映系统当前
   状况的邀约，这样 setLocalDescription 在尝试获取这些资源时就会成功。

   调用该方法或许会生成新的 ICE 候选，但不会影响 PeerConnection 的状态, 触发候选
   网络收集或许会开启或停止媒体流。具体而言，在调用 setLocalDescription 之前，
   邀约不会在本地应用，即不会成为的当前的本地描述。.

<span class="h4"><a class="selflink" id="section-4.1.9" href="https://datatracker.ietf.org/doc/html/rfc8829#section-4.1.9">4.1.9</a>.  createAnswer</span>

   createAnswer 方法按照 [<a href="https://datatracker.ietf.org/doc/html/rfc3264" title="&quot;An Offer/Answer Model with Session Description Protocol (SDP)&quot;">RFC3264</a>]
   生成一块用于会话应答的 SDP，该 SDP 包含本地支持的配置并与最新 setRemoteDescription
   调用设置的参数兼容； setRemoteDescription 必须在调用 createAnswer 之前调用。
   跟 createOffer 一样，返回的内容包含添加到该 PeerConnection 的媒体的描述，该会话
   协商好的 codec/RTP/RTCP 选项，以及 ICE 代理已收集的网络候选。以及添加一些额外选项
   在应答中以进行其它控制。

   在生成的应答中，包含一个特殊的配置指定如何建立媒体平面；应答的每一行都 MUST 遵循生成
   为生成 SDP 应答行定义的规范。生成应答的详细描述在下面的 <a href="https://datatracker.ietf.org/doc/html/rfc8829#section-5.3">5.3 节</a>。

   createAnswer 生成的会话描述 MUST 立即能被 setLocalDescription 使用；跟 createOffer
   一样，返回的描述 SHOULD 反应当前系统的状态。

   调用该方法可能生成新的 ICE 凭证，但不会影响 PeerConnection 的状态，触发候选网络
   收集，或改变媒体状态。 具体而言，调用 setLocalDescription 之前，应答不会被应用，
   也不会成为当前的本地描述。

<span class="h4"><a class="selflink" id="section-4.1.10" href="https://datatracker.ietf.org/doc/html/rfc8829#section-4.1.10">4.1.10</a>.  SessionDescriptionType</span>

   会话描述对象 (RTCSessionDescription) 可能是 “offer”， “pranswer”， “answer”
   或者 "rollback" 类型。这些类型提决定了应该如何解析描述参数以及应该如何更改媒体的状态。

   “offer” 意味着该描述 MUST 被解析为邀约；意味着描述可能包括许多可能的媒体配置。一个
   “offer” 类型的描述可以在应用于任何 PeerConnection 处于 “stable” 状态的时刻或者
   更新已经应用但未应答的 “offer”。

   “pranswer” 以为着描述 MUST 被解析为应答，但不是最终应答，因此 MUST NOT 导致释放
   已申请的资源。如果该应答没有指定一个非活动的媒体方向，它可以开始媒体传输。“pranswer”
   类型的描述可以作为 “offer” 的应答或者更新前一个 “pranswer”。

   “answer” 表示该描述 MUST 被解析为应答，offer/answer 的交换流程 MUST 认为完成了，
   任何不再需要的资源 (decoders, candidates) SHOULD 被释放。一个 “answer” 类型
   的表述应用于应答 “offer” 或者更新一个 “pranswer”。

   临时和最终应答的唯一区别是最终应答会释放任何为应答准备但不再需要的资源。因此，应用程序
   可以自行决定答案是临时的还是最终的，并可以根据需要更改会话描述的类型。例如，在串行分叉
   场景中，应用程序可能会收到多个“最终”应答，每个远程端点都返回一个。应用程序可以选择接受
   先收到的应答作为临时应答，只有在收到符合其标准的应答时，才将其作为最终应答使用。（例如
   一个直播而不是语音).

   “rollback” 是一种特殊会话描述类型，表示状态机 MUST 回滚到上一个 “stable” 状态，如
   <a href="https://datatracker.ietf.org/doc/html/rfc8829#section-4.1.10.2">4.1.10.2 节</a>所述。内容 MUST 为空。

<span class="h5"><a class="selflink" id="section-4.1.10.1" href="https://datatracker.ietf.org/doc/html/rfc8829#section-4.1.10.1">4.1.10.1</a>. 使用临时应答</span>

   大多数应用程序不需要使用 “pranswer” 类型创建应答。虽然接到邀约后发送立即应答是很
   好的做法，为了预热会话运输防止媒体剪切，JSEP 应用程序更好的做法是在收到邀约后立即
   创建并发送一个空 MediaStreamTrack 的 “sendonly” 的最终应答，这将阻止呼叫者发
   送媒体，并允许被呼叫者根据应答立即发送媒体。稍后，当被呼叫者实际接受呼叫时，应用程
   序可以添加真实的 MediaStreamTrack 并创建一个新的 “sendrecv” 邀约以更新上一个
   offer/answer 对并开启双向媒体流。这也可以通过一个 “sendonly” 预应答和接着一个
   “sendrecv“ 的应答完成，最初的预应答保持 offer/answer 交换打开，意味着在此期间
   呼叫者不能发送一个被更改的邀约。

   例如，一个 JSEP 应用想要尽可能快速的发送视频和音频。当被呼叫者接到带有视频和音频
   MediaStreamTracks 的邀约，它会立即发送一个将这些媒体作为仅发送的应答(这意味着呼叫方
   还不会向被呼叫方发送任何媒体，而且因为被呼叫方还没有添加自己的 MediaStreamTracks，
   所以被呼叫方也不会发送任何媒体)。 它接着会要求用户接受呼叫并申请需要的本地轨道。在
   用户接受后，应用程序将插入它获得的轨道，因为 ICE 握手和 DTLS 握手可能已经完成，传
   输可以立即开始。在用户接受后，应用程序将插入它获得的轨道，此时因为 ICE 握手和 DTLS
   握手可能已经完成，可以立即开始传输。应用还将向远端发送一个新的邀约，指示接受呼叫，并
   将音频和视频变为双向传输。一个演示该流程的详细的示例是 <a href="https://datatracker.ietf.org/doc/html/rfc8829#section-7.3">7.3 节</a>.

   当然，一些应用可能无法执行这种双重 offer/answer 交换，特别是试图连接到传统信令协
   议。在这些情况下，预应答仍然可以为应用程序提供为传输预热的机制。

<span class="h5"><a class="selflink" id="section-4.1.10.2" href="https://datatracker.ietf.org/doc/html/rfc8829#section-4.1.10.2">4.1.10.2</a>.  Rollback</span>

   在某些情况下，可能需要“撤消”对 setLocalDescription 或 setRemoteDescription
   进行的改变。考虑这样一种情况，一个呼叫正在进行，一方希望更改一些会话参数;该端生成一
   个更新的报价，然后调用 setLocalDescription。但是，远端(在 setRemoteDescription
   之前或之后)决定它不想接受新参数，并向邀约方发送拒绝消息。现在，邀约方，并可能还需要
   返回“稳定”状态和之前的本地/远程描述。为了支持这一点，我们引入了“回滚”的概念，它丢弃
   对会话的任何提议更改，将状态机返回到“稳定”状态。回滚是通过向 setLocalDescription
   或 setRemoteDescription 提供类型为“rollback”的内容为空的会话描述来执行的。

<span class="h4"><a class="selflink" id="section-4.1.11" href="https://datatracker.ietf.org/doc/html/rfc8829#section-4.1.11">4.1.11</a>.  setLocalDescription</span>

   setLocalDescription 方法指示 PeerConnection 将提供的会话描述应用为它的本地
   配置。type 字段指示该描述应该作为邀约、临时应答、最终应答还是回滚处理；邀约和应答
   有对于 SDP 行有不同的检查规则。

   该 API 改变了本地媒体的状态；除此之外，它还为接收和解码媒体准备本地资源。为了成功
   处理应用程序想要将媒体格式转变为另一种不兼容的格式的场景，PeerConnection MUST 能
   够支持同时使用当前和新添加的描述(例如,支持的编解码器中存在的描述)。当 PeerConnection
   进入 ”have-local-offer” 状态时，这个双重处理就开始了，并且一直持续到
   setRemoteDescription 被调用，并带有(1) 最终应答，此时 PeerConnection 可以
   完全采用挂起的本地描述，或者(2)回滚，回滚的结果是恢复到当前的本地描述。

   该 API 间接地控制候选的收集过程。当提供了本地描述，并且当前使用的传输器数量与本地描述
   所需的传输器数量不匹配时，PeerConnection 将根据需要创建传输，并开始为每个传输器收集
   候选，如果可用，使用候选池中的候选。

   如果 (1) setRemoteDescription 之前使用一个邀约调用，(2) setLocalDescription
   使用一个应答(临时或最终) 作为参数被调用，并且(3)媒体方向是兼容的，(4)媒体可用来发送，
   这将开始媒体传输。

<span class="h4"><a class="selflink" id="section-4.1.12" href="https://datatracker.ietf.org/doc/html/rfc8829#section-4.1.12">4.1.12</a>.  setRemoteDescription</span>

   setRemoteDescription 方法指示 PeerConnection 将会话描述参数作为所需的远程配置。
   与 setLocalDescription 一样，描述的类型字段指示应该如何处理它。

   该 API 改变了本地媒体的状态；除此之外，它还设置了用于发送和编码媒体的本地资源。

   如果 (1) setLocalDescription 之前以邀约作为参数被调用，(2) setRemoteDescription
   以一个应答参数被调用(临时或最终)，(3)媒体方向是兼容的，(4)媒体可用来发送，将开始媒体
   传输。

<span class="h4"><a class="selflink" id="section-4.1.13" href="https://datatracker.ietf.org/doc/html/rfc8829#section-4.1.13">4.1.13</a>.  currentLocalDescription</span>

   currentLocalDescription 方法返回当前协商后的本地描述 —— 即，最后一个的
   offer/answer 交换成功的本地描述 —— 但排除本地描述设置后 ICE 代理生成的任
   何本地候选网络。

   如果尚未完成 offer/answer 交换，则返回 null 对象。

<span class="h4"><a class="selflink" id="section-4.1.14" href="https://datatracker.ietf.org/doc/html/rfc8829#section-4.1.14">4.1.14</a>.  pendingLocalDescription</span>

   pendingLocalDescription 方法返回当前正在协商的本地描述的一个副本 —— 即，
   本地报价集，没有任何相应的远程应答 —— 但排除本地描述设置后 ICE 代理生成的
   任何本地候选网络。

   如果 PeerConnection 的状态是 “stable” 或者 “have-remote-offer” 则
   返回null 对象。

<span class="h4"><a class="selflink" id="section-4.1.15" href="https://datatracker.ietf.org/doc/html/rfc8829#section-4.1.15">4.1.15</a>.  currentRemoteDescription</span>

   currentRemoteDescription 方法返回当前协商后的远端描述的一个副本 —— 即最后一次
   offer/answer 交换成功的远端描述 —— 排除设置远程描述以来已通过 processIceMessage
   提供的任何远程候选网络。

   如果尚未完成 offer/answer 交换，则返回 null 对象。

<span class="h4"><a class="selflink" id="section-4.1.16" href="https://datatracker.ietf.org/doc/html/rfc8829#section-4.1.16">4.1.16</a>.  pendingRemoteDescription</span>

   pendingRemoteDescription 方法返回当前正在协商的远端描述的一个副本 —— 即
   不包含相应本地应答的远端邀约集合 —— 排除任何自远端描述设置后通过 processIceMessage
   设置的远端候选网络。

   如果 PeerConnection 的状态是 “stable” 或者 “have-local-offer” 则返回
   null 对象。

<span class="h4"><a class="selflink" id="section-4.1.17" href="https://datatracker.ietf.org/doc/html/rfc8829#section-4.1.17">4.1.17</a>.  canTrickleIceCandidates</span>

   canTrickleIceCandidates 属性标识远端是否支持接收候选网络涓流。有三种可能的值：

   null：没有从另一方收到SDP，所以不知道它是否能处理涓流。这是调用 setRemoteDescription
   之前的初始值。

   true：已从另一端收到 SDP，指示它可以支持涓流。

   false：已从另一边收到SDP，表示它不能支持涓流。

   如 <a href="https://datatracker.ietf.org/doc/html/rfc8829#section-3.5.2">3.5.2节</a> 所述，JSEP 实现始终单独为应用提供候选网络，与 ICE 涓流所需的一致。但
   是，应用程序可以使用 canTrickleIceCandidates 属性来确定他们的对等端实际上是否
   可以使用 ICE 涓流，即，在候选人中稍后发送初始报价或答案是安全的。值为 “true ”是
   唯一确定远端支持 ICE 涓流的值，应用程序将默认尝试在初始邀约和随后与涓流兼容代理
   的后续交互上进行初始邀约和完整涓涓细流的默认情况下涓涓细流的应用程序。

   应用将 canTrickleIceCandidates 的值与 true 比较，默认与 ICE 涓流代理在初始邀
   约尝试半涓流，以及后继的交互尝试全涓流。

<span class="h4"><a class="selflink" id="section-4.1.18" href="https://datatracker.ietf.org/doc/html/rfc8829#section-4.1.18">4.1.18</a>.  setConfiguration</span>

   setConfiguration 方法允许 PeerConnection 的全局配置(最初由构造函数参数设置)
   在会话期间更改。调用这种方法的影响取决于它何时调用，具体取决于更改了哪些特定参数
   影响也会有所不同：

   *  对 STUN/TURN 服务器的任何更改都会影响到下一个收集阶段。如果一个 ICE 收集阶段
      已经开始或完成，<a href="https://datatracker.ietf.org/doc/html/rfc8829#section-3.5.1">3.5.1节</a> 中提到的 “needs-ice-restart”位将被设置。这将导致下
      一次调用 createOffer 来生成新的 ICE 凭证，目的是强制 ICE 重启并开始一个新的
      收集阶段，在这个阶段中将使用新的服务器。如果 ICE 候选池的大小为非零且尚未应用本
      地描述，则将丢弃任何现有的候选池，并从新服务器收集新的候选。

   *  对 ICE 候选策略的任何更改都会影响下一个收集阶段。如果一个 ICE 收集阶段已经开始
      或完成，“needs-ice-restart” 位将被设置。无论哪种方式，对策略的更改都不会对候
      选池产生影响，因为在出现收集阶段之前，应用程序无法使用池中的候选，因此仍然可以
      对任何池中的候选执行任何必要的过滤。

   *  应用本地描述后， MUST NOT 改变 ICE 候选池的大小。如果本地描述还没有被应用，任
      何对ICE候选池大小的更改都会立即生效；如果增加，则预先收集更多的候选；如果减少，则
      丢弃现在多余的候选。

   *  在 PeerConnection 创建后，bundle 和 RTCP-multiplexing 策略 MUST NOT 被
      修改。

   调用此方法可能导致 ICE 代理的状态的更改。

<span class="h4"><a class="selflink" id="section-4.1.19" href="https://datatracker.ietf.org/doc/html/rfc8829#section-4.1.19">4.1.19</a>.  addIceCandidate</span>

   addIceCandidate 方法通过 IceCandidate 对象（<a href="https://datatracker.ietf.org/doc/html/rfc8829#section-3.5.2.1">第3.5.2.1节</a>）为 ICE 代理提供更新。
   如果 IceCandidate 的 candidate 字段是非空的，则 IceCandidate 被视为新的远程
   ICE 候选，这将根据为 ICE 涓流定义的规则添加到当前和/或挂起的远程描述中。否则，ICE
   候选被视为 end-of-candidates 的标识，如 <a href="https://datatracker.ietf.org/doc/html/rfc8838#section-14">[RFC8838]，第14节</a> 所定义。

   在任何一种情况下，已应用 IceCandidate 的 “m=” 块的索引 MID 和 ufrag 字段用于
   确定 IceCandidate 属于哪个 "m=" 块和 ICE 候选的生成，正如之前 <a href="htps://datatracker.ietf.org/doc/html/rfc8829apection-3.5.2.1">第3.5.2.1节</a> 所述。
   在 end-of-candidates 标识的情况下， “m=” 块的索引和 MID 字段的 null 值意味着
   应用于所有指定的 ICE 候选生成中的 “m=” 块。但是，如果新的远端候选这两个字段都是
   null，根据如下所述，MUST 将其作为无效情况。

   IceCandidate 的任何字段如果包含无效值或在处理 IceCandidate 对象时发生错误，
   MUST 忽略提供的 IceCandidate 并返回一个错误。

   否则，将向 ICE 代理提供新的远程候选或 end-of-candidates 指示。对于一个新的远端
   候选，连通检查将被发送到新的候选，前提是已经调用了 setLocalDescription 初始化了
   ICE 收集过程。

<span class="h4"><a class="selflink" id="section-4.1.20" href="https://datatracker.ietf.org/doc/html/rfc8829#section-4.1.20">4.1.20</a>.  onicecandidate 事件</span>

   onicecandidate 事件在两种情况下被下发给应用程序: (1) 当 ICE 代理在 ICE 收集过
   程中发现了一个新的允许的本地 ICE 候选，如 <a href="https://datatracker.ietf.org/doc/html/rfc8829#section-3.5.1">3.5.1节</a> 所述，并受 <a href="https://datatracker.ietf.org/doc/html/rfc8829#section-3.5.3">3.5.3节</a> 所讨论的限
   制，或者(2)当 ICE 收集阶段完成时。如 <a href="https://datatracker.ietf.org/doc/html/rfc8829#section-3.5.2.1">3.5.2.1节</a> 所定义 事件包含一个单一的
   IceCandidate 对象。

   在第一种情况下，新发现的候选在 IceCandidate 对象中，并且它的所有字段 MUST 是非
   空的。根据为 ICE 涓流定义的规则，这个候选也将被添加到当前和/或待定的本地描述中。

   在第二种情况下，事件的 IceCandidate 对象 MUST 将其 candidate 字段设置为 null，
   以表明当前收集阶段已经完成，即，在这个阶段将不再有其他的候选事件。然而，IceCandidate
   的 ufrag 字段 MUST 被指定，以表示哪个 ICE 候选的生成正在结束。IceCandidate 的
   “m=” 块索引和 MID 字段 MAY 指定，表示该事件适用于一个特定的 “m=” 块，或者设置为
   null，表示该事件适用于当前 ICE 候选生成中所有的 “m=” 块。应用程序可以使用此事件
   如 <a href="https://datatracker.ietf.org/doc/html/rfc8838#section-13">[RFC8838]第13节</a> 定义， 该事件可以被应用程序用来生成一个 end-of-candidates
   的标识。

<span class="h3"><a class="selflink" id="section-4.2" href="https://datatracker.ietf.org/doc/html/rfc8829#section-4.2">4.2</a>.  RtpTransceiver</span>

<span class="h4"><a class="selflink" id="section-4.2.1" href="https://datatracker.ietf.org/doc/html/rfc8829#section-4.2.1">4.2.1</a>.  stop</span>

   stop 方法停止一个 RtpTransceiver。这将导致以后为关联的 “m=” 块调用 createOffer
   生成一个零端口。详情见下文。

<span class="h4"><a class="selflink" id="section-4.2.2" href="https://datatracker.ietf.org/doc/html/rfc8829#section-4.2.2">4.2.2</a>.  stopped</span>

   stopped 属性标识收发器是否已经停止，可以通过调用 stop 函数，也可以通过应用拒绝关联
   的 “m=” 块的应答。在这两种情况下其被设置为“true”，否则被设置为“false”。

   停止的 RtpTransceiver 不会发送任何 RTP 或 RTCP 也不会处理任何接收到的
   RTP 或 RTCP。其无法被重启。

<span class="h4"><a class="selflink" id="section-4.2.3" href="https://datatracker.ietf.org/doc/html/rfc8829#section-4.2.3">4.2.3</a>.  setDirection</span>

   setDirection 方法设置收发器的方向，它会在以后调用 createOffer 和 createAnswer
   时影响关联的 “m=” 块的 direction 属性。direction 允许的值为 “recvonly”，
   “sendrecv”，“sendonly” 和 “inactive”，<a href="https://datatracker.ietf.org/doc/html/rfc4566#section-6">[RFC4566]第6节</a>中定义了相应的同名属性。

   当创建邀约时，收发器方向直接反映在输出，即使是再次邀约。当创建应答时，收发器方向是与
   邀约的方向交集，如下面的 <a href="https://datatracker.ietf.org/doc/html/rfc8829#section-5.3"></a>5.3节</a> 所述。

   注意，当 setDirection 设置收发器的 direction 属性时(<a href="https://datatracker.ietf.org/doc/html/rfc8829#section-4.2.4">4.2.4节</a>)，这个属性不会立
   即影响收发器的 RtpSender 是否会发送以及 RtpReceiver 是否会接收。有效的方向是由
   currentDirection 属性表示的，它只在应用一个应答时更新。

<span class="h4"><a class="selflink" id="section-4.2.4" href="https://datatracker.ietf.org/doc/html/rfc8829#section-4.2.4">4.2.4</a>.  direction</span>

   direction 属性表示传递给 setDirection 的最后一个值。如果 setDirection 从未被
   调用，其值为收发器初始化时的方向。

<span class="h4"><a class="selflink" id="section-4.2.5" href="https://datatracker.ietf.org/doc/html/rfc8829#section-4.2.5">4.2.5</a>.  currentDirection</span>

   currentDirection 属性表示收发器关联的 “m=” 块最后协商的方向。更具体地说，它指示
   了最后一个应用的应答(包括临时应答)中相应的 “m=” 块的方向属性[<a href="https://datatracker.ietf.org/doc/html/rfc3264" title="&quot;An Offer/Answer Model with Session Description Protocol (SDP)&quot;">RFC3264</a>]，如果它是远
   端应答，则“send”和“recv”方向颠倒。例如，如果远端应答中关联的 “m=” 块的 direction
   属性是“recvonly”，则 currentDirection 被设置为 “sendonly”。

   如果一个引用这个收发器的应答还没有被应用，或者收发器已经停止，currentDirection
   将被设置为 “null”。

<span class="h4"><a class="selflink" id="section-4.2.6" href="https://datatracker.ietf.org/doc/html/rfc8829#section-4.2.6">4.2.6</a>.  setCodecPreferences</span>

   setCodecPreferences 方法为收发器的编解码器设置首选项，这反过来影响在以后调用
   createOffer 和 createAnswer 时关联的“m=”块的编解码的出现顺序。请注意，
   setCodecPreferences 并不直接决定实现发送哪个编解码器。它使实现通过 offer 或
   answer 表明它更喜欢接收哪种编解码器。即使一个编解码器被 setCodecPreferences
   排除，它仍然可以被发送，直到下一个 offer/answer 交换排除了它。

   RtpTransceiver 的编解码器首选项可能导致后续 createOffer 和 createAnswer
   调用排除编解码器，在这种情况下，关联的 “m=” 块中相应的媒体格式将被排除。编解码器
   首选项不能添加不存在的媒体格式。

   RtpTransceiver 的编解码器首选项还可以确定后续 createOffer 和 createAnswer
   调用中编解码器的顺序，在这种情况下，关联的 “m=” 块中的媒体格式的顺序将遵循首选项
   指定的顺序。

<span class="h2"><a class="selflink" id="section-5" href="https://datatracker.ietf.org/doc/html/rfc8829#section-5">5</a>.  SDP的交互过程</span>

   本节介绍创建和解析SDP对象时需要遵循的具体步骤。

<span class="h3"><a class="selflink" id="section-5.1" href="https://datatracker.ietf.org/doc/html/rfc8829#section-5.1">5.1</a>.  要求概述</span>

   JSEP 的实现 MUST 符合下面列出的规范，该规范规定邀约和应答的创建和处理。

<span class="h4"><a class="selflink" id="section-5.1.1" href="https://datatracker.ietf.org/doc/html/rfc8829#section-5.1.1">5.1.1</a>.  使用要求</span>

   所有 JSEP 实现处理的的会话描述，包括本地和远端，MUST 支持如下规范。如果有遗漏，则
   此遗漏 MUST 视为错误。

   *  必须使用 [<a href="https://datatracker.ietf.org/doc/html/rfc8445" title="&quot;Interactive Connectivity Establishment (ICE): A Protocol for Network Address Translator (NAT) Traversal&quot;">RFC8445</a>] 中规定的 ICE。注意，远端可以使用精简实现；实现必须正确处理
      使用 ICE-lite 的远端描述。远程端点还可以使用旧版本的ICE；实现 MUST 正确处理使用
      [<a href="https://datatracker.ietf.org/doc/html/rfc5245" title="&quot;Interactive Connectivity Establishment (ICE): A Protocol for Network Address Translator (NAT) Traversal for Offer/Answer Protocols&quot;">RFC5245</a>] 中规定的 ICE 的远端。

   *  对于媒体类型 MUST 必须应用 DTLS [<a href="https://datatracker.ietf.org/doc/html/rfc6347" title="&quot;Datagram Transport Layer Security Version 1.2&quot;">RFC6347</a>] 或 DTLS-SRTP [<a href="https://datatracker.ietf.org/doc/html/rfc5763" title="&quot;Framework for Establishing a Secure Real-time Transport Protocol (SRTP) Security Context Using Datagram Transport Layer Security (DTLS)&quot;">RFC5763</a>]， as appropriate
      如[<a href="https://datatracker.ietf.org/doc/html/rfc8827" title="&quot;WebRTC Security Architecture&quot;">RFC8827</a>]中规定的。

   如 [<a href="https://datatracker.ietf.org/doc/html/rfc4568" title="&quot;Session Description Protocol (SDP) Security Descriptions for Media Streams&quot;">RFC8827</a>] 中所述，用于 SRTP keying[<a href="https://datatracker.ietf.org/doc/html/rfc8827" title="&quot;WebRTC Security Architecture&quot;">RFC8827</a>] 的 SDP 安全描述机制 MUST NOT 使用。

<span class="h4"><a class="selflink" id="section-5.1.2" href="https://datatracker.ietf.org/doc/html/rfc8829#section-5.1.2">5.1.2</a>.  配置名称和互操作性</span>

   对于媒体 “m=” 块，JSEP 实现必须支持 [<a href="https://datatracker.ietf.org/doc/html/rfc5764" title="&quot;Datagram Transport Layer Security (DTLS) Extension to Establish Keys for the Secure Real-time Transport Protocol (SRTP)&quot;">RFC5764</a>] 中指定的 "UDP/TLS/RTP/SAVPF"
   配置以及 [<a href="https://datatracker.ietf.org/doc/html/rfc7850" title="&quot;Registering Values of the SDP &#39;proto&#39; Field for Transporting RTP Media over TCP under Various RTP Profiles&quot;">RFC7850</a>] 中指定的 "TCP/DTLS/RTP/SAVPF" 配置，并且 MUST 为邀约中的
   每个媒体 "m=" 行指定其中之一。对于数据 “m=” 块，实现 MUST 支持 “UDP/DTLS/SCTP”
   和 “TCP/DTLS/SCTP” 配置并且 MUST 为邀约中的每个数据 “m=” 行指定其中之一。确切的
   配置是由与当前默认和选择 ICE 候选关联的规范定义的，其定义在<a href="https://datatracker.ietf.org/doc/html/rfc8839#section-4.2.1.2">[RFC8839], Section&nbsp;4.2.1.2</a>。

   不幸的是，为了兼容性，一些端点即使支持这些配置中的一个，也会生成其他配置字符串。例如，
   端点可能会生成 “RTP/AVP” 但提供 “a=fingerprint” 和 a=rtcp-fb” 属性，指示其支
   持 “UDP/TLS/RTP/SAVPF” 或 “TCP/DTLS/RTP/SAVPF”。为了简化与此类端点的兼容性，
   当处理收到的邀约中媒体 “m=” 块，JSEP 实现 MUST 遵循以下规则：

   *  邀约中任何匹配如下之一的配置 MUST 被接受:

      -  "RTP/AVP" (定义在 <a href="https://datatracker.ietf.org/doc/html/rfc4566#section-8.2.2">[RFC4566], Section&nbsp;8.2.2</a>)

      -  "RTP/AVPF" (定义在 <a href="https://datatracker.ietf.org/doc/html/rfc4585#section-9">[RFC4585], Section&nbsp;9</a>)

      -  "RTP/SAVP" (定义在 <a href="https://datatracker.ietf.org/doc/html/rfc3711#section-12">[RFC3711], Section&nbsp;12</a>)

      -  "RTP/SAVPF" (定义在 <a href="https://datatracker.ietf.org/doc/html/rfc5124#section-6">[RFC5124], Section&nbsp;6</a>)

      -  "TCP/DTLS/RTP/SAVP" (定义在 <a href="https://datatracker.ietf.org/doc/html/rfc7850#section-3.4">[RFC7850], Section&nbsp;3.4</a>)

      -  "TCP/DTLS/RTP/SAVPF" (定义在 <a href="https://datatracker.ietf.org/doc/html/rfc7850#section-3.5">[RFC7850], Section&nbsp;3.5</a>)

      -  "UDP/TLS/RTP/SAVP" (定义在 <a href="https://datatracker.ietf.org/doc/html/rfc5764#section-9">[RFC5764], Section&nbsp;9</a>)

      -  "UDP/TLS/RTP/SAVPF" (定义在 <a href="https://datatracker.ietf.org/doc/html/rfc5764#section-9">[RFC5764], Section&nbsp;9</a>)

   *  生成的应答中的 “m=” 行配置 MUST 完全符合对于邀约中配置的规定。

   *  由于 DTLS-SRTP 是 REQUIRED 的，所以选择 SAVP 或 AVP 没有影响；对 DTLS-SRTP
      的支持取决于是否存在一个或多个 “a=fingerprint” 属性。请注意，缺少 “a=fingerprint”
      属性将导致协商失败。

   *  AVPF 或 AVP 的使用只是控制用于 RTCP 反馈的计时规则。如果提供了 AVPF 或
      “a=rtcp-fb” 属性，假设 AVPF 计时，即默认值为 “trr-int=0”。否则，假设
      AVPF 是在 avp 兼容模式下使用的，并使用 “trr-int=4000” 的值。

   *  对于数据 "m=" 块，实现 MUST 支持接收 "UDP/DTLS/SCTP， "TCP/DTLS/SCTP"，
      或"DTLS/SCTP"(向后兼容)配置。

   注意，JSEP 实现的重新邀约 MUST 使用正确的配置字符串，即使最初的 offer/answer
   交换使用了一个(不正确的)旧的配置字符串。这简化了 JSEP 行为，减少了缺点，因为任何无
   法处理此类重新邀约的远程端点也将无法处理 JSEP 端点的初始邀约。

<span class="h3"><a class="selflink" id="section-5.2" href="https://datatracker.ietf.org/doc/html/rfc8829#section-5.2">5.2</a>.  构建一个邀约</span>

   当 createOffer 被调用时，必须创建一个新的 SDP 描述，包含在 [<a href="https://datatracker.ietf.org/doc/html/rfc8834" title="&quot;Media Transport and Use of RTP in WebRTC&quot;">RFC8834</a>] 中指定的功
   能。这个过程的具体细节如下所述。

<span class="h4"><a class="selflink" id="section-5.2.1" href="https://datatracker.ietf.org/doc/html/rfc8829#section-5.2.1">5.2.1</a>.  初始邀约</span>

   当 createOffer 第一次被调用时，其结果被称为初始邀约。

   生成初始邀约的第一步是生成会话级属性，如 <a href="https://datatracker.ietf.org/doc/html/rfc4566#section-5">[RFC4566] 第5节</a> 所述。具体地说：

   *  SDP 第一行必须是 “v=0”，如 <a href="https://datatracker.ietf.org/doc/html/rfc4566#section-5.1">[RFC4566]，5.1节</a> 定义。

   *  SDP 第二行必须是 "o=" 行，在 <a href="https://datatracker.ietf.org/doc/html/rfc4566#section-5.2">[RFC4566] 5.2节</a> 定义的。&lt;username&gt; 字段的值 SHOULD
      是 “-”。&lt;sess-id&gt; MUST 由64位有符号整数表示，值 MUST 小于 2^(63)-1。RECOMMENDED
      构造的 64 位 &lt;sess-id&gt; 数最高位为零，剩余的63位被加密地随机。&lt;nettype&gt;
      &lt;addrtype&gt; &lt;unicast-address&gt; 元组的值 SHOULD 设置为非有意义的地址，例如
      IP4 0.0.0.0，以防止在此字段中泄露本地IP地址；[<a href="https://datatracker.ietf.org/doc/html/rfc8828" title="&quot;WebRTC IP Address Handling Requirements&quot;">RFC8828</a>] 讨论了这个问题。如 [<a href="https://datatracker.ietf.org/doc/html/rfc4566" title="&quot;SDP: Session Description Protocol&quot;">RFC4566</a>] 中
      提到的，整个 “o=” 行需要是唯一的，&lt;sess-id&gt; 选择随机数足以满足这一目标。

   *  SD 第三行 MUST 是 “s=” 的行，在 <a href="https://datatracker.ietf.org/doc/html/rfc4566#section-5.3">[RFC4566] 5.3节</a> 中定义；为了匹配 “o=” 行，SHOULD 使用
      一个单线作为会话名称，例如，“s=-”。请注意，这与 [<a href="https://datatracker.ietf.org/doc/html/rfc4566" title="&quot;SDP: Session Description Protocol&quot;">RFC4566</a>] 中的建议不同，后者建议使用单个空
      格，但由于 “o=” 和 “s=” 在 JSEP 中都是无意义的，因此拥有相同的无意义值
      似乎更清晰。

   *  会话信息 ("i=")，URI ("u=")，邮件地址("e=")，电话号码 ("p="), 重复
      次数 ("r="), 时区 ("z=")
      行在场景下没有用，SHOULD NOT 包含进来。

   *  加密密钥(“k=”)行不能提供足够的安全性，MUST NOT 被包含。

   *  MUST 添加 “t=” 行，如 <a href="https://datatracker.ietf.org/doc/html/rfc4566#section-5.9">[RFC4566] 5.9节</a> 所述；&lt;start-time&gt; 和  &lt;stop-time&gt;
   都应该设置为0，例如"t=0 0"。

   *  MUST 添加带有 “trickle” 和 “ice2” 选项的 “a=ice-options” 行，具体请参见
      <a href="https://datatracker.ietf.org/doc/html/rfc8840#section-4.1.1">[RFC8840] 4.1.1节</a> 和 <a href="https://datatracker.ietf.org/doc/html/rfc8445#section-10">[RFC8445] 10节</a>。

   *  如果使用 WebRTC 标识，必须添加 “a=identity” 行，如 <a href="https://datatracker.ietf.org/doc/html/rfc8827#section-5">[RFC8827]第5节</a>
      所述。

   下一步是生成 “m=” 块，如 <a href="https://datatracker.ietf.org/doc/html/rfc4566#section-5.14">[RFC4566] 5.14节</a> 中所述。每个添加到 PeerConnection
   且排除停止的 RtpTransceiver 生成一个 "m=" 块，这是按照 RtpTransceivers 被添
   加到 PeerConnection 的顺序排列的。如果没有这样的 RtpTransceivers，不生成 “m=”
   块；如 <a href="https://datatracker.ietf.org/doc/html/rfc3264#section-5">[RFC3264]第5节</a> 所述，后面可以添加更多内容。

   RtpTransceiver 和对应的 “m=” 块通过 “m=” 块中的索引建立映射。

   每个 “m=” 块，如果没有标记为 bundle-only，MUST 包含一个唯一的 ICE 证书集合
   和一个唯一的 ICE 候选集合。Bundle-only 标记的 “m=” 块 MUST NOT 包含任何
   ICE 证书以及 MUST NOT 收集任何候选。

   对于 DTLS，所有的 “m=” 块 MUST 使用为 PeerConnection 指定的所有证书；因此，
   它们 MUST 都具有相同的指纹值 [<a href="https://datatracker.ietf.org/doc/html/rfc8122" title="&quot;Connection-Oriented Media Transport over the Transport Layer Security (TLS) Protocol in the Session Description Protocol (SDP)&quot;">RFC8122</a>]，或者这些值 MUST 是会话级属性。 as a result, they MUST

   每个 “m=” 块 MUST 按照 <a href="https://datatracker.ietf.org/doc/html/rfc4566#section-5.14">[RFC4566] &nbsp;5.14 节</a>的规定生成。对于 “m=” 行本身，MUST 遵循如下的规则：

   *  如果 “m=” 块被标记为 bundle-only，则 &lt;port&gt; MUST 被设置为零。否则
      &lt;port&gt; 被设置为当前 “m=” 块的默认 ICE 候选的端口，对于暂无候选的情况
      MUST 使用默认端口 9 (Discard)，正如 <a href="https://datatracker.ietf.org/doc/html/rfc8840#section-4.1.1">[RFC8840],
      4.1.1 节</a>所指定的。

   *  对于 DTLS 的正确指定，按照 <a href="https://datatracker.ietf.org/doc/html/rfc5764#section-8">[RFC5764],8 节</a> 的指定，&lt;proto&gt;字段 MUST 被设置为 “UDP/TLS/RTP/SAVPF”。

   *  如果关联的收发器的编解码偏好已经设置，媒体格式 MUST 按照响应的顺序进行生成，MUST
      排除任何没有在偏好中出现的编解码。

   *  除非被以上限制排除，媒体格式 MUST 包含 <a href="https://datatracker.ietf.org/doc/html/rfc7874#section-3">[RFC7874]，第 3 节</a> 和 <a href="https://datatracker.ietf.org/doc/html/rfc7742#section-5">[RFC7742] 第 5 节</a> 强制的 audio/video 编解码。

   “m=” 行 MUST 紧跟一个 “c=” 行，据 <a href="https://datatracker.ietf.org/doc/html/rfc4566#section-5.7">[RFC4566], 第 5.7节</a>指定。再次说明，当候选咱不可用时，
   “c=” 行必须包含默认的值 “IN IP4 0.0.0.0”，据 <a href="https://datatracker.ietf.org/doc/html/rfc8840#section-4.1.1">[RFC8840] 第 4.1.1 节</a>定义。

   [<a id="ref-RFC8859">RFC8859</a>] 将 SDP 属性分为不同类别。为避免捆绑时不
   必要的重复，类别属性 IDENTICAL 或 TRANSPORT MUST NOT 在捆绑的 “m=” 块中重复，
   重复性指导来自 <a href="https://datatracker.ietf.org/doc/html/rfc8843#section-7.1.3">[RFC8843] 第 7.1.3 节</a>。包括标记为绑定的
   已协商和即将协商的 “m=” 块。

   以下不属于 IDENTICAL 或 TRANSPORT 的属性类别，MUST 包含在每个 “m=” 块中"

   *  一个 “a=mid” 行，如 <a href="https://datatracker.ietf.org/doc/html/rfc5888#section-4">[RFC5888]，第 4 节</a>指定。所有 MID
      值 MUST 以不泄露用户信息的方式生成，例如，使用随机值或 PeerConnection
      的数量并且 SHOULD 不大于 3 比特，以满足 <a href="https://datatracker.ietf.org/doc/html/rfc8843#section-15.2">[RFC8843] 15.2 节</a> 中对 RTP 扩展头的定义。
      注意，这并没有设置 RtpTransceiver mid 属性，因为那只在应用描述时才会发生。
      此时，生成的 MID 值可以被认为是 “建议的” MID。

   *  一个 direction 属性，与相关的收发器的方向属性相同。

   *  For each media format on the "m=" line, "a=rtpmap" and "a=fmtp"
      lines, as specified in <a href="https://datatracker.ietf.org/doc/html/rfc4566#section-6">[RFC4566], Section&nbsp;6</a> and <a href="https://datatracker.ietf.org/doc/html/rfc3264#section-5.1">[RFC3264],
      Section&nbsp;5.1</a>.

   *  For each primary codec where RTP retransmission should be used, a
      corresponding "a=rtpmap" line indicating "rtx" with the clock rate
      of the primary codec and an "a=fmtp" line that references the
      payload type of the primary codec, as specified in <a href="https://datatracker.ietf.org/doc/html/rfc4588#section-8.1">[RFC4588],
      Section&nbsp;8.1</a>.

   *  For each supported Forward Error Correction (FEC) mechanism,
      "a=rtpmap" and "a=fmtp" lines, as specified in <a href="https://datatracker.ietf.org/doc/html/rfc4566#section-6">[RFC4566],
      Section&nbsp;6</a>.  The FEC mechanisms that MUST be supported are
      specified in <a href="https://datatracker.ietf.org/doc/html/rfc8854#section-7">[RFC8854], Section&nbsp;7</a>, and specific usage for each
      media type is outlined in Sections <a href="https://datatracker.ietf.org/doc/html/rfc8829#section-4">4</a> and <a href="https://datatracker.ietf.org/doc/html/rfc8829#section-5">5</a>.

   *  If this "m=" section is for media with configurable durations of
      media per packet, e.g., audio, an "a=maxptime" line, indicating
      the maximum amount of media, specified in milliseconds, that can
      be encapsulated in each packet, as specified in <a href="https://datatracker.ietf.org/doc/html/rfc4566#section-6">[RFC4566],
      Section&nbsp;6</a>.  This value is set to the smallest of the maximum
      duration values across all the codecs included in the "m="
      section.

   *  If this "m=" section is for video media and there are known
      limitations on the size of images that can be decoded, an
      "a=imageattr" line, as specified in <a href="https://datatracker.ietf.org/doc/html/rfc8829#section-3.6">Section 3.6</a>.

   *  For each supported RTP header extension, an "a=extmap" line, as
      specified in <a href="https://datatracker.ietf.org/doc/html/rfc5285#section-5">[RFC5285], Section&nbsp;5</a>.  The list of header extensions
      that SHOULD/MUST be supported is specified in <a href="https://datatracker.ietf.org/doc/html/rfc8834#section-5.2">[RFC8834],
      Section&nbsp;5.2</a>.  Any header extensions that require encryption MUST
      be specified as indicated in <a href="https://datatracker.ietf.org/doc/html/rfc6904#section-4">[RFC6904], Section&nbsp;4</a>.

   *  For each supported RTCP feedback mechanism, an "a=rtcp-fb" line,
      as specified in <a href="https://datatracker.ietf.org/doc/html/rfc4585#section-4.2">[RFC4585], Section&nbsp;4.2</a>.  The list of RTCP feedback
      mechanisms that SHOULD/MUST be supported is specified in
      <a href="https://datatracker.ietf.org/doc/html/rfc8834#section-5.1">[RFC8834], Section&nbsp;5.1</a>.

   *  If the RtpTransceiver has a sendrecv or sendonly direction:

      -  For each MediaStream that was associated with the transceiver
         when it was created via addTrack or addTransceiver, an "a=msid"
         line, as specified in <a href="https://datatracker.ietf.org/doc/html/rfc8830#section-2">[RFC8830], Section&nbsp;2</a>, but omitting the
         "appdata" field.

   *  If the RtpTransceiver has a sendrecv or sendonly direction, and
      the application has specified a rid-id for an encoding, or has
      specified more than one encoding in the RtpSenders's parameters,
      an "a=rid" line for each encoding specified.  The "a=rid" line is
      specified in [<a href="https://datatracker.ietf.org/doc/html/rfc8851" title="&quot;RTP Payload Format Restrictions&quot;">RFC8851</a>], and its direction MUST be "send".  If the
      application has chosen a rid-id, it MUST be used; otherwise, a
      rid-id MUST be generated by the implementation. rid-ids MUST be
      generated in a fashion that does not leak user information, e.g.,
      randomly or using a per-PeerConnection counter (see guidance at
      the end of <a href="https://datatracker.ietf.org/doc/html/rfc8852#section-3.3">[RFC8852], Section&nbsp;3.3</a>), and SHOULD be 3 bytes or less,
      to allow them to efficiently fit into the RTP header extensions
      defined in <a href="https://datatracker.ietf.org/doc/html/rfc8852#section-3.3">[RFC8852], Section&nbsp;3.3</a>.  If no encodings have been
      specified, or only one encoding is specified but without a rid-id,
      then no "a=rid" lines are generated.

   *  If the RtpTransceiver has a sendrecv or sendonly direction and
      more than one "a=rid" line has been generated, an "a=simulcast"
      line, with direction "send", as defined in <a href="https://datatracker.ietf.org/doc/html/rfc8853#section-5.1">[RFC8853], Section&nbsp;5.1</a>.
      The associated set of rid-ids MUST include all of the rid-ids used
      in the "a=rid" lines for this "m=" section.

   *  If (1) the bundle policy for this PeerConnection is set to "max-
      bundle" and this is not the first "m=" section or (2) the bundle
      policy is set to "balanced" and this is not the first "m=" section
      for this media type, an "a=bundle-only" line.

   The following attributes, which are of category IDENTICAL or
   TRANSPORT, MUST appear only in "m=" sections that either have a
   unique address or are associated with the BUNDLE-tag.  (In initial
   offers, this means those "m=" sections that do not contain an
   "a=bundle-only" attribute.)

   *  "a=ice-ufrag" and "a=ice-pwd" lines, as specified in <a href="https://datatracker.ietf.org/doc/html/rfc8839#section-5.4">[RFC8839],
      Section&nbsp;5.4</a>.

   *  For each desired digest algorithm, one or more "a=fingerprint"
      lines for each of the endpoint's certificates, as specified in
      <a href="https://datatracker.ietf.org/doc/html/rfc8122#section-5">[RFC8122], Section&nbsp;5</a>.

   *  An "a=setup" line, as specified in <a href="https://datatracker.ietf.org/doc/html/rfc4145#section-4">[RFC4145], Section&nbsp;4</a> and
      clarified for use in DTLS-SRTP scenarios in <a href="https://datatracker.ietf.org/doc/html/rfc5763#section-5">[RFC5763], Section&nbsp;5</a>.
      The role value in the offer MUST be "actpass".

   *  An "a=tls-id" line, as specified in <a href="https://datatracker.ietf.org/doc/html/rfc8842#section-5.2">[RFC8842], Section&nbsp;5.2</a>.

   *  An "a=rtcp" line, as specified in <a href="https://datatracker.ietf.org/doc/html/rfc3605#section-2.1">[RFC3605], Section&nbsp;2.1</a>,
      containing the default value "9 IN IP4 0.0.0.0", because no
      candidates have yet been gathered.

   *  An "a=rtcp-mux" line, as specified in <a href="https://datatracker.ietf.org/doc/html/rfc5761#section-5.1.3">[RFC5761], Section&nbsp;5.1.3</a>.

   *  If the RTP/RTCP multiplexing policy is "require", an "a=rtcp-mux-
      only" line, as specified in <a href="https://datatracker.ietf.org/doc/html/rfc8858#section-4">[RFC8858], Section&nbsp;4</a>.

   *  An "a=rtcp-rsize" line, as specified in <a href="https://datatracker.ietf.org/doc/html/rfc5506#section-5">[RFC5506], Section&nbsp;5</a>.

   Lastly, if a data channel has been created, an "m=" section MUST be
   generated for data.  The &lt;media&gt; field MUST be set to "application",
   and the &lt;proto&gt; field MUST be set to "UDP/DTLS/SCTP" [<a href="https://datatracker.ietf.org/doc/html/rfc8841" title="&quot;Session Description Protocol (SDP) Offer/Answer Procedures for Stream Control Transmission Protocol (SCTP) over Datagram Transport Layer Security (DTLS) Transport&quot;">RFC8841</a>].  The
   &lt;fmt&gt; value MUST be set to "webrtc-datachannel" as specified in
   <a href="https://datatracker.ietf.org/doc/html/rfc8841#section-4.2.2">[RFC8841], Section&nbsp;4.2.2</a>.

   Within the data "m=" section, an "a=mid" line MUST be generated and
   included as described above, along with an "a=sctp-port" line
   referencing the SCTP port number, as defined in <a href="https://datatracker.ietf.org/doc/html/rfc8841#section-5.1">[RFC8841],
   Section&nbsp;5.1</a>; and, if appropriate, an "a=max-message-size" line, as
   defined in <a href="https://datatracker.ietf.org/doc/html/rfc8841#section-6.1">[RFC8841], Section&nbsp;6.1</a>.

   As discussed above, the following attributes of category IDENTICAL or
   TRANSPORT are included only if the data "m=" section either has a
   unique address or is associated with the BUNDLE-tag (e.g., if it is
   the only "m=" section):

   *  "a=ice-ufrag"

   *  "a=ice-pwd"

   *  "a=fingerprint"

   *  "a=setup"

   *  "a=tls-id"

   Once all "m=" sections have been generated, a session-level "a=group"
   attribute MUST be added as specified in [<a href="https://datatracker.ietf.org/doc/html/rfc5888" title="&quot;The Session Description Protocol (SDP) Grouping Framework&quot;">RFC5888</a>].  This attribute
   MUST have semantics "BUNDLE" and MUST include the mid identifiers of
   each "m=" section.  The effect of this is that the JSEP
   implementation offers all "m=" sections as one bundle group.
   However, whether the "m=" sections are bundle-only or not depends on
   the bundle policy.

   The next step is to generate session-level lip sync groups as defined
   in <a href="https://datatracker.ietf.org/doc/html/rfc5888#section-7">[RFC5888], Section&nbsp;7</a>.  For each MediaStream referenced by more
   than one RtpTransceiver (by passing those MediaStreams as arguments
   to the addTrack and addTransceiver methods), a group of type "LS"
   MUST be added that contains the MID values for each RtpTransceiver.

   Attributes that SDP permits to be at either the session level or the
   media level SHOULD generally be at the media level even if they are
   identical.  This assists development and debugging by making it
   easier to understand individual media sections, especially if one of
   a set of initially identical attributes is subsequently changed.
   However, implementations MAY choose to aggregate attributes at the
   session level, and JSEP implementations MUST be prepared to receive
   attributes in either location.

   Attributes other than the ones specified above MAY be included,
   except for the following attributes, which are specifically
   incompatible with the requirements of [<a href="https://datatracker.ietf.org/doc/html/rfc8834" title="&quot;Media Transport and Use of RTP in WebRTC&quot;">RFC8834</a>] and MUST NOT be
   included:

   *  "a=crypto"

   *  "a=key-mgmt"

   *  "a=ice-lite"

   Note that when bundle is used, any additional attributes that are
   added MUST follow the advice in [<a href="https://datatracker.ietf.org/doc/html/rfc8859" title="&quot;A Framework for Session Description Protocol (SDP) Attributes When Multiplexing&quot;">RFC8859</a>] on how those attributes
   interact with bundle.

   Note that these requirements are in some cases stricter than those of
   SDP.  Implementations MUST be prepared to accept compliant SDP even
   if it would not conform to the requirements for generating SDP in
   this specification.

<span class="h4"><a class="selflink" id="section-5.2.2" href="https://datatracker.ietf.org/doc/html/rfc8829#section-5.2.2">5.2.2</a>.  Subsequent Offers</span>

   When createOffer is called a second (or later) time or is called
   after a local description has already been installed, the processing
   is somewhat different than for an initial offer.

   If the previous offer was not applied using setLocalDescription,
   meaning the PeerConnection is still in the "stable" state, the steps
   for generating an initial offer MUST be followed, subject to the
   following restriction:

   *  The fields of the "o=" line MUST stay the same except for the
      &lt;session-version&gt; field, which MUST increment by one on each call
      to createOffer if the offer might differ from the output of the
      previous call to createOffer; implementations MAY opt to increment
      &lt;session-version&gt; on every call.  The value of the generated
      &lt;session-version&gt; is independent of the &lt;session-version&gt; of the
      current local description; in particular, in the case where the
      current version is N, an offer is created and applied with version
      N+1, and then that offer is rolled back so that the current
      version is again N, the next generated offer will still have
      version N+2.

   Note that if the application creates an offer by reading
   currentLocalDescription instead of calling createOffer, the returned
   SDP may be different than when setLocalDescription was originally
   called, due to the addition of gathered ICE candidates, but the
   &lt;session-version&gt; will not have changed.  There are no known
   scenarios in which this causes problems, but if this is a concern,
   the solution is simply to use createOffer to ensure a unique
   &lt;session-version&gt;.

   If the previous offer was applied using setLocalDescription, but a
   corresponding answer from the remote side has not yet been applied,
   meaning the PeerConnection is still in the "have-local-offer" state,
   an offer is generated by following the steps in the "stable" state
   above, along with these exceptions:

   *  The "s=" and "t=" lines MUST stay the same.

   *  If any RtpTransceiver has been added and there exists an "m="
      section with a zero port in the current local description or the
      current remote description, that "m=" section MUST be recycled by
      generating an "m=" section for the added RtpTransceiver as if the
      "m=" section were being added to the session description
      (including a new MID value) and placing it at the same index as
      the "m=" section with a zero port.

   *  If an RtpTransceiver is stopped and is not associated with an "m="
      section, an "m=" section MUST NOT be generated for it.  This
      prevents adding back RtpTransceivers whose "m=" sections were
      recycled and used for a new RtpTransceiver in a previous offer/
      answer exchange, as described above.

   *  If an RtpTransceiver has been stopped and is associated with an
      "m=" section, and the "m=" section is not being recycled as
      described above, an "m=" section MUST be generated for it with the
      port set to zero and all "a=msid" lines removed.

   *  For RtpTransceivers that are not stopped, the "a=msid" line or
      lines MUST stay the same if they are present in the current
      description, regardless of changes to the transceiver's direction
      or track.  If no "a=msid" line is present in the current
      description, "a=msid" line(s) MUST be generated according to the
      same rules as for an initial offer.

   *  Each "m=" and "c=" line MUST be filled in with the port, relevant
      RTP profile, and address of the default candidate for the "m="
      section, as described in <a href="https://datatracker.ietf.org/doc/html/rfc8839#section-4.2.1.2">[RFC8839], Section&nbsp;4.2.1.2</a> and clarified
      in <a href="https://datatracker.ietf.org/doc/html/rfc8829#section-5.1.2">Section 5.1.2</a>.  If no RTP candidates have yet been gathered,
      default values MUST still be used, as described above.

   *  Each "a=mid" line MUST stay the same.

   *  Each "a=ice-ufrag" and "a=ice-pwd" line MUST stay the same, unless
      the ICE configuration has changed (e.g., changes to either the
      supported STUN/TURN servers or the ICE candidate policy) or the
      IceRestart option (<a href="https://datatracker.ietf.org/doc/html/rfc8829#section-5.2.3.1">Section 5.2.3.1</a>) was specified.  If the "m="
      section is bundled into another "m=" section, it still MUST NOT
      contain any ICE credentials.

   *  If the "m=" section is not bundled into another "m=" section, its
      "a=rtcp" attribute line MUST be filled in with the port and
      address of the default RTCP candidate, as indicated in <a href="https://datatracker.ietf.org/doc/html/rfc5761#section-5.1.3">[RFC5761],
      Section&nbsp;5.1.3</a>.  If no RTCP candidates have yet been gathered,
      default values MUST be used, as described in <a href="https://datatracker.ietf.org/doc/html/rfc8829#section-5.2.1">Section 5.2.1</a> above.

   *  If the "m=" section is not bundled into another "m=" section, for
      each candidate that has been gathered during the most recent
      gathering phase (see <a href="https://datatracker.ietf.org/doc/html/rfc8829#section-3.5.1">Section 3.5.1</a>), an "a=candidate" line MUST be
      added, as defined in <a href="https://datatracker.ietf.org/doc/html/rfc8839#section-5.1">[RFC8839], Section&nbsp;5.1</a>.  If candidate
      gathering for the section has completed, an "a=end-of-candidates"
      attribute MUST be added, as described in <a href="https://datatracker.ietf.org/doc/html/rfc8840#section-8.2">[RFC8840], Section&nbsp;8.2</a>.
      If the "m=" section is bundled into another "m=" section, both
      "a=candidate" and "a=end-of-candidates" MUST be omitted.

   *  For RtpTransceivers that are still present, the "a=rid" lines MUST
      stay the same.

   *  For RtpTransceivers that are still present, any "a=simulcast" line
      MUST stay the same.

   If the previous offer was applied using setLocalDescription, and a
   corresponding answer from the remote side has been applied using
   setRemoteDescription, meaning the PeerConnection is in the "have-
   remote-pranswer" state or the "stable" state, an offer is generated
   based on the negotiated session descriptions by following the steps
   mentioned for the "have-local-offer" state above.

   In addition, for each existing, non-recycled, non-rejected "m="
   section in the new offer, the following adjustments are made based on
   the contents of the corresponding "m=" section in the current local
   or remote description, as appropriate:

   *  The "m=" line and corresponding "a=rtpmap" and "a=fmtp" lines MUST
      only include media formats that have not been excluded by the
      codec preferences of the associated transceiver and also MUST
      include all currently available formats.  Media formats that were
      previously offered but are no longer available (e.g., a shared
      hardware codec) MAY be excluded.

   *  Unless codec preferences have been set for the associated
      transceiver, the media formats on the "m=" line MUST be generated
      in the same order as in the most recent answer.  Any media formats
      that were not present in the most recent answer MUST be added
      after all existing formats.

   *  The RTP header extensions MUST only include those that are present
      in the most recent answer.

   *  The RTCP feedback mechanisms MUST only include those that are
      present in the most recent answer, except for the case of format-
      specific mechanisms that are referencing a newly added media
      format.

   *  The "a=rtcp" line MUST NOT be added if the most recent answer
      included an "a=rtcp-mux" line.

   *  The "a=rtcp-mux" line MUST be the same as that in the most recent
      answer.

   *  The "a=rtcp-mux-only" line MUST NOT be added.

   *  The "a=rtcp-rsize" line MUST NOT be added unless present in the
      most recent answer.

   *  An "a=bundle-only" line, as defined in <a href="https://datatracker.ietf.org/doc/html/rfc8843#section-6">[RFC8843], Section&nbsp;6</a>, MUST
      NOT be added.  Instead, JSEP implementations MUST simply omit
      parameters in the IDENTICAL and TRANSPORT categories for bundled
      "m=" sections, as described in <a href="https://datatracker.ietf.org/doc/html/rfc8843#section-7.1.3">[RFC8843], Section&nbsp;7.1.3</a>.

   *  Note that if media "m=" sections are bundled into a data "m="
      section, then certain TRANSPORT and IDENTICAL attributes may
      appear in the data "m=" section even if they would otherwise only
      be appropriate for a media "m=" section (e.g., "a=rtcp-mux").
      This cannot happen in initial offers because in the initial offer
      JSEP implementations always list media "m=" sections (if any)
      before the data "m=" section (if any), and at least one of those
      media "m=" sections will not have the "a=bundle-only" attribute.
      Therefore, in initial offers, any "a=bundle-only" "m=" sections
      will be bundled into a preceding non-bundle-only media "m="
      section.

   The "a=group:BUNDLE" attribute MUST include the MID identifiers
   specified in the bundle group in the most recent answer, minus any
   "m=" sections that have been marked as rejected, plus any newly added
   or re-enabled "m=" sections.  In other words, the bundle attribute
   MUST contain all "m=" sections that were previously bundled, as long
   as they are still alive, as well as any new "m=" sections.

   "a=group:LS" attributes are generated in the same way as for initial
   offers, with the additional stipulation that any lip sync groups that
   were present in the most recent answer MUST continue to exist and
   MUST contain any previously existing MID identifiers, as long as the
   identified "m=" sections still exist and are not rejected, and the
   group still contains at least two MID identifiers.  This ensures that
   any synchronized "recvonly" "m=" sections continue to be synchronized
   in the new offer.

<span class="h4"><a class="selflink" id="section-5.2.3" href="https://datatracker.ietf.org/doc/html/rfc8829#section-5.2.3">5.2.3</a>.  Options Handling</span>

   The createOffer method takes as a parameter an RTCOfferOptions
   object.  Special processing is performed when generating an SDP
   description if the following options are present.

<span class="h5"><a class="selflink" id="section-5.2.3.1" href="https://datatracker.ietf.org/doc/html/rfc8829#section-5.2.3.1">5.2.3.1</a>.  IceRestart</span>

   If the IceRestart option is specified, with a value of "true", the
   offer MUST indicate an ICE restart by generating new ICE ufrag and
   pwd attributes, as specified in <a href="https://datatracker.ietf.org/doc/html/rfc8839#section-4.4.3.1.1">[RFC8839], Section&nbsp;4.4.3.1.1</a>.  If
   this option is specified on an initial offer, it has no effect (since
   a new ICE ufrag and pwd are already generated).  Similarly, if the
   ICE configuration has changed, this option has no effect, since new
   ufrag and pwd attributes will be generated automatically.  This
   option is primarily useful for reestablishing connectivity in cases
   where failures are detected by the application.

<span class="h5"><a class="selflink" id="section-5.2.3.2" href="https://datatracker.ietf.org/doc/html/rfc8829#section-5.2.3.2">5.2.3.2</a>.  VoiceActivityDetection</span>

   Silence suppression, also known as discontinuous transmission
   ("DTX"), can reduce the bandwidth used for audio by switching to a
   special encoding when voice activity is not detected, at the cost of
   some fidelity.

   If the "VoiceActivityDetection" option is specified, with a value of
   "true", the offer MUST indicate support for silence suppression in
   the audio it receives by including comfort noise ("CN") codecs for
   each offered audio codec, as specified in <a href="https://datatracker.ietf.org/doc/html/rfc3389#section-5.1">[RFC3389], Section&nbsp;5.1</a>,
   except for codecs that have their own internal silence suppression
   support.  For codecs that have their own internal silence suppression
   support, the appropriate fmtp parameters for that codec MUST be
   specified to indicate that silence suppression for received audio is
   desired.  For example, when using the Opus codec [<a href="https://datatracker.ietf.org/doc/html/rfc6716" title="&quot;Definition of the Opus Audio Codec&quot;">RFC6716</a>], the
   "usedtx=1" parameter, specified in [<a href="https://datatracker.ietf.org/doc/html/rfc7587" title="&quot;RTP Payload Format for the Opus Speech and Audio Codec&quot;">RFC7587</a>], would be used in the
   offer.

   If the "VoiceActivityDetection" option is specified, with a value of
   "false", the JSEP implementation MUST NOT emit "CN" codecs.  For
   codecs that have their own internal silence suppression support, the
   appropriate fmtp parameters for that codec MUST be specified to
   indicate that silence suppression for received audio is not desired.
   For example, when using the Opus codec, the "usedtx=0" parameter
   would be specified in the offer.  In addition, the implementation
   MUST NOT use silence suppression for media it generates, regardless
   of whether the "CN" codecs or related fmtp parameters appear in the
   peer's description.  The impact of these rules is that silence
   suppression in JSEP depends on mutual agreement of both sides, which
   ensures consistent handling regardless of which codec is used.

   The "VoiceActivityDetection" option does not have any impact on the
   setting of the "vad" value in the signaling of the client-to-mixer
   audio level header extension described in <a href="https://datatracker.ietf.org/doc/html/rfc6464#section-4">[RFC6464], Section&nbsp;4</a>.

<span class="h3"><a class="selflink" id="section-5.3" href="https://datatracker.ietf.org/doc/html/rfc8829#section-5.3">5.3</a>.  Generating an Answer</span>

   When createAnswer is called, a new SDP description MUST be created
   that is compatible with the supplied remote description as well as
   the requirements specified in [<a href="https://datatracker.ietf.org/doc/html/rfc8834" title="&quot;Media Transport and Use of RTP in WebRTC&quot;">RFC8834</a>].  The exact details of this
   process are explained below.

<span class="h4"><a class="selflink" id="section-5.3.1" href="https://datatracker.ietf.org/doc/html/rfc8829#section-5.3.1">5.3.1</a>.  Initial Answers</span>

   When createAnswer is called for the first time after a remote
   description has been provided, the result is known as the initial
   answer.  If no remote description has been installed, an answer
   cannot be generated, and an error MUST be returned.

   Note that the remote description SDP may not have been created by a
   JSEP endpoint and may not conform to all the requirements listed in
   <a href="https://datatracker.ietf.org/doc/html/rfc8829#section-5.2">Section 5.2</a>.  For many cases, this is not a problem.  However, if any
   mandatory SDP attributes are missing or functionality listed as
   mandatory-to-use above is not present, this MUST be treated as an
   error and MUST cause the affected "m=" sections to be marked as
   rejected.

   The first step in generating an initial answer is to generate
   session-level attributes.  The process here is identical to that
   indicated in <a href="https://datatracker.ietf.org/doc/html/rfc8829#section-5.2.1">Section 5.2.1</a> above, except that the "a=ice-options"
   line, with the "trickle" option as specified in <a href="https://datatracker.ietf.org/doc/html/rfc8840#section-4.1.3">[RFC8840],
   Section&nbsp;4.1.3</a> and the "ice2" option as specified in <a href="https://datatracker.ietf.org/doc/html/rfc8445#section-10">[RFC8445],
   Section&nbsp;10</a>, is only included if such an option was present in the
   offer.

   The next step is to generate session-level lip sync groups, as
   defined in <a href="https://datatracker.ietf.org/doc/html/rfc5888#section-7">[RFC5888], Section&nbsp;7</a>.  For each group of type "LS" present
   in the offer, select the local RtpTransceivers that are referenced by
   the MID values in the specified group, and determine which of them
   either reference a common local MediaStream (specified in the calls
   to addTrack/addTransceiver used to create them) or have no
   MediaStream to reference because they were not created by addTrack/
   addTransceiver.  If at least two such RtpTransceivers exist, a group
   of type "LS" with the MID values of these RtpTransceivers MUST be
   added.  Otherwise, the offered "LS" group MUST be ignored and no
   corresponding group generated in the answer.

   As a simple example, consider the following offer of a single audio
   and single video track contained in the same MediaStream.  SDP lines
   not relevant to this example have been removed for clarity.  As
   explained in <a href="https://datatracker.ietf.org/doc/html/rfc8829#section-5.2">Section 5.2</a>, a group of type "LS" has been added that
   references each track's RtpTransceiver.

             a=group:LS a1 v1
             m=audio 10000 UDP/TLS/RTP/SAVPF 0
             a=mid:a1
             a=msid:ms1
             m=video 10001 UDP/TLS/RTP/SAVPF 96
             a=mid:v1
             a=msid:ms1

   If the answerer uses a single MediaStream when it adds its tracks,
   both of its transceivers will reference this stream, and so the
   subsequent answer will contain a "LS" group identical to that in the
   offer, as shown below:

             a=group:LS a1 v1
             m=audio 20000 UDP/TLS/RTP/SAVPF 0
             a=mid:a1
             a=msid:ms2
             m=video 20001 UDP/TLS/RTP/SAVPF 96
             a=mid:v1
             a=msid:ms2

   However, if the answerer groups its tracks into separate
   MediaStreams, its transceivers will reference different streams, and
   so the subsequent answer will not contain a "LS" group.

             m=audio 20000 UDP/TLS/RTP/SAVPF 0
             a=mid:a1
             a=msid:ms2a
             m=video 20001 UDP/TLS/RTP/SAVPF 96
             a=mid:v1
             a=msid:ms2b

   Finally, if the answerer does not add any tracks, its transceivers
   will not reference any MediaStreams, causing the preferences of the
   offerer to be maintained, and so the subsequent answer will contain
   an identical "LS" group.

             a=group:LS a1 v1
             m=audio 20000 UDP/TLS/RTP/SAVPF 0
             a=mid:a1
             a=recvonly
             m=video 20001 UDP/TLS/RTP/SAVPF 96
             a=mid:v1
             a=recvonly

   The example in <a href="https://datatracker.ietf.org/doc/html/rfc8829#section-7.2">Section 7.2</a> shows a more involved case of "LS" group
   generation.

   The next step is to generate an "m=" section for each "m=" section
   that is present in the remote offer, as specified in <a href="https://datatracker.ietf.org/doc/html/rfc3264#section-6">[RFC3264],
   Section&nbsp;6</a>.  For the purposes of this discussion, any session-level
   attributes in the offer that are also valid as media-level attributes
   are considered to be present in each "m=" section.  Each offered "m="
   section will have an associated RtpTransceiver, as described in
   <a href="https://datatracker.ietf.org/doc/html/rfc8829#section-5.10">Section 5.10</a>.  If there are more RtpTransceivers than there are "m="
   sections, the unmatched RtpTransceivers will need to be associated in
   a subsequent offer.

   For each offered "m=" section, if any of the following conditions are
   true, the corresponding "m=" section in the answer MUST be marked as
   rejected by setting the &lt;port&gt; in the "m=" line to zero, as indicated
   in <a href="https://datatracker.ietf.org/doc/html/rfc3264#section-6">[RFC3264], Section&nbsp;6</a>, and further processing for this "m=" section
   can be skipped:

   *  The associated RtpTransceiver has been stopped.

   *  There is no offered media format that is both supported and, if
      applicable, allowed by codec preferences.

   *  The bundle policy is "max-bundle", and this is not the first "m="
      section or in the same bundle group as the first "m=" section.

   *  The bundle policy is "balanced", and this is not the first "m="
      section for this media type or in the same bundle group as the
      first "m=" section for this media type.

   *  This "m=" section is in a bundle group, and the group's offerer
      tagged "m=" section is being rejected due to one of the above
      reasons.  This requires all "m=" sections in the bundle group to
      be rejected, as specified in <a href="https://datatracker.ietf.org/doc/html/rfc8843#section-7.3.3">[RFC8843], Section&nbsp;7.3.3</a>.

   Otherwise, each "m=" section in the answer MUST then be generated as
   specified in <a href="https://datatracker.ietf.org/doc/html/rfc3264#section-6.1">[RFC3264], Section&nbsp;6.1</a>.  For the "m=" line itself, the
   following rules MUST be followed:

   *  The &lt;port&gt; value would normally be set to the port of the default
      ICE candidate for this "m=" section, but given that no candidates
      are available yet, the default &lt;port&gt; value of 9 (Discard) MUST be
      used, as indicated in <a href="https://datatracker.ietf.org/doc/html/rfc8840#section-4.1.1">[RFC8840], Section&nbsp;4.1.1</a>.

   *  The &lt;proto&gt; field MUST be set to exactly match the &lt;proto&gt; field
      for the corresponding "m=" line in the offer.

   *  If codec preferences have been set for the associated transceiver,
      media formats MUST be generated in the corresponding order,
      regardless of what was offered, and MUST exclude any codecs not
      present in the codec preferences.

   *  Otherwise, the media formats on the "m=" line MUST be generated in
      the same order as those offered in the current remote description,
      excluding any currently unsupported formats.  Any currently
      available media formats that are not present in the current remote
      description MUST be added after all existing formats.

   *  In either case, the media formats in the answer MUST include at
      least one format that is present in the offer but MAY include
      formats that are locally supported but not present in the offer,
      as mentioned in <a href="https://datatracker.ietf.org/doc/html/rfc3264#section-6.1">[RFC3264], Section&nbsp;6.1</a>.  If no common format
      exists, the "m=" section is rejected as described above.

   The "m=" line MUST be followed immediately by a "c=" line, as
   specified in <a href="https://datatracker.ietf.org/doc/html/rfc4566#section-5.7">[RFC4566], Section&nbsp;5.7</a>.  Again, as no candidates are
   available yet, the "c=" line MUST contain the default value "IN IP4
   0.0.0.0", as defined in <a href="https://datatracker.ietf.org/doc/html/rfc8840#section-4.1.3">[RFC8840], Section&nbsp;4.1.3</a>.

   If the offer supports bundle, all "m=" sections to be bundled MUST
   use the same ICE credentials and candidates; all "m=" sections not
   being bundled MUST use unique ICE credentials and candidates.  Each
   "m=" section MUST contain the following attributes (which are of
   attribute types other than IDENTICAL or TRANSPORT):

   *  If and only if present in the offer, an "a=mid" line, as specified
      in <a href="https://datatracker.ietf.org/doc/html/rfc5888#section-9.1">[RFC5888], Section&nbsp;9.1</a>.  The MID value MUST match that
      specified in the offer.

   *  A direction attribute, determined by applying the rules regarding
      the offered direction specified in <a href="https://datatracker.ietf.org/doc/html/rfc3264#section-6.1">[RFC3264], Section&nbsp;6.1</a>, and
      then intersecting with the direction of the associated
      RtpTransceiver.  For example, in the case where an "m=" section is
      offered as "sendonly" and the local transceiver is set to
      "sendrecv", the result in the answer is a "recvonly" direction.

   *  For each media format on the "m=" line, "a=rtpmap" and "a=fmtp"
      lines, as specified in <a href="https://datatracker.ietf.org/doc/html/rfc4566#section-6">[RFC4566], Section&nbsp;6</a> and <a href="https://datatracker.ietf.org/doc/html/rfc3264#section-6.1">[RFC3264],
      Section&nbsp;6.1</a>.

   *  If "rtx" is present in the offer, for each primary codec where RTP
      retransmission should be used, a corresponding "a=rtpmap" line
      indicating "rtx" with the clock rate of the primary codec and an
      "a=fmtp" line that references the payload type of the primary
      codec, as specified in <a href="https://datatracker.ietf.org/doc/html/rfc4588#section-8.1">[RFC4588], Section&nbsp;8.1</a>.

   *  For each supported FEC mechanism, "a=rtpmap" and "a=fmtp" lines,
      as specified in <a href="https://datatracker.ietf.org/doc/html/rfc4566#section-6">[RFC4566], Section&nbsp;6</a>.  The FEC mechanisms that
      MUST be supported are specified in <a href="https://datatracker.ietf.org/doc/html/rfc8854#section-7">[RFC8854], Section&nbsp;7</a>, and
      specific usage for each media type is outlined in Sections <a href="https://datatracker.ietf.org/doc/html/rfc8829#section-4">4</a> and
      5.

   *  If this "m=" section is for media with configurable durations of
      media per packet, e.g., audio, an "a=maxptime" line, as described
      in <a href="https://datatracker.ietf.org/doc/html/rfc8829#section-5.2">Section 5.2</a>.

   *  If this "m=" section is for video media and there are known
      limitations on the size of images that can be decoded, an
      "a=imageattr" line, as specified in <a href="https://datatracker.ietf.org/doc/html/rfc8829#section-3.6">Section 3.6</a>.

   *  For each supported RTP header extension that is present in the
      offer, an "a=extmap" line, as specified in <a href="https://datatracker.ietf.org/doc/html/rfc5285#section-5">[RFC5285], Section&nbsp;5</a>.
      The list of header extensions that SHOULD/MUST be supported is
      specified in <a href="https://datatracker.ietf.org/doc/html/rfc8834#section-5.2">[RFC8834], Section&nbsp;5.2</a>.  Any header extensions that
      require encryption MUST be specified as indicated in <a href="https://datatracker.ietf.org/doc/html/rfc6904#section-4">[RFC6904],
      Section&nbsp;4</a>.

   *  For each supported RTCP feedback mechanism that is present in the
      offer, an "a=rtcp-fb" line, as specified in <a href="https://datatracker.ietf.org/doc/html/rfc4585#section-4.2">[RFC4585],
      Section&nbsp;4.2</a>.  The list of RTCP feedback mechanisms that SHOULD/
      MUST be supported is specified in <a href="https://datatracker.ietf.org/doc/html/rfc8834#section-5.1">[RFC8834], Section&nbsp;5.1</a>.

   *  If the RtpTransceiver has a sendrecv or sendonly direction:

      -  For each MediaStream that was associated with the transceiver
         when it was created via addTrack or addTransceiver, an "a=msid"
         line, as specified in <a href="https://datatracker.ietf.org/doc/html/rfc8830#section-2">[RFC8830], Section&nbsp;2</a>, but omitting the
         "appdata" field.

   Each "m=" section that is not bundled into another "m=" section MUST
   contain the following attributes (which are of category IDENTICAL or
   TRANSPORT):

   *  "a=ice-ufrag" and "a=ice-pwd" lines, as specified in <a href="https://datatracker.ietf.org/doc/html/rfc8839#section-5.4">[RFC8839],
      Section&nbsp;5.4</a>.

   *  For each desired digest algorithm, one or more "a=fingerprint"
      lines for each of the endpoint's certificates, as specified in
      <a href="https://datatracker.ietf.org/doc/html/rfc8122#section-5">[RFC8122], Section&nbsp;5</a>.

   *  An "a=setup" line, as specified in <a href="https://datatracker.ietf.org/doc/html/rfc4145#section-4">[RFC4145], Section&nbsp;4</a> and
      clarified for use in DTLS-SRTP scenarios in <a href="https://datatracker.ietf.org/doc/html/rfc5763#section-5">[RFC5763], Section&nbsp;5</a>.
      The role value in the answer MUST be "active" or "passive".  When
      the offer contains the "actpass" value, as will always be the case
      with JSEP endpoints, the answerer SHOULD use the "active" role.
      Offers from non-JSEP endpoints MAY send other values for
      "a=setup", in which case the answer MUST use a value consistent
      with the value in the offer.

   *  An "a=tls-id" line, as specified in <a href="https://datatracker.ietf.org/doc/html/rfc8842#section-5.3">[RFC8842], Section&nbsp;5.3</a>.

   *  If present in the offer, an "a=rtcp-mux" line, as specified in
      <a href="https://datatracker.ietf.org/doc/html/rfc5761#section-5.1.3">[RFC5761], Section&nbsp;5.1.3</a>.  Otherwise, an "a=rtcp" line, as
      specified in <a href="https://datatracker.ietf.org/doc/html/rfc3605#section-2.1">[RFC3605], Section&nbsp;2.1</a>, containing the default value
      "9 IN IP4 0.0.0.0" (because no candidates have yet been gathered).

   *  If present in the offer, an "a=rtcp-rsize" line, as specified in
      <a href="https://datatracker.ietf.org/doc/html/rfc5506#section-5">[RFC5506], Section&nbsp;5</a>.

   If a data channel "m=" section has been offered, an "m=" section MUST
   also be generated for data.  The &lt;media&gt; field MUST be set to
   "application", and the &lt;proto&gt; and &lt;fmt&gt; fields MUST be set to
   exactly match the fields in the offer.

   Within the data "m=" section, an "a=mid" line MUST be generated and
   included as described above, along with an "a=sctp-port" line
   referencing the SCTP port number, as defined in <a href="https://datatracker.ietf.org/doc/html/rfc8841#section-5.1">[RFC8841],
   Section&nbsp;5.1</a>; and, if appropriate, an "a=max-message-size" line, as
   defined in <a href="https://datatracker.ietf.org/doc/html/rfc8841#section-6.1">[RFC8841], Section&nbsp;6.1</a>.

   As discussed above, the following attributes of category IDENTICAL or
   TRANSPORT are included only if the data "m=" section is not bundled
   into another "m=" section:

   *  "a=ice-ufrag"

   *  "a=ice-pwd"

   *  "a=fingerprint"

   *  "a=setup"

   *  "a=tls-id"

   Note that if media "m=" sections are bundled into a data "m="
   section, then certain TRANSPORT and IDENTICAL attributes may also
   appear in the data "m=" section even if they would otherwise only be
   appropriate for a media "m=" section (e.g., "a=rtcp-mux").

   If "a=group" attributes with semantics of "BUNDLE" are offered,
   corresponding session-level "a=group" attributes MUST be added as
   specified in [<a href="https://datatracker.ietf.org/doc/html/rfc5888" title="&quot;The Session Description Protocol (SDP) Grouping Framework&quot;">RFC5888</a>].  These attributes MUST have semantics
   "BUNDLE" and MUST include all mid identifiers from the offered bundle
   groups that have not been rejected.  Note that regardless of the
   presence of "a=bundle-only" in the offer, all "m=" sections in the
   answer MUST NOT have an "a=bundle-only" line.

   Attributes that are common between all "m=" sections MAY be moved to
   the session level if explicitly defined to be valid at the session
   level.

   The attributes prohibited in the creation of offers are also
   prohibited in the creation of answers.

<span class="h4"><a class="selflink" id="section-5.3.2" href="https://datatracker.ietf.org/doc/html/rfc8829#section-5.3.2">5.3.2</a>.  Subsequent Answers</span>

   When createAnswer is called a second (or later) time or is called
   after a local description has already been installed, the processing
   is somewhat different than for an initial answer.

   If the previous answer was not applied using setLocalDescription,
   meaning the PeerConnection is still in the "have-remote-offer" state,
   the steps for generating an initial answer MUST be followed, subject
   to the following restriction:

   *  The fields of the "o=" line MUST stay the same except for the
      &lt;session-version&gt; field, which MUST increment if the session
      description changes in any way from the previously generated
      answer.

   If any session description was previously supplied to
   setLocalDescription, an answer is generated by following the steps in
   the "have-remote-offer" state above, along with these exceptions:

   *  The "s=" and "t=" lines MUST stay the same.

   *  Each "m=" and "c=" line MUST be filled in with the port and
      address of the default candidate for the "m=" section, as
      described in <a href="https://datatracker.ietf.org/doc/html/rfc8839#section-4.2.1.2">[RFC8839], Section&nbsp;4.2.1.2</a>.  Note that in certain
      cases, the "m=" line protocol may not match that of the default
      candidate, because the "m=" line protocol value MUST match what
      was supplied in the offer, as described above.

   *  Each "a=ice-ufrag" and "a=ice-pwd" line MUST stay the same, unless
      the "m=" section is restarting, in which case new ICE credentials
      MUST be created as specified in <a href="https://datatracker.ietf.org/doc/html/rfc8839#section-4.4.1.1.1">[RFC8839], Section&nbsp;4.4.1.1.1</a>.  If
      the "m=" section is bundled into another "m=" section, it still
      MUST NOT contain any ICE credentials.

   *  Each "a=tls-id" line MUST stay the same, unless the offerer's
      "a=tls-id" line changed, in which case a new tls-id value MUST be
      created, as described in <a href="https://datatracker.ietf.org/doc/html/rfc8842#section-5.2">[RFC8842], Section&nbsp;5.2</a>.

   *  Each "a=setup" line MUST use an "active" or "passive" role value
      consistent with the existing DTLS association, if the association
      is being continued by the offerer.

   *  RTCP multiplexing MUST be used, and an "a=rtcp-mux" line inserted
      if and only if the "m=" section previously used RTCP multiplexing.

   *  If the "m=" section is not bundled into another "m=" section and
      RTCP multiplexing is not active, an "a=rtcp" attribute line MUST
      be filled in with the port and address of the default RTCP
      candidate.  If no RTCP candidates have yet been gathered, default
      values MUST be used, as described in <a href="https://datatracker.ietf.org/doc/html/rfc8829#section-5.3.1">Section 5.3.1</a> above.

   *  If the "m=" section is not bundled into another "m=" section, for
      each candidate that has been gathered during the most recent
      gathering phase (see <a href="https://datatracker.ietf.org/doc/html/rfc8829#section-3.5.1">Section 3.5.1</a>), an "a=candidate" line MUST be
      added, as defined in <a href="https://datatracker.ietf.org/doc/html/rfc8839#section-5.1">[RFC8839], Section&nbsp;5.1</a>.  If candidate
      gathering for the section has completed, an "a=end-of-candidates"
      attribute MUST be added, as described in <a href="https://datatracker.ietf.org/doc/html/rfc8840#section-8.2">[RFC8840], Section&nbsp;8.2</a>.
      If the "m=" section is bundled into another "m=" section, both
      "a=candidate" and "a=end-of-candidates" MUST be omitted.

   *  For RtpTransceivers that are not stopped, the "a=msid" line(s)
      MUST stay the same, regardless of changes to the transceiver's
      direction or track.  If no "a=msid" line is present in the current
      description, "a=msid" line(s) MUST be generated according to the
      same rules as for an initial answer.

<span class="h4"><a class="selflink" id="section-5.3.3" href="https://datatracker.ietf.org/doc/html/rfc8829#section-5.3.3">5.3.3</a>.  Options Handling</span>

   The createAnswer method takes as a parameter an RTCAnswerOptions
   object.  The set of parameters for RTCAnswerOptions is different than
   those supported in RTCOfferOptions; the IceRestart option is
   unnecessary, as ICE credentials will automatically be changed for all
   "m=" sections where the offerer chose to perform ICE restart.

   The following options are supported in RTCAnswerOptions.

<span class="h5"><a class="selflink" id="section-5.3.3.1" href="https://datatracker.ietf.org/doc/html/rfc8829#section-5.3.3.1">5.3.3.1</a>.  VoiceActivityDetection</span>

   Silence suppression in the answer is handled as described in
   <a href="https://datatracker.ietf.org/doc/html/rfc8829#section-5.2.3.2">Section 5.2.3.2</a>, with one exception: if support for silence
   suppression was not indicated in the offer, the
   VoiceActivityDetection parameter has no effect, and the answer MUST
   be generated as if VoiceActivityDetection was set to "false".  This
   is done on a per-codec basis (e.g., if the offerer somehow offered
   support for CN but set "usedtx=0" for Opus, setting
   VoiceActivityDetection to "true" would result in an answer with CN
   codecs and "usedtx=0").  The impact of this rule is that an answerer
   will not try to use silence suppression with any endpoint that does
   not offer it, making silence suppression support bilateral even with
   non-JSEP endpoints.

<span class="h3"><a class="selflink" id="section-5.4" href="https://datatracker.ietf.org/doc/html/rfc8829#section-5.4">5.4</a>.  Modifying an Offer or Answer</span>

   The SDP returned from createOffer or createAnswer MUST NOT be changed
   before passing it to setLocalDescription.  If precise control over
   the SDP is needed, the aforementioned createOffer/createAnswer
   options or RtpTransceiver APIs MUST be used.

   After calling setLocalDescription with an offer or answer, the
   application MAY modify the SDP to reduce its capabilities before
   sending it to the far side, as long as it follows the rules above
   that define a valid JSEP offer or answer.  Likewise, an application
   that has received an offer or answer from a peer MAY modify the
   received SDP, subject to the same constraints, before calling
   setRemoteDescription.

   As always, the application is solely responsible for what it sends to
   the other party, and all incoming SDP will be processed by the JSEP
   implementation to the extent of its capabilities.  It is an error to
   assume that all SDP is well formed; however, one should be able to
   assume that any implementation of this specification will be able to
   process, as a remote offer or answer, unmodified SDP coming from any
   other implementation of this specification.

<span class="h3"><a class="selflink" id="section-5.5" href="https://datatracker.ietf.org/doc/html/rfc8829#section-5.5">5.5</a>.  Processing a Local Description</span>

   When a SessionDescription is supplied to setLocalDescription, the
   following steps MUST be performed:

   *  If the description is of type "rollback", follow the processing
      defined in <a href="https://datatracker.ietf.org/doc/html/rfc8829#section-5.7">Section 5.7</a> and skip the processing described in the
      rest of this section.

   *  Otherwise, the type of the SessionDescription is checked against
      the current state of the PeerConnection:

      -  If the type is "offer", the PeerConnection state MUST be either
         "stable" or "have-local-offer".

      -  If the type is "pranswer" or "answer", the PeerConnection state
         MUST be either "have-remote-offer" or "have-local-pranswer".

   *  If the type is not correct for the current state, processing MUST
      stop and an error MUST be returned.

   *  The SessionDescription is then checked to ensure that its contents
      are identical to those generated in the last call to createOffer/
      createAnswer, and thus have not been altered, as discussed in
      <a href="https://datatracker.ietf.org/doc/html/rfc8829#section-5.4">Section 5.4</a>; otherwise, processing MUST stop and an error MUST be
      returned.

   *  Next, the SessionDescription is parsed into a data structure, as
      described in <a href="https://datatracker.ietf.org/doc/html/rfc8829#section-5.8">Section 5.8</a> below.

   *  Finally, the parsed SessionDescription is applied as described in
      <a href="https://datatracker.ietf.org/doc/html/rfc8829#section-5.9">Section 5.9</a> below.

<span class="h3"><a class="selflink" id="section-5.6" href="https://datatracker.ietf.org/doc/html/rfc8829#section-5.6">5.6</a>.  Processing a Remote Description</span>

   When a SessionDescription is supplied to setRemoteDescription, the
   following steps MUST be performed:

   *  If the description is of type "rollback", follow the processing
      defined in <a href="https://datatracker.ietf.org/doc/html/rfc8829#section-5.7">Section 5.7</a> and skip the processing described in the
      rest of this section.

   *  Otherwise, the type of the SessionDescription is checked against
      the current state of the PeerConnection:

      -  If the type is "offer", the PeerConnection state MUST be either
         "stable" or "have-remote-offer".

      -  If the type is "pranswer" or "answer", the PeerConnection state
         MUST be either "have-local-offer" or "have-remote-pranswer".

   *  If the type is not correct for the current state, processing MUST
      stop and an error MUST be returned.

   *  Next, the SessionDescription is parsed into a data structure, as
      described in <a href="https://datatracker.ietf.org/doc/html/rfc8829#section-5.8">Section 5.8</a> below.  If parsing fails for any reason,
      processing MUST stop and an error MUST be returned.

   *  Finally, the parsed SessionDescription is applied as described in
      <a href="https://datatracker.ietf.org/doc/html/rfc8829#section-5.10">Section 5.10</a> below.

<span class="h3"><a class="selflink" id="section-5.7" href="https://datatracker.ietf.org/doc/html/rfc8829#section-5.7">5.7</a>.  Processing a Rollback</span>

   A rollback may be performed if the PeerConnection is in any state
   except for "stable".  This means that both offers and provisional
   answers can be rolled back.  Rollback can only be used to cancel
   proposed changes; there is no support for rolling back from a
   "stable" state to a previous "stable" state.  If a rollback is
   attempted in the "stable" state, processing MUST stop and an error
   MUST be returned.  Note that this implies that once the answerer has
   performed setLocalDescription with its answer, this cannot be rolled
   back.

   The effect of rollback MUST be the same regardless of whether
   setLocalDescription or setRemoteDescription is called.

   In order to process rollback, a JSEP implementation abandons the
   current offer/answer transaction, sets the signaling state to
   "stable", and sets the pending local and/or remote description (see
   Sections <a href="https://datatracker.ietf.org/doc/html/rfc8829#section-4.1.14">4.1.14</a> and <a href="https://datatracker.ietf.org/doc/html/rfc8829#section-4.1.16">4.1.16</a>) to "null".  Any resources or candidates
   that were allocated by the abandoned local description are discarded;
   any media that is received is processed according to the previous
   local and remote descriptions.

   A rollback disassociates any RtpTransceivers that were associated
   with "m=" sections by the application of the rolled-back session
   description (see Sections <a href="https://datatracker.ietf.org/doc/html/rfc8829#section-5.10">5.10</a> and <a href="https://datatracker.ietf.org/doc/html/rfc8829#section-5.9">5.9</a>).  This means that some
   RtpTransceivers that were previously associated will no longer be
   associated with any "m=" section; in such cases, the value of the
   RtpTransceiver's mid property MUST be set to "null", and the mapping
   between the transceiver and its "m=" section index MUST be discarded.
   RtpTransceivers that were created by applying a remote offer that was
   subsequently rolled back MUST be stopped and removed from the
   PeerConnection.  However, an RtpTransceiver MUST NOT be removed if a
   track was attached to the RtpTransceiver via the addTrack method.
   This is so that an application may call addTrack, then call
   setRemoteDescription with an offer, then roll back that offer, then
   call createOffer and have an "m=" section for the added track appear
   in the generated offer.

<span class="h3"><a class="selflink" id="section-5.8" href="https://datatracker.ietf.org/doc/html/rfc8829#section-5.8">5.8</a>.  Parsing a Session Description</span>

   The SDP contained in the session description object consists of a
   sequence of text lines, each containing a key-value expression, as
   described in <a href="https://datatracker.ietf.org/doc/html/rfc4566#section-5">[RFC4566], Section&nbsp;5</a>.  The SDP is read, line by line,
   and converted to a data structure that contains the deserialized
   information.  However, SDP allows many types of lines, not all of
   which are relevant to JSEP applications.  For each line, the
   implementation will first ensure that it is syntactically correct
   according to its defining ABNF, check that it conforms to the
   semantics used in [<a href="https://datatracker.ietf.org/doc/html/rfc4566" title="&quot;SDP: Session Description Protocol&quot;">RFC4566</a>] and [<a href="https://datatracker.ietf.org/doc/html/rfc3264" title="&quot;An Offer/Answer Model with Session Description Protocol (SDP)&quot;">RFC3264</a>], and then either parse and
   store or discard the provided value, as described below.

   If any line is not well formed or cannot be parsed as described, the
   parser MUST stop with an error and reject the session description,
   even if the value is to be discarded.  This ensures that
   implementations do not accidentally misinterpret ambiguous SDP.

<span class="h4"><a class="selflink" id="section-5.8.1" href="https://datatracker.ietf.org/doc/html/rfc8829#section-5.8.1">5.8.1</a>.  Session-Level Parsing</span>

   First, the session-level lines are checked and parsed.  These lines
   MUST occur in a specific order, and with a specific syntax, as
   defined in <a href="https://datatracker.ietf.org/doc/html/rfc4566#section-5">[RFC4566], Section&nbsp;5</a>.  Note that while the specific line
   types (e.g., "v=", "c=") MUST occur in the defined order, lines of
   the same type (typically "a=") can occur in any order.

   The following non-attribute lines are not meaningful in the JSEP
   context and MAY be discarded once they have been checked.

   *  The "c=" line MUST be checked for syntax, but its value is only
      used for ICE mismatch detection, as defined in <a href="https://datatracker.ietf.org/doc/html/rfc8445#section-5.4">[RFC8445],
      Section&nbsp;5.4</a>.  Note that JSEP implementations should never
      encounter this condition because ICE is required for WebRTC.

   *  The "i=", "u=", "e=", "p=", "t=", "r=", "z=", and "k=" lines MUST
      be checked for syntax, but their values are not otherwise used.

   The remaining non-attribute lines are processed as follows:

   *  The "v=" line MUST have a version of 0, as specified in <a href="https://datatracker.ietf.org/doc/html/rfc4566#section-5.1">[RFC4566],
      Section&nbsp;5.1</a>.

   *  The "o=" line MUST be parsed as specified in <a href="https://datatracker.ietf.org/doc/html/rfc4566#section-5.2">[RFC4566],
      Section&nbsp;5.2</a>.

   *  The "b=" line, if present, MUST be parsed as specified in
      <a href="https://datatracker.ietf.org/doc/html/rfc4566#section-5.8">[RFC4566], Section&nbsp;5.8</a>, and the bwtype and bandwidth values
      stored.

   Finally, the attribute lines are processed.  Specific processing MUST
   be applied for the following session-level attribute ("a=") lines:

   *  Any "a=group" lines are parsed as specified in <a href="https://datatracker.ietf.org/doc/html/rfc5888#section-5">[RFC5888],
      Section&nbsp;5</a>, and the group's semantics and mids are stored.

   *  If present, a single "a=ice-lite" line is parsed as specified in
      <a href="https://datatracker.ietf.org/doc/html/rfc8839#section-5.3">[RFC8839], Section&nbsp;5.3</a>, and a value indicating the presence of
      ice-lite is stored.

   *  If present, a single "a=ice-ufrag" line is parsed as specified in
      <a href="https://datatracker.ietf.org/doc/html/rfc8839#section-5.4">[RFC8839], Section&nbsp;5.4</a>, and the ufrag value is stored.

   *  If present, a single "a=ice-pwd" line is parsed as specified in
      <a href="https://datatracker.ietf.org/doc/html/rfc8839#section-5.4">[RFC8839], Section&nbsp;5.4</a>, and the password value is stored.

   *  If present, a single "a=ice-options" line is parsed as specified
      in <a href="https://datatracker.ietf.org/doc/html/rfc8839#section-5.6">[RFC8839], Section&nbsp;5.6</a>, and the set of specified options is
      stored.

   *  Any "a=fingerprint" lines are parsed as specified in <a href="https://datatracker.ietf.org/doc/html/rfc8122#section-5">[RFC8122],
      Section&nbsp;5</a>, and the set of fingerprint and algorithm values is
      stored.

   *  If present, a single "a=setup" line is parsed as specified in
      <a href="https://datatracker.ietf.org/doc/html/rfc4145#section-4">[RFC4145], Section&nbsp;4</a>, and the setup value is stored.

   *  If present, a single "a=tls-id" line is parsed as specified in
      <a href="https://datatracker.ietf.org/doc/html/rfc8842#section-5">[RFC8842], Section&nbsp;5</a>, and the attribute value is stored.

   *  Any "a=identity" lines are parsed and the identity values stored
      for subsequent verification, as specified in <a href="https://datatracker.ietf.org/doc/html/rfc8827#section-5">[RFC8827], Section&nbsp;5</a>.

   *  Any "a=extmap" lines are parsed as specified in <a href="https://datatracker.ietf.org/doc/html/rfc5285#section-5">[RFC5285],
      Section&nbsp;5</a>, and their values are stored.

   Other attributes that are not relevant to JSEP may also be present,
   and implementations SHOULD process any that they recognize.  As
   required by <a href="https://datatracker.ietf.org/doc/html/rfc4566#section-5.13">[RFC4566], Section&nbsp;5.13</a>, unknown attribute lines MUST be
   ignored.

   Once all the session-level lines have been parsed, processing
   continues with the lines in "m=" sections.

<span class="h4"><a class="selflink" id="section-5.8.2" href="https://datatracker.ietf.org/doc/html/rfc8829#section-5.8.2">5.8.2</a>.  Media Section Parsing</span>

   Like the session-level lines, the media section lines MUST occur in
   the specific order and with the specific syntax defined in <a href="https://datatracker.ietf.org/doc/html/rfc4566#section-5">[RFC4566],
   Section&nbsp;5</a>.

   The "m=" line itself MUST be parsed as described in <a href="https://datatracker.ietf.org/doc/html/rfc4566#section-5.14">[RFC4566],
   Section&nbsp;5.14</a>, and the &lt;media&gt;, &lt;port&gt;, &lt;proto&gt;, and &lt;fmt&gt; values
   stored.

   Following the "m=" line, specific processing MUST be applied for the
   following non-attribute lines:

   *  As with the "c=" line at the session level, the "c=" line MUST be
      parsed according to <a href="https://datatracker.ietf.org/doc/html/rfc4566#section-5.7">[RFC4566], Section&nbsp;5.7</a>, but its value is not
      used.

   *  The "b=" line, if present, MUST be parsed as specified in
      <a href="https://datatracker.ietf.org/doc/html/rfc4566#section-5.8">[RFC4566], Section&nbsp;5.8</a>, and the bwtype and bandwidth values
      stored.

   Specific processing MUST also be applied for the following attribute
   lines:

   *  If present, a single "a=ice-ufrag" line is parsed as specified in
      <a href="https://datatracker.ietf.org/doc/html/rfc8839#section-5.4">[RFC8839], Section&nbsp;5.4</a>, and the ufrag value is stored.

   *  If present, a single "a=ice-pwd" line is parsed as specified in
      <a href="https://datatracker.ietf.org/doc/html/rfc8839#section-5.4">[RFC8839], Section&nbsp;5.4</a>, and the password value is stored.

   *  If present, a single "a=ice-options" line is parsed as specified
      in <a href="https://datatracker.ietf.org/doc/html/rfc8839#section-5.6">[RFC8839], Section&nbsp;5.6</a>, and the set of specified options is
      stored.

   *  Any "a=candidate" attributes MUST be parsed as specified in
      <a href="https://datatracker.ietf.org/doc/html/rfc8839#section-5.1">[RFC8839], Section&nbsp;5.1</a>, and their values stored.

   *  Any "a=remote-candidates" attributes MUST be parsed as specified
      in <a href="https://datatracker.ietf.org/doc/html/rfc8839#section-5.2">[RFC8839], Section&nbsp;5.2</a>, but their values are ignored.

   *  If present, a single "a=end-of-candidates" attribute MUST be
      parsed as specified in <a href="https://datatracker.ietf.org/doc/html/rfc8840#section-8.1">[RFC8840], Section&nbsp;8.1</a>, and its presence or
      absence flagged and stored.

   *  Any "a=fingerprint" lines are parsed as specified in <a href="https://datatracker.ietf.org/doc/html/rfc8122#section-5">[RFC8122],
      Section&nbsp;5</a>, and the set of fingerprint and algorithm values is
      stored.

   If the "m=" &lt;proto&gt; value indicates use of RTP, as described in
   <a href="https://datatracker.ietf.org/doc/html/rfc8829#section-5.1.2">Section 5.1.2</a> above, the following attribute lines MUST be processed:

   *  The "m=" &lt;fmt&gt; value MUST be parsed as specified in <a href="https://datatracker.ietf.org/doc/html/rfc4566#section-5.14">[RFC4566],
      Section&nbsp;5.14</a>, and the individual values stored.

   *  Any "a=rtpmap" or "a=fmtp" lines MUST be parsed as specified in
      <a href="https://datatracker.ietf.org/doc/html/rfc4566#section-6">[RFC4566], Section&nbsp;6</a>, and their values stored.

   *  If present, a single "a=ptime" line MUST be parsed as described in
      <a href="https://datatracker.ietf.org/doc/html/rfc4566#section-6">[RFC4566], Section&nbsp;6</a>, and its value stored.

   *  If present, a single "a=maxptime" line MUST be parsed as described
      in <a href="https://datatracker.ietf.org/doc/html/rfc4566#section-6">[RFC4566], Section&nbsp;6</a>, and its value stored.

   *  If present, a single direction attribute line (e.g., "a=sendrecv")
      MUST be parsed as described in <a href="https://datatracker.ietf.org/doc/html/rfc4566#section-6">[RFC4566], Section&nbsp;6</a>, and its value
      stored.

   *  Any "a=ssrc" attributes MUST be parsed as specified in <a href="https://datatracker.ietf.org/doc/html/rfc5576#section-4.1">[RFC5576],
      Section&nbsp;4.1</a>, and their values stored.

   *  Any "a=extmap" attributes MUST be parsed as specified in
      <a href="https://datatracker.ietf.org/doc/html/rfc5285#section-5">[RFC5285], Section&nbsp;5</a>, and their values stored.

   *  Any "a=rtcp-fb" attributes MUST be parsed as specified in
      <a href="https://datatracker.ietf.org/doc/html/rfc4585#section-4.2">[RFC4585], Section&nbsp;4.2</a>, and their values stored.

   *  If present, a single "a=rtcp-mux" attribute MUST be parsed as
      specified in <a href="https://datatracker.ietf.org/doc/html/rfc5761#section-5.1.3">[RFC5761], Section&nbsp;5.1.3</a>, and its presence or absence
      flagged and stored.

   *  If present, a single "a=rtcp-mux-only" attribute MUST be parsed as
      specified in <a href="https://datatracker.ietf.org/doc/html/rfc8858#section-3">[RFC8858], Section&nbsp;3</a>, and its presence or absence
      flagged and stored.

   *  If present, a single "a=rtcp-rsize" attribute MUST be parsed as
      specified in <a href="https://datatracker.ietf.org/doc/html/rfc5506#section-5">[RFC5506], Section&nbsp;5</a>, and its presence or absence
      flagged and stored.

   *  If present, a single "a=rtcp" attribute MUST be parsed as
      specified in <a href="https://datatracker.ietf.org/doc/html/rfc3605#section-2.1">[RFC3605], Section&nbsp;2.1</a>, but its value is ignored, as
      this information is superfluous when using ICE.

   *  If present, "a=msid" attributes MUST be parsed as specified in
      <a href="https://datatracker.ietf.org/doc/html/rfc8830#section-3.2">[RFC8830], Section&nbsp;3.2</a>, and their values stored, ignoring any
      "appdata" field.  If no "a=msid" attributes are present, a random
      msid-id value is generated for a "default" MediaStream for the
      session, if not already present, and this value is stored.

   *  Any "a=imageattr" attributes MUST be parsed as specified in
      <a href="https://datatracker.ietf.org/doc/html/rfc6236#section-3">[RFC6236], Section&nbsp;3</a>, and their values stored.

   *  Any "a=rid" lines MUST be parsed as specified in <a href="https://datatracker.ietf.org/doc/html/rfc8851#section-10">[RFC8851],
      Section&nbsp;10</a>, and their values stored.

   *  If present, a single "a=simulcast" line MUST be parsed as
      specified in [<a href="https://datatracker.ietf.org/doc/html/rfc8853" title="&quot;Using Simulcast in Session Description Protocol (SDP) and RTP Sessions&quot;">RFC8853</a>], and its values stored.

   Otherwise, if the "m=" &lt;proto&gt; value indicates use of SCTP, the
   following attribute lines MUST be processed:

   *  The "m=" &lt;fmt&gt; value MUST be parsed as specified in <a href="https://datatracker.ietf.org/doc/html/rfc8841#section-4.3">[RFC8841],
      Section&nbsp;4.3</a>, and the application protocol value stored.

   *  An "a=sctp-port" attribute MUST be present, and it MUST be parsed
      as specified in <a href="https://datatracker.ietf.org/doc/html/rfc8841#section-5.2">[RFC8841], Section&nbsp;5.2</a>, and the value stored.

   *  If present, a single "a=max-message-size" attribute MUST be parsed
      as specified in <a href="https://datatracker.ietf.org/doc/html/rfc8841#section-6">[RFC8841], Section&nbsp;6</a>, and the value stored.
      Otherwise, use the specified default.

   Other attributes that are not relevant to JSEP may also be present,
   and implementations SHOULD process any that they recognize.  As
   required by <a href="https://datatracker.ietf.org/doc/html/rfc4566#section-5.13">[RFC4566], Section&nbsp;5.13</a>, unknown attribute lines MUST be
   ignored.

<span class="h4"><a class="selflink" id="section-5.8.3" href="https://datatracker.ietf.org/doc/html/rfc8829#section-5.8.3">5.8.3</a>.  Semantics Verification</span>

   Assuming that parsing completes successfully, the parsed description
   is then evaluated to ensure internal consistency as well as proper
   support for mandatory features.  Specifically, the following checks
   are performed:

   *  For each "m=" section, valid values for each of the mandatory-to-
      use features enumerated in <a href="https://datatracker.ietf.org/doc/html/rfc8829#section-5.1.1">Section 5.1.1</a> MUST be present.  These
      values MAY be either present at the media level or inherited from
      the session level.

      -  ICE ufrag and password values, which MUST comply with the size
         limits specified in <a href="https://datatracker.ietf.org/doc/html/rfc8839#section-5.4">[RFC8839], Section&nbsp;5.4</a>.

      -  A tls-id value, which MUST be set according to <a href="https://datatracker.ietf.org/doc/html/rfc8842#section-5">[RFC8842],
         Section&nbsp;5</a>.  If this is a re-offer or a response to a re-offer
         and the tls-id value is different from that presently in use,
         the DTLS connection is not being continued and the remote
         description MUST be part of an ICE restart, together with new
         ufrag and password values.

      -  A DTLS setup value, which MUST be set according to the rules
         specified in <a href="https://datatracker.ietf.org/doc/html/rfc5763#section-5">[RFC5763], Section&nbsp;5</a> and MUST be consistent with
         the selected role of the current DTLS connection, if one exists
         and is being continued.

      -  DTLS fingerprint values, where at least one fingerprint MUST be
         present.

   *  All rid-ids referenced in an "a=simulcast" line MUST exist as
      "a=rid" lines.

   *  Each "m=" section is also checked to ensure that prohibited
      features are not used.

   *  If the RTP/RTCP multiplexing policy is "require", each "m="
      section MUST contain an "a=rtcp-mux" attribute.  If an "m="
      section contains an "a=rtcp-mux-only" attribute, that section MUST
      also contain an "a=rtcp-mux" attribute.

   *  If an "m=" section was present in the previous answer, the state
      of RTP/RTCP multiplexing MUST match what was previously
      negotiated.

   If this session description is of type "pranswer" or "answer", the
   following additional checks are applied:

   *  The session description MUST follow the rules defined in
      <a href="https://datatracker.ietf.org/doc/html/rfc3264#section-6">[RFC3264], Section&nbsp;6</a>, including the requirement that the number of
      "m=" sections MUST exactly match the number of "m=" sections in
      the associated offer.

   *  For each "m=" section, the media type and protocol values MUST
      exactly match the media type and protocol values in the
      corresponding "m=" section in the associated offer.

   If any of the preceding checks failed, processing MUST stop and an
   error MUST be returned.

<span class="h3"><a class="selflink" id="section-5.9" href="https://datatracker.ietf.org/doc/html/rfc8829#section-5.9">5.9</a>.  Applying a Local Description</span>

   The following steps are performed at the media engine level to apply
   a local description.  If an error is returned, the session MUST be
   restored to the state it was in before performing these steps.

   First, "m=" sections are processed.  For each "m=" section, the
   following steps MUST be performed; if any parameters are out of
   bounds or cannot be applied, processing MUST stop and an error MUST
   be returned.

   *  If this "m=" section is new, begin gathering candidates for it, as
      defined in <a href="https://datatracker.ietf.org/doc/html/rfc8445#section-5.1.1">[RFC8445], Section&nbsp;5.1.1</a>, unless it is definitively
      being bundled (either (1) this is an offer and the "m=" section is
      marked bundle-only or (2) it is an answer and the "m=" section is
      bundled into another "m=" section).

   *  Or, if the ICE ufrag and password values have changed, trigger the
      ICE agent to start an ICE restart as described in <a href="https://datatracker.ietf.org/doc/html/rfc8445#section-9">[RFC8445],
      Section&nbsp;9</a>, and begin gathering new candidates for the "m="
      section.  If this description is an answer, also start checks on
      that media section.

   *  If the "m=" section &lt;proto&gt; value indicates use of RTP:

      -  If there is no RtpTransceiver associated with this "m="
         section, find one and associate it with this "m=" section
         according to the following steps.  Note that this situation
         will only occur when applying an offer.

         o  Find the RtpTransceiver that corresponds to this "m="
            section, using the mapping between transceivers and "m="
            section indices established when creating the offer.

         o  Set the value of this RtpTransceiver's mid property to the
            MID of the "m=" section.

      -  If RTCP mux is indicated, prepare to demux RTP and RTCP from
         the RTP ICE component, as specified in <a href="https://datatracker.ietf.org/doc/html/rfc5761#section-5.1.3">[RFC5761],
         Section&nbsp;5.1.3</a>.

      -  For each specified RTP header extension, establish a mapping
         between the extension ID and URI, as described in <a href="https://datatracker.ietf.org/doc/html/rfc5285#section-6">[RFC5285],
         Section&nbsp;6</a>.

      -  If the MID header extension is supported, prepare to demux RTP
         streams intended for this "m=" section based on the MID header
         extension, as described in <a href="https://datatracker.ietf.org/doc/html/rfc8843#section-15">[RFC8843], Section&nbsp;15</a>.

      -  For each specified media format, establish a mapping between
         the payload type and the actual media format, as described in
         <a href="https://datatracker.ietf.org/doc/html/rfc3264#section-6.1">[RFC3264], Section&nbsp;6.1</a>.  In addition, prepare to demux RTP
         streams intended for this "m=" section based on the media
         formats supported by this "m=" section, as described in
         <a href="https://datatracker.ietf.org/doc/html/rfc8843#section-9.2">[RFC8843], Section&nbsp;9.2</a>.

      -  For each specified "rtx" media format, establish a mapping
         between the RTX payload type and its associated primary payload
         type, as described in Sections <a href="https://datatracker.ietf.org/doc/html/rfc8829#section-8.6">8.6</a> and <a href="https://datatracker.ietf.org/doc/html/rfc8829#section-8.7">8.7</a> of [<a href="https://datatracker.ietf.org/doc/html/rfc4588" title="&quot;RTP Retransmission Payload Format&quot;">RFC4588</a>].

      -  If the direction attribute is of type "sendrecv" or "recvonly",
         enable receipt and decoding of media.

   Finally, if this description is of type "pranswer" or "answer",
   follow the processing defined in <a href="https://datatracker.ietf.org/doc/html/rfc8829#section-5.11">Section 5.11</a> below.

<span class="h3"><a class="selflink" id="section-5.10" href="https://datatracker.ietf.org/doc/html/rfc8829#section-5.10">5.10</a>.  Applying a Remote Description</span>

   The following steps are performed to apply a remote description.  If
   an error is returned, the session MUST be restored to the state it
   was in before performing these steps.

   If the answer contains any "a=ice-options" attributes where "trickle"
   is listed as an attribute, update the PeerConnection
   canTrickleIceCandidates property to be "true".  Otherwise, set this
   property to "false".

   The following steps MUST be performed for attributes at the session
   level; if any parameters are out of bounds or cannot be applied,
   processing MUST stop and an error MUST be returned.

   *  For any specified "CT" bandwidth value, set this value as the
      limit for the maximum total bitrate for all "m=" sections, as
      specified in <a href="https://datatracker.ietf.org/doc/html/rfc4566#section-5.8">[RFC4566], Section&nbsp;5.8</a>.  Within this overall limit,
      the implementation can dynamically decide how to best allocate the
      available bandwidth between "m=" sections, respecting any specific
      limits that have been specified for individual "m=" sections.

   *  For any specified "RR" or "RS" bandwidth values, handle as
      specified in <a href="https://datatracker.ietf.org/doc/html/rfc3556#section-2">[RFC3556], Section&nbsp;2</a>.

   *  Any "AS" bandwidth value (<a href="https://datatracker.ietf.org/doc/html/rfc4566#section-5.8">[RFC4566], Section&nbsp;5.8</a>) MUST be ignored,
      as the meaning of this construct at the session level is not well
      defined.

   For each "m=" section, the following steps MUST be performed; if any
   parameters are out of bounds or cannot be applied, processing MUST
   stop and an error MUST be returned.

   *  If the ICE ufrag or password changed from the previous remote
      description:

      -  If the description is of type "offer", the implementation MUST
         note that an ICE restart is needed, as described in <a href="https://datatracker.ietf.org/doc/html/rfc8839#section-4.4.1.1.1">[RFC8839],
         Section&nbsp;4.4.1.1.1</a>.

      -  If the description is of type "answer" or "pranswer", then
         check to see if the current local description is an ICE
         restart, and if not, generate an error.  If the PeerConnection
         state is "have-remote-pranswer" and the ICE ufrag or password
         changed from the previous provisional answer, then signal the
         ICE agent to discard any previous ICE checklist state for the
         "m=" section.  Finally, signal the ICE agent to begin checks.

   *  If the current local description indicates an ICE restart but
      neither the ICE ufrag nor the password has changed from the
      previous remote description (as prescribed by <a href="https://datatracker.ietf.org/doc/html/rfc8445#section-9">[RFC8445],
      Section&nbsp;9</a>), generate an error.

   *  Configure the ICE components associated with this media section to
      use the supplied ICE remote ufrag and password for their
      connectivity checks.

   *  Pair any supplied ICE candidates with any gathered local
      candidates, as described in <a href="https://datatracker.ietf.org/doc/html/rfc8445#section-6.1.2">[RFC8445], Section&nbsp;6.1.2</a>, and start
      connectivity checks with the appropriate credentials.

   *  If an "a=end-of-candidates" attribute is present, process the end-
      of-candidates indication as described in <a href="https://datatracker.ietf.org/doc/html/rfc8838#section-14">[RFC8838], Section&nbsp;14</a>.

   *  If the "m=" section &lt;proto&gt; value indicates use of RTP:

      -  If the "m=" section is being recycled (see <a href="https://datatracker.ietf.org/doc/html/rfc8829#section-5.2.2">Section 5.2.2</a>),
         disassociate the currently associated RtpTransceiver by setting
         its mid property to "null", and discard the mapping between the
         transceiver and its "m=" section index.

      -  If the "m=" section is not associated with any RtpTransceiver
         (possibly because it was disassociated in the previous step),
         either find an RtpTransceiver or create one according to the
         following steps:

         o  If the "m=" section is sendrecv or recvonly, and there are
            RtpTransceivers of the same type that were added to the
            PeerConnection by addTrack and are not associated with any
            "m=" section and are not stopped, find the first (according
            to the canonical order described in <a href="https://datatracker.ietf.org/doc/html/rfc8829#section-5.2.1">Section 5.2.1</a>) such
            RtpTransceiver.

         o  If no RtpTransceiver was found in the previous step, create
            one with a recvonly direction.

         o  Associate the found or created RtpTransceiver with the "m="
            section by setting the value of the RtpTransceiver's mid
            property to the MID of the "m=" section, and establish a
            mapping between the transceiver and the index of the "m="
            section.  If the "m=" section does not include a MID (i.e.,
            the remote endpoint does not support the MID extension),
            generate a value for the RtpTransceiver mid property,
            following the guidance for "a=mid" mentioned in
            <a href="https://datatracker.ietf.org/doc/html/rfc8829#section-5.2.1">Section 5.2.1</a>.

      -  For each specified media format that is also supported by the
         local implementation, establish a mapping between the specified
         payload type and the media format, as described in <a href="https://datatracker.ietf.org/doc/html/rfc3264#section-6.1">[RFC3264],
         Section&nbsp;6.1</a>.  Specifically, this means that the implementation
         records the payload type to be used in outgoing RTP packets
         when sending each specified media format, as well as the
         relative preference for each format that is indicated in their
         ordering.  If any indicated media format is not supported by
         the local implementation, it MUST be ignored.

      -  For each specified "rtx" media format, establish a mapping
         between the RTX payload type and its associated primary payload
         type, as described in <a href="https://datatracker.ietf.org/doc/html/rfc4588#section-4">[RFC4588], Section&nbsp;4</a>.  If any referenced
         primary payload types are not present, this MUST result in an
         error.  Note that RTX payload types may refer to primary
         payload types that are not supported by the local media
         implementation, in which case the RTX payload type MUST also be
         ignored.

      -  For each specified fmtp parameter that is supported by the
         local implementation, enable them on the associated media
         formats.

      -  For each specified Synchronization Source (SSRC) that is
         signaled in the "m=" section, prepare to demux RTP streams
         intended for this "m=" section using that SSRC, as described in
         <a href="https://datatracker.ietf.org/doc/html/rfc8843#section-9.2">[RFC8843], Section&nbsp;9.2</a>.

      -  For each specified RTP header extension that is also supported
         by the local implementation, establish a mapping between the
         extension ID and URI, as described in <a href="https://datatracker.ietf.org/doc/html/rfc5285#section-5">[RFC5285], Section&nbsp;5</a>.
         Specifically, this means that the implementation records the
         extension ID to be used in outgoing RTP packets when sending
         each specified header extension.  If any indicated RTP header
         extension is not supported by the local implementation, it MUST
         be ignored.

      -  For each specified RTCP feedback mechanism that is supported by
         the local implementation, enable them on the associated media
         formats.

      -  For any specified "TIAS" ("Transport Independent Application
         Specific Maximum") bandwidth value, set this value as a
         constraint on the maximum RTP bitrate to be used when sending
         media, as specified in [<a href="https://datatracker.ietf.org/doc/html/rfc3890" title="&quot;A Transport Independent Bandwidth Modifier for the Session Description Protocol (SDP)&quot;">RFC3890</a>].  If a "TIAS" value is not
         present but an "AS" value is specified, generate a "TIAS" value
         using this formula:

            TIAS = AS * 1000 * 0.95 - (50 * 40 * 8)

         The 1000 changes the unit from kbps to bps (as required by
         TIAS), and the 0.95 is to allocate 5% to RTCP.  An estimate of
         header overhead is then subtracted out, in which the 50 is
         based on 50 packets per second, the 40 is based on typical
         header size (in bytes), and the 8 converts bytes to bits.  Note
         that "TIAS" is preferred over "AS" because it provides more
         accurate control of bandwidth.

      -  For any "RR" or "RS" bandwidth values, handle as specified in
         <a href="https://datatracker.ietf.org/doc/html/rfc3556#section-2">[RFC3556], Section&nbsp;2</a>.

      -  Any specified "CT" bandwidth value MUST be ignored, as the
         meaning of this construct at the media level is not well
         defined.

      -  If the "m=" section is of type "audio":

         o  For each specified "CN" media format, configure silence
            suppression for all supported media formats with the same
            clock rate, as described in <a href="https://datatracker.ietf.org/doc/html/rfc3389#section-5">[RFC3389], Section&nbsp;5</a>, except for
            formats that have their own internal silence suppression
            mechanisms.  Silence suppression for such formats (e.g.,
            Opus) is controlled via fmtp parameters, as discussed in
            <a href="https://datatracker.ietf.org/doc/html/rfc8829#section-5.2.3.2">Section 5.2.3.2</a>.

         o  For each specified "telephone-event" media format, enable
            dual-tone multifrequency (DTMF) transmission for all
            supported media formats with the same clock rate, as
            described in <a href="https://datatracker.ietf.org/doc/html/rfc4733#section-2.5.1.2">[RFC4733], Section&nbsp;2.5.1.2</a>.  If there are any
            supported media formats that do not have a corresponding
            telephone-event format, disable DTMF transmission for those
            formats.

         o  For any specified "ptime" value, configure the available
            media formats to use the specified packet size when sending.
            If the specified size is not supported for a media format,
            use the next closest value instead.

   Finally, if this description is of type "pranswer" or "answer",
   follow the processing defined in <a href="https://datatracker.ietf.org/doc/html/rfc8829#section-5.11">Section 5.11</a> below.

<span class="h3"><a class="selflink" id="section-5.11" href="https://datatracker.ietf.org/doc/html/rfc8829#section-5.11">5.11</a>.  Applying an Answer</span>

   In addition to the steps mentioned above for processing a local or
   remote description, the following steps are performed when processing
   a description of type "pranswer" or "answer".

   For each "m=" section, the following steps MUST be performed:

   *  If the "m=" section has been rejected (i.e., the &lt;port&gt; value is
      set to zero in the answer), stop any reception or transmission of
      media for this section, and, unless a non-rejected "m=" section is
      bundled with this "m=" section, discard any associated ICE
      components, as described in <a href="https://datatracker.ietf.org/doc/html/rfc8839#section-4.4.3.1">[RFC8839], Section&nbsp;4.4.3.1</a>.

   *  If the remote DTLS fingerprint has been changed or the value of
      the "a=tls-id" attribute has changed, tear down the DTLS
      connection.  This includes the case when the PeerConnection state
      is "have-remote-pranswer".  If a DTLS connection needs to be torn
      down but the answer does not indicate an ICE restart or, in the
      case of "have-remote-pranswer", new ICE credentials, an error MUST
      be generated.  If an ICE restart is performed without a change in
      the tls-id value or fingerprint, then the same DTLS connection is
      continued over the new ICE channel.  Note that although JSEP
      requires that answerers change the tls-id value if and only if the
      offerer does, non-JSEP answerers are permitted to change the tls-
      id value as long as the offer contained an ICE restart.  Thus,
      JSEP implementations that process DTLS data prior to receiving an
      answer MUST be prepared to receive either a ClientHello or data
      from the previous DTLS connection.

   *  If no valid DTLS connection exists, prepare to start a DTLS
      connection, using the specified roles and fingerprints, on any
      underlying ICE components, once they are active.

   *  If the "m=" section &lt;proto&gt; value indicates use of RTP:

      -  If the "m=" section references RTCP feedback mechanisms that
         were not present in the corresponding "m=" section in the
         offer, this indicates a negotiation problem and MUST result in
         an error.  However, new media formats and new RTP header
         extension values are permitted in the answer, as described in
         <a href="https://datatracker.ietf.org/doc/html/rfc3264#section-7">[RFC3264], Section&nbsp;7</a> and <a href="https://datatracker.ietf.org/doc/html/rfc5285#section-6">[RFC5285], Section&nbsp;6</a>.

      -  If the "m=" section has RTCP mux enabled, discard the RTCP ICE
         component, if one exists, and begin or continue muxing RTCP
         over the RTP ICE component, as specified in <a href="https://datatracker.ietf.org/doc/html/rfc5761#section-5.1.3">[RFC5761],
         Section&nbsp;5.1.3</a>.  Otherwise, prepare to transmit RTCP over the
         RTCP ICE component; if no RTCP ICE component exists because
         RTCP mux was previously enabled, this MUST result in an error.

      -  If the "m=" section has Reduced-Size RTCP enabled, configure
         the RTCP transmission for this "m=" section to use Reduced-Size
         RTCP, as specified in [<a href="https://datatracker.ietf.org/doc/html/rfc5506" title="&quot;Support for Reduced-Size Real-Time Transport Control Protocol (RTCP): Opportunities and Consequences&quot;">RFC5506</a>].

      -  If the direction attribute in the answer indicates that the
         JSEP implementation should be sending media ("sendonly" for
         local answers, "recvonly" for remote answers, or "sendrecv" for
         either type of answer), choose the media format to send as the
         most preferred media format from the remote description that is
         also locally supported, as discussed in Sections <a href="https://datatracker.ietf.org/doc/html/rfc8829#section-6.1">6.1</a> and <a href="https://datatracker.ietf.org/doc/html/rfc8829#section-7">7</a> of
         [<a href="https://datatracker.ietf.org/doc/html/rfc3264" title="&quot;An Offer/Answer Model with Session Description Protocol (SDP)&quot;">RFC3264</a>], and start transmitting RTP media using that format
         once the underlying transport layers have been established.  If
         an SSRC has not already been chosen for this outgoing RTP
         stream, choose a unique random one.  If media is already being
         transmitted, the same SSRC SHOULD be used unless the clock rate
         of the new codec is different, in which case a new SSRC MUST be
         chosen, as specified in <a href="https://datatracker.ietf.org/doc/html/rfc7160#section-4.1">[RFC7160], Section&nbsp;4.1</a>.

      -  The payload type mapping from the remote description is used to
         determine payload types for the outgoing RTP streams, including
         the payload type for the send media format chosen above.  Any
         RTP header extensions that were negotiated should be included
         in the outgoing RTP streams, using the extension mapping from
         the remote description.  If the MID header extension has been
         negotiated, include it in the outgoing RTP streams, as
         indicated in <a href="https://datatracker.ietf.org/doc/html/rfc8843#section-15">[RFC8843], Section&nbsp;15</a>.  If the RtpStreamId or
         RepairedRtpStreamId header extensions have been negotiated and
         rid-ids have been established, include these header extensions
         in the outgoing RTP streams, as indicated in <a href="https://datatracker.ietf.org/doc/html/rfc8851#section-4">[RFC8851],
         Section&nbsp;4</a>.

      -  If the "m=" section is of type "audio", and silence suppression
         was (1) configured for the send media format as a result of
         processing the remote description and (2) also enabled for that
         format in the local description, use silence suppression for
         outgoing media, in accordance with the guidance in
         <a href="https://datatracker.ietf.org/doc/html/rfc8829#section-5.2.3.2">Section 5.2.3.2</a>.  If these conditions are not met, silence
         suppression MUST NOT be used for outgoing media.

      -  If simulcast has been negotiated, send the appropriate number
         of Source RTP Streams as specified in <a href="https://datatracker.ietf.org/doc/html/rfc8853#section-5.3.3">[RFC8853], Section&nbsp;5.3.3</a>.

      -  If the send media format chosen above has a corresponding "rtx"
         media format or a FEC mechanism has been negotiated, establish
         a redundancy RTP stream with a unique random SSRC for each
         Source RTP Stream, and start or continue transmitting RTX/FEC
         packets as needed.

      -  If the send media format chosen above has a corresponding "red"
         media format of the same clock rate, allow redundant encoding
         using the specified format for resiliency purposes, as
         discussed in <a href="https://datatracker.ietf.org/doc/html/rfc8854#section-3.2">[RFC8854], Section&nbsp;3.2</a>.  Note that unlike RTX or
         FEC media formats, the "red" format is transmitted on the
         Source RTP Stream, not the redundancy RTP stream.

      -  Enable the RTCP feedback mechanisms referenced in the media
         section for all Source RTP Streams using the specified media
         formats.  Specifically, begin or continue sending the requested
         feedback types and reacting to received feedback, as specified
         in <a href="https://datatracker.ietf.org/doc/html/rfc4585#section-4.2">[RFC4585], Section&nbsp;4.2</a>.  When sending RTCP feedback, follow
         the rules and recommendations from <a href="https://datatracker.ietf.org/doc/html/rfc8108#section-5.4.1">[RFC8108], Section&nbsp;5.4.1</a> to
         select which SSRC to use.

      -  If the direction attribute in the answer indicates that the
         JSEP implementation should not be sending media ("recvonly" for
         local answers, "sendonly" for remote answers, or "inactive" for
         either type of answer), stop transmitting all RTP media, but
         continue sending RTCP, as described in <a href="https://datatracker.ietf.org/doc/html/rfc3264#section-5.1">[RFC3264], Section&nbsp;5.1</a>.

   *  If the "m=" section &lt;proto&gt; value indicates use of SCTP:

      -  If an SCTP association exists and the remote SCTP port has
         changed, discard the existing SCTP association.  This includes
         the case when the PeerConnection state is "have-remote-
         pranswer".

      -  If no valid SCTP association exists, prepare to initiate an
         SCTP association over the associated ICE component and DTLS
         connection, using the local SCTP port value from the local
         description and the remote SCTP port value from the remote
         description, as described in <a href="https://datatracker.ietf.org/doc/html/rfc8841#section-10.2">[RFC8841], Section&nbsp;10.2</a>.

   If the answer contains valid bundle groups, discard any ICE
   components for the "m=" sections that will be bundled onto the
   primary ICE components in each bundle, and begin muxing these "m="
   sections accordingly, as described in <a href="https://datatracker.ietf.org/doc/html/rfc8843#section-7.4">[RFC8843], Section&nbsp;7.4</a>.

   If the description is of type "answer" and there are still remaining
   candidates in the ICE candidate pool, discard them.

<span class="h2"><a class="selflink" id="section-6" href="https://datatracker.ietf.org/doc/html/rfc8829#section-6">6</a>.  Processing RTP/RTCP</span>

   When bundling, associating incoming RTP/RTCP with the proper "m="
   section is defined in <a href="https://datatracker.ietf.org/doc/html/rfc8843#section-9.2">[RFC8843], Section&nbsp;9.2</a>.  When not bundling, the
   proper "m=" section is clear from the ICE component over which the
   RTP/RTCP is received.

   Once the proper "m=" section or sections are known, RTP/RTCP is
   delivered to the RtpTransceiver(s) associated with the "m="
   section(s) and further processing of the RTP/RTCP is done at the
   RtpTransceiver level.  This includes using the RID mechanism
   [<a href="https://datatracker.ietf.org/doc/html/rfc8851" title="&quot;RTP Payload Format Restrictions&quot;">RFC8851</a>] and its associated RtpStreamId and RepairedRtpStreamId
   identifiers to distinguish between multiple encoded streams and
   determine which Source RTP stream should be repaired by a given
   redundancy RTP stream.

<span class="h2"><a class="selflink" id="section-7" href="https://datatracker.ietf.org/doc/html/rfc8829#section-7">7</a>.  Examples</span>

   Note that this example section shows several SDP fragments.  To
   accommodate RFC line-length restrictions, some of the SDP lines have
   been split into multiple lines, where leading whitespace indicates
   that a line is a continuation of the previous line.  In addition,
   some blank lines have been added to improve readability but are not
   valid in SDP.

   More examples of SDP for WebRTC call flows, including examples with
   IPv6 addresses, can be found in [<a href="https://datatracker.ietf.org/doc/html/rfc8829#ref-SDP4WebRTC">SDP4WebRTC</a>].

<span class="h3"><a class="selflink" id="section-7.1" href="https://datatracker.ietf.org/doc/html/rfc8829#section-7.1">7.1</a>.  Simple Example</span>

   This section shows a very simple example that sets up a minimal
   audio/video call between two JSEP endpoints without using Trickle
   ICE.  The example in the following section provides a more detailed
   example of what could happen in a JSEP session.

   The code flow below shows Alice's endpoint initiating the session to
   Bob's endpoint.  The messages from the JavaScript application in
   Alice's browser to the JavaScript in Bob's browser, abbreviated as
   "AliceJS" and "BobJS", respectively, are assumed to flow over some
   signaling protocol via a web server.  The JavaScript on both Alice's
   side and Bob's side waits for all candidates before sending the offer
   or answer, so the offers and answers are complete; Trickle ICE is not
   used.  The user agents (JSEP implementations) in Alice's and Bob's
   browsers, abbreviated as "AliceUA" and "BobUA", respectively, are
   both using the default bundle policy of "balanced" and the default
   RTCP mux policy of "require".

   //                  set up local media state
   AliceJS-&gt;AliceUA:   create new PeerConnection
   AliceJS-&gt;AliceUA:   addTrack with two tracks: audio and video
   AliceJS-&gt;AliceUA:   createOffer to get offer
   AliceJS-&gt;AliceUA:   setLocalDescription with offer
   AliceUA-&gt;AliceJS:   multiple onicecandidate events with candidates

   //                  wait for ICE gathering to complete
   AliceUA-&gt;AliceJS:   onicecandidate event with null candidate
   AliceJS-&gt;AliceUA:   get |offer-A1| from pendingLocalDescription

   //                  |offer-A1| is sent over signaling protocol to Bob
   AliceJS-&gt;WebServer: signaling with |offer-A1|
   WebServer-&gt;BobJS:   signaling with |offer-A1|

   //                  |offer-A1| arrives at Bob
   BobJS-&gt;BobUA:       create a PeerConnection
   BobJS-&gt;BobUA:       setRemoteDescription with |offer-A1|
   BobUA-&gt;BobJS:       ontrack events for audio and video tracks

   //                  Bob accepts call
   BobJS-&gt;BobUA:       addTrack with local tracks
   BobJS-&gt;BobUA:       createAnswer
   BobJS-&gt;BobUA:       setLocalDescription with answer
   BobUA-&gt;BobJS:       multiple onicecandidate events with candidates

   //                  wait for ICE gathering to complete
   BobUA-&gt;BobJS:       onicecandidate event with null candidate
   BobJS-&gt;BobUA:       get |answer-A1| from currentLocalDescription

   //                  |answer-A1| is sent over signaling protocol
   //                  to Alice
   BobJS-&gt;WebServer:   signaling with |answer-A1|
   WebServer-&gt;AliceJS: signaling with |answer-A1|

   //                  |answer-A1| arrives at Alice
   AliceJS-&gt;AliceUA:   setRemoteDescription with |answer-A1|
   AliceUA-&gt;AliceJS:   ontrack events for audio and video tracks

   //                  media flows
   BobUA-&gt;AliceUA:     media sent from Bob to Alice
   AliceUA-&gt;BobUA:     media sent from Alice to Bob

   The SDP for |offer-A1| looks like:

   v=0
   o=- 4962303333179871722 1 IN IP4 0.0.0.0
   s=-
   t=0 0
   a=ice-options:trickle ice2
   a=group:BUNDLE a1 v1
   a=group:LS a1 v1

   m=audio 10100 UDP/TLS/RTP/SAVPF 96 0 8 97 98
   c=IN IP4 203.0.113.100
   a=mid:a1
   a=sendrecv
   a=rtpmap:96 opus/48000/2
   a=rtpmap:0 PCMU/8000
   a=rtpmap:8 PCMA/8000
   a=rtpmap:97 telephone-event/8000
   a=rtpmap:98 telephone-event/48000
   a=fmtp:97 0-15
   a=fmtp:98 0-15
   a=maxptime:120
   a=extmap:1 urn:ietf:params:rtp-hdrext:sdes:mid
   a=extmap:2 urn:ietf:params:rtp-hdrext:ssrc-audio-level
   a=msid:47017fee-b6c1-4162-929c-a25110252400
   a=ice-ufrag:ETE
   a=ice-pwd:OtSK0WpNtpUjkY4+86js7ZQl
   a=fingerprint:sha-256
                 19:E2:1C:3B:4B:9F:81:E6:B8:5C:F4:A5:A8:D8:73:04:
                 BB:05:2F:70:9F:04:A9:0E:05:E9:26:33:E8:70:88:A2
   a=setup:actpass
   a=tls-id:91bbf309c0990a6bec11e38ba2933cee
   a=rtcp:10101 IN IP4 203.0.113.100
   a=rtcp-mux
   a=rtcp-rsize
   a=candidate:1 1 udp 2113929471 203.0.113.100 10100 typ host
   a=candidate:1 2 udp 2113929470 203.0.113.100 10101 typ host
   a=end-of-candidates

   m=video 10102 UDP/TLS/RTP/SAVPF 100 101 102 103
   c=IN IP4 203.0.113.100
   a=mid:v1
   a=sendrecv
   a=rtpmap:100 VP8/90000
   a=rtpmap:101 H264/90000
   a=fmtp:101 packetization-mode=1;profile-level-id=42e01f
   a=rtpmap:102 rtx/90000
   a=fmtp:102 apt=100
   a=rtpmap:103 rtx/90000
   a=fmtp:103 apt=101
   a=extmap:1 urn:ietf:params:rtp-hdrext:sdes:mid
   a=extmap:3 urn:ietf:params:rtp-hdrext:sdes:rtp-stream-id
   a=rtcp-fb:100 ccm fir
   a=rtcp-fb:100 nack
   a=rtcp-fb:100 nack pli
   a=msid:47017fee-b6c1-4162-929c-a25110252400
   a=ice-ufrag:BGKk
   a=ice-pwd:mqyWsAjvtKwTGnvhPztQ9mIf
   a=fingerprint:sha-256
                 19:E2:1C:3B:4B:9F:81:E6:B8:5C:F4:A5:A8:D8:73:04:
                 BB:05:2F:70:9F:04:A9:0E:05:E9:26:33:E8:70:88:A2
   a=setup:actpass
   a=tls-id:91bbf309c0990a6bec11e38ba2933cee
   a=rtcp:10103 IN IP4 203.0.113.100
   a=rtcp-mux
   a=rtcp-rsize
   a=candidate:1 1 udp 2113929471 203.0.113.100 10102 typ host
   a=candidate:1 2 udp 2113929470 203.0.113.100 10103 typ host
   a=end-of-candidates

   The SDP for |answer-A1| looks like:

   v=0
   o=- 6729291447651054566 1 IN IP4 0.0.0.0
   s=-
   t=0 0
   a=ice-options:trickle ice2
   a=group:BUNDLE a1 v1
   a=group:LS a1 v1

   m=audio 10200 UDP/TLS/RTP/SAVPF 96 0 8 97 98
   c=IN IP4 203.0.113.200
   a=mid:a1
   a=sendrecv
   a=rtpmap:96 opus/48000/2
   a=rtpmap:0 PCMU/8000
   a=rtpmap:8 PCMA/8000
   a=rtpmap:97 telephone-event/8000
   a=rtpmap:98 telephone-event/48000
   a=fmtp:97 0-15
   a=fmtp:98 0-15
   a=maxptime:120
   a=extmap:1 urn:ietf:params:rtp-hdrext:sdes:mid
   a=extmap:2 urn:ietf:params:rtp-hdrext:ssrc-audio-level
   a=msid:61317484-2ed4-49d7-9eb7-1414322a7aae
   a=ice-ufrag:6sFv
   a=ice-pwd:cOTZKZNVlO9RSGsEGM63JXT2
   a=fingerprint:sha-256
                 6B:8B:F0:65:5F:78:E2:51:3B:AC:6F:F3:3F:46:1B:35:
                 DC:B8:5F:64:1A:24:C2:43:F0:A1:58:D0:A1:2C:19:08
   a=setup:active
   a=tls-id:eec3392ab83e11ceb6a0990c903fbb19
   a=rtcp-mux
   a=rtcp-rsize
   a=candidate:1 1 udp 2113929471 203.0.113.200 10200 typ host
   a=end-of-candidates

   m=video 10200 UDP/TLS/RTP/SAVPF 100 101 102 103
   c=IN IP4 203.0.113.200
   a=mid:v1
   a=sendrecv
   a=rtpmap:100 VP8/90000
   a=rtpmap:101 H264/90000
   a=fmtp:101 packetization-mode=1;profile-level-id=42e01f
   a=rtpmap:102 rtx/90000
   a=fmtp:102 apt=100
   a=rtpmap:103 rtx/90000
   a=fmtp:103 apt=101
   a=extmap:1 urn:ietf:params:rtp-hdrext:sdes:mid
   a=extmap:3 urn:ietf:params:rtp-hdrext:sdes:rtp-stream-id
   a=rtcp-fb:100 ccm fir
   a=rtcp-fb:100 nack
   a=rtcp-fb:100 nack pli
   a=msid:61317484-2ed4-49d7-9eb7-1414322a7aae

<span class="h3"><a class="selflink" id="section-7.2" href="https://datatracker.ietf.org/doc/html/rfc8829#section-7.2">7.2</a>.  Detailed Example</span>

   This section shows a more involved example of a session between two
   JSEP endpoints.  Trickle ICE is used in full trickle mode, with a
   bundle policy of "max-bundle", an RTCP mux policy of "require", and a
   single TURN server.  Initially, both Alice and Bob establish an audio
   channel and a data channel.  Later, Bob adds two video flows -- one
   for his video feed and one for screen sharing, both supporting FEC --
   with the video feed configured for simulcast.  Alice accepts these
   video flows but does not add video flows of her own, so they are
   handled as recvonly.  Alice also specifies a maximum video decoder
   resolution.

   //                  set up local media state
   AliceJS-&gt;AliceUA:   create new PeerConnection
   AliceJS-&gt;AliceUA:   addTrack with an audio track
   AliceJS-&gt;AliceUA:   createDataChannel to get data channel
   AliceJS-&gt;AliceUA:   createOffer to get |offer-B1|
   AliceJS-&gt;AliceUA:   setLocalDescription with |offer-B1|

   //                  |offer-B1| is sent over signaling protocol to Bob
   AliceJS-&gt;WebServer: signaling with |offer-B1|
   WebServer-&gt;BobJS:   signaling with |offer-B1|

   //                  |offer-B1| arrives at Bob
   BobJS-&gt;BobUA:       create a PeerConnection
   BobJS-&gt;BobUA:       setRemoteDescription with |offer-B1|
   BobUA-&gt;BobJS:       ontrack event with audio track from Alice

   //                  candidates are sent to Bob
   AliceUA-&gt;AliceJS:   onicecandidate (host) |offer-B1-candidate-1|
   AliceJS-&gt;WebServer: signaling with |offer-B1-candidate-1|
   AliceUA-&gt;AliceJS:   onicecandidate (srflx) |offer-B1-candidate-2|
   AliceJS-&gt;WebServer: signaling with |offer-B1-candidate-2|
   AliceUA-&gt;AliceJS:   onicecandidate (relay) |offer-B1-candidate-3|
   AliceJS-&gt;WebServer: signaling with |offer-B1-candidate-3|

   WebServer-&gt;BobJS:   signaling with |offer-B1-candidate-1|
   BobJS-&gt;BobUA:       addIceCandidate with |offer-B1-candidate-1|
   WebServer-&gt;BobJS:   signaling with |offer-B1-candidate-2|
   BobJS-&gt;BobUA:       addIceCandidate with |offer-B1-candidate-2|
   WebServer-&gt;BobJS:   signaling with |offer-B1-candidate-3|
   BobJS-&gt;BobUA:       addIceCandidate with |offer-B1-candidate-3|

   //                  Bob accepts call
   BobJS-&gt;BobUA:       addTrack with local audio
   BobJS-&gt;BobUA:       createDataChannel to get data channel
   BobJS-&gt;BobUA:       createAnswer to get |answer-B1|
   BobJS-&gt;BobUA:       setLocalDescription with |answer-B1|

   //                  |answer-B1| is sent to Alice
   BobJS-&gt;WebServer:   signaling with |answer-B1|
   WebServer-&gt;AliceJS: signaling with |answer-B1|
   AliceJS-&gt;AliceUA:   setRemoteDescription with |answer-B1|
   AliceUA-&gt;AliceJS:   ontrack event with audio track from Bob

   //                  candidates are sent to Alice
   BobUA-&gt;BobJS:       onicecandidate (host) |answer-B1-candidate-1|
   BobJS-&gt;WebServer:   signaling with |answer-B1-candidate-1|
   BobUA-&gt;BobJS:       onicecandidate (srflx) |answer-B1-candidate-2|
   BobJS-&gt;WebServer:   signaling with |answer-B1-candidate-2|
   BobUA-&gt;BobJS:       onicecandidate (relay) |answer-B1-candidate-3|
   BobJS-&gt;WebServer:   signaling with |answer-B1-candidate-3|

   WebServer-&gt;AliceJS: signaling with |answer-B1-candidate-1|
   AliceJS-&gt;AliceUA:   addIceCandidate with |answer-B1-candidate-1|
   WebServer-&gt;AliceJS: signaling with |answer-B1-candidate-2|
   AliceJS-&gt;AliceUA:   addIceCandidate with |answer-B1-candidate-2|
   WebServer-&gt;AliceJS: signaling with |answer-B1-candidate-3|
   AliceJS-&gt;AliceUA:   addIceCandidate with |answer-B1-candidate-3|

   //                  data channel opens
   BobUA-&gt;BobJS:       ondatachannel event
   AliceUA-&gt;AliceJS:   ondatachannel event
   BobUA-&gt;BobJS:       onopen
   AliceUA-&gt;AliceJS:   onopen

   //                  media is flowing between endpoints
   BobUA-&gt;AliceUA:     audio+data sent from Bob to Alice
   AliceUA-&gt;BobUA:     audio+data sent from Alice to Bob

   //                  some time later, Bob adds two video streams
   //                  note: no candidates exchanged, because of bundle
   BobJS-&gt;BobUA:       addTrack with first video stream
   BobJS-&gt;BobUA:       addTrack with second video stream
   BobJS-&gt;BobUA:       createOffer to get |offer-B2|
   BobJS-&gt;BobUA:       setLocalDescription with |offer-B2|

   //                  |offer-B2| is sent to Alice
   BobJS-&gt;WebServer:   signaling with |offer-B2|
   WebServer-&gt;AliceJS: signaling with |offer-B2|
   AliceJS-&gt;AliceUA:   setRemoteDescription with |offer-B2|
   AliceUA-&gt;AliceJS:   ontrack event with first video track
   AliceUA-&gt;AliceJS:   ontrack event with second video track
   AliceJS-&gt;AliceUA:   createAnswer to get |answer-B2|
   AliceJS-&gt;AliceUA:   setLocalDescription with |answer-B2|

   //                  |answer-B2| is sent over signaling protocol
   //                  to Bob
   AliceJS-&gt;WebServer: signaling with |answer-B2|
   WebServer-&gt;BobJS:   signaling with |answer-B2|
   BobJS-&gt;BobUA:       setRemoteDescription with |answer-B2|

   //                  media is flowing between endpoints
   BobUA-&gt;AliceUA:     audio+video+data sent from Bob to Alice
   AliceUA-&gt;BobUA:     audio+video+data sent from Alice to Bob

   The SDP for |offer-B1| looks like:

   v=0
   o=- 4962303333179871723 1 IN IP4 0.0.0.0
   s=-
   t=0 0
   a=ice-options:trickle ice2
   a=group:BUNDLE a1 d1

   m=audio 9 UDP/TLS/RTP/SAVPF 96 0 8 97 98
   c=IN IP4 0.0.0.0
   a=mid:a1
   a=sendrecv
   a=rtpmap:96 opus/48000/2
   a=rtpmap:0 PCMU/8000
   a=rtpmap:8 PCMA/8000
   a=rtpmap:97 telephone-event/8000
   a=rtpmap:98 telephone-event/48000
   a=fmtp:97 0-15
   a=fmtp:98 0-15
   a=maxptime:120
   a=extmap:1 urn:ietf:params:rtp-hdrext:sdes:mid
   a=extmap:2 urn:ietf:params:rtp-hdrext:ssrc-audio-level
   a=msid:57017fee-b6c1-4162-929c-a25110252400
   a=ice-ufrag:ATEn
   a=ice-pwd:AtSK0WpNtpUjkY4+86js7ZQl
   a=fingerprint:sha-256
                 29:E2:1C:3B:4B:9F:81:E6:B8:5C:F4:A5:A8:D8:73:04:
                 BB:05:2F:70:9F:04:A9:0E:05:E9:26:33:E8:70:88:A2
   a=setup:actpass
   a=tls-id:17f0f4ba8a5f1213faca591b58ba52a7
   a=rtcp-mux
   a=rtcp-mux-only
   a=rtcp-rsize

   m=application 0 UDP/DTLS/SCTP webrtc-datachannel
   c=IN IP4 0.0.0.0
   a=mid:d1
   a=sctp-port:5000
   a=max-message-size:65536
   a=bundle-only

   |offer-B1-candidate-1| looks like:

   ufrag ATEn
   index 0
   mid   a1
   attr  candidate:1 1 udp 2113929471 203.0.113.100 10100 typ host

   |offer-B1-candidate-2| looks like:

   ufrag ATEn
   index 0
   mid   a1
   attr  candidate:1 1 udp 1845494015 198.51.100.100 11100 typ srflx
                   raddr 203.0.113.100 rport 10100

   |offer-B1-candidate-3| looks like:

   ufrag ATEn
   index 0
   mid   a1
   attr  candidate:1 1 udp 255 192.0.2.100 12100 typ relay
                   raddr 198.51.100.100 rport 11100

   The SDP for |answer-B1| looks like:

   v=0
   o=- 7729291447651054566 1 IN IP4 0.0.0.0
   s=-
   t=0 0
   a=ice-options:trickle ice2
   a=group:BUNDLE a1 d1

   m=audio 9 UDP/TLS/RTP/SAVPF 96 0 8 97 98
   c=IN IP4 0.0.0.0
   a=mid:a1
   a=sendrecv
   a=rtpmap:96 opus/48000/2
   a=rtpmap:0 PCMU/8000
   a=rtpmap:8 PCMA/8000
   a=rtpmap:97 telephone-event/8000
   a=rtpmap:98 telephone-event/48000
   a=fmtp:97 0-15
   a=fmtp:98 0-15
   a=maxptime:120
   a=extmap:1 urn:ietf:params:rtp-hdrext:sdes:mid
   a=extmap:2 urn:ietf:params:rtp-hdrext:ssrc-audio-level
   a=msid:71317484-2ed4-49d7-9eb7-1414322a7aae
   a=ice-ufrag:7sFv
   a=ice-pwd:dOTZKZNVlO9RSGsEGM63JXT2
   a=fingerprint:sha-256
                 7B:8B:F0:65:5F:78:E2:51:3B:AC:6F:F3:3F:46:1B:35:
                 DC:B8:5F:64:1A:24:C2:43:F0:A1:58:D0:A1:2C:19:08
   a=setup:active
   a=tls-id:7a25ab85b195acaf3121f5a8ab4f0f71
   a=rtcp-mux
   a=rtcp-mux-only
   a=rtcp-rsize

   m=application 9 UDP/DTLS/SCTP webrtc-datachannel
   c=IN IP4 0.0.0.0
   a=mid:d1
   a=sctp-port:5000
   a=max-message-size:65536

   |answer-B1-candidate-1| looks like:

   ufrag 7sFv
   index 0
   mid   a1
   attr  candidate:1 1 udp 2113929471 203.0.113.200 10200 typ host

   |answer-B1-candidate-2| looks like:

   ufrag 7sFv
   index 0
   mid   a1
   attr  candidate:1 1 udp 1845494015 198.51.100.200 11200 typ srflx
                   raddr 203.0.113.200 rport 10200

   |answer-B1-candidate-3| looks like:

   ufrag 7sFv
   index 0
   mid   a1
   attr  candidate:1 1 udp 255 192.0.2.200 12200 typ relay
                   raddr 198.51.100.200 rport 11200

   The SDP for |offer-B2| is shown below.  In addition to the new "m="
   sections for video, both of which are offering FEC and one of which
   is offering simulcast, note the increment of the version number in
   the "o=" line; changes to the "c=" line, indicating the local
   candidate that was selected; and the inclusion of gathered candidates
   as a=candidate lines.

   v=0
   o=- 7729291447651054566 2 IN IP4 0.0.0.0
   s=-
   t=0 0
   a=ice-options:trickle ice2
   a=group:BUNDLE a1 d1 v1 v2
   a=group:LS a1 v1

   m=audio 12200 UDP/TLS/RTP/SAVPF 96 0 8 97 98
   c=IN IP4 192.0.2.200
   a=mid:a1
   a=sendrecv
   a=rtpmap:96 opus/48000/2
   a=rtpmap:0 PCMU/8000
   a=rtpmap:8 PCMA/8000
   a=rtpmap:97 telephone-event/8000
   a=rtpmap:98 telephone-event/48000
   a=fmtp:97 0-15
   a=fmtp:98 0-15
   a=maxptime:120
   a=extmap:1 urn:ietf:params:rtp-hdrext:sdes:mid
   a=extmap:2 urn:ietf:params:rtp-hdrext:ssrc-audio-level
   a=msid:71317484-2ed4-49d7-9eb7-1414322a7aae
   a=ice-ufrag:7sFv
   a=ice-pwd:dOTZKZNVlO9RSGsEGM63JXT2
   a=fingerprint:sha-256
                 7B:8B:F0:65:5F:78:E2:51:3B:AC:6F:F3:3F:46:1B:35:
                 DC:B8:5F:64:1A:24:C2:43:F0:A1:58:D0:A1:2C:19:08
   a=setup:actpass
   a=tls-id:7a25ab85b195acaf3121f5a8ab4f0f71
   a=rtcp-mux
   a=rtcp-mux-only
   a=rtcp-rsize
   a=candidate:1 1 udp 2113929471 203.0.113.200 10200 typ host
   a=candidate:1 1 udp 1845494015 198.51.100.200 11200 typ srflx
               raddr 203.0.113.200 rport 10200
   a=candidate:1 1 udp 255 192.0.2.200 12200 typ relay
               raddr 198.51.100.200 rport 11200
   a=end-of-candidates

   m=application 12200 UDP/DTLS/SCTP webrtc-datachannel
   c=IN IP4 192.0.2.200
   a=mid:d1
   a=sctp-port:5000
   a=max-message-size:65536

   m=video 12200 UDP/TLS/RTP/SAVPF 100 101 102 103 104
   c=IN IP4 192.0.2.200
   a=mid:v1
   a=sendrecv
   a=rtpmap:100 VP8/90000
   a=rtpmap:101 H264/90000
   a=fmtp:101 packetization-mode=1;profile-level-id=42e01f
   a=rtpmap:102 rtx/90000
   a=fmtp:102 apt=100
   a=rtpmap:103 rtx/90000
   a=fmtp:103 apt=101
   a=rtpmap:104 flexfec/90000
   a=extmap:1 urn:ietf:params:rtp-hdrext:sdes:mid
   a=extmap:3 urn:ietf:params:rtp-hdrext:sdes:rtp-stream-id
   a=rtcp-fb:100 ccm fir
   a=rtcp-fb:100 nack
   a=rtcp-fb:100 nack pli
   a=msid:71317484-2ed4-49d7-9eb7-1414322a7aae
   a=rid:1 send
   a=rid:2 send
   a=rid:3 send
   a=simulcast:send 1;2;3

   m=video 12200 UDP/TLS/RTP/SAVPF 100 101 102 103 104
   c=IN IP4 192.0.2.200
   a=mid:v2
   a=sendrecv
   a=rtpmap:100 VP8/90000
   a=rtpmap:101 H264/90000
   a=fmtp:101 packetization-mode=1;profile-level-id=42e01f
   a=rtpmap:102 rtx/90000
   a=fmtp:102 apt=100
   a=rtpmap:103 rtx/90000
   a=fmtp:103 apt=101
   a=rtpmap:104 flexfec/90000
   a=extmap:1 urn:ietf:params:rtp-hdrext:sdes:mid
   a=extmap:3 urn:ietf:params:rtp-hdrext:sdes:rtp-stream-id
   a=rtcp-fb:100 ccm fir
   a=rtcp-fb:100 nack
   a=rtcp-fb:100 nack pli
   a=msid:81317484-2ed4-49d7-9eb7-1414322a7aae

   The SDP for |answer-B2| is shown below.  In addition to the
   acceptance of the video "m=" sections, the use of a=recvonly to
   indicate one-way video, and the use of a=imageattr to limit the
   received resolution, note the use of setup:passive to maintain the
   existing DTLS roles.

   v=0
   o=- 4962303333179871723 2 IN IP4 0.0.0.0
   s=-
   t=0 0
   a=ice-options:trickle ice2
   a=group:BUNDLE a1 d1 v1 v2
   a=group:LS a1 v1

   m=audio 12100 UDP/TLS/RTP/SAVPF 96 0 8 97 98
   c=IN IP4 192.0.2.100
   a=mid:a1
   a=sendrecv
   a=rtpmap:96 opus/48000/2
   a=rtpmap:0 PCMU/8000
   a=rtpmap:8 PCMA/8000
   a=rtpmap:97 telephone-event/8000
   a=rtpmap:98 telephone-event/48000
   a=fmtp:97 0-15
   a=fmtp:98 0-15
   a=maxptime:120
   a=extmap:1 urn:ietf:params:rtp-hdrext:sdes:mid
   a=extmap:2 urn:ietf:params:rtp-hdrext:ssrc-audio-level
   a=msid:57017fee-b6c1-4162-929c-a25110252400
   a=ice-ufrag:ATEn
   a=ice-pwd:AtSK0WpNtpUjkY4+86js7ZQl
   a=fingerprint:sha-256
                 29:E2:1C:3B:4B:9F:81:E6:B8:5C:F4:A5:A8:D8:73:04:
                 BB:05:2F:70:9F:04:A9:0E:05:E9:26:33:E8:70:88:A2
   a=setup:passive
   a=tls-id:17f0f4ba8a5f1213faca591b58ba52a7
   a=rtcp-mux
   a=rtcp-mux-only
   a=rtcp-rsize
   a=candidate:1 1 udp 2113929471 203.0.113.100 10100 typ host
   a=candidate:1 1 udp 1845494015 198.51.100.100 11100 typ srflx
               raddr 203.0.113.100 rport 10100
   a=candidate:1 1 udp 255 192.0.2.100 12100 typ relay
               raddr 198.51.100.100 rport 11100
   a=end-of-candidates

   m=application 12100 UDP/DTLS/SCTP webrtc-datachannel
   c=IN IP4 192.0.2.100
   a=mid:d1
   a=sctp-port:5000
   a=max-message-size:65536

   m=video 12100 UDP/TLS/RTP/SAVPF 100 101 102 103
   c=IN IP4 192.0.2.100
   a=mid:v1
   a=recvonly
   a=rtpmap:100 VP8/90000
   a=rtpmap:101 H264/90000
   a=fmtp:101 packetization-mode=1;profile-level-id=42e01f
   a=rtpmap:102 rtx/90000
   a=fmtp:102 apt=100
   a=rtpmap:103 rtx/90000
   a=fmtp:103 apt=101
   a=imageattr:100 recv [x=[48:1920],y=[48:1080],q=1.0]
   a=extmap:1 urn:ietf:params:rtp-hdrext:sdes:mid
   a=extmap:3 urn:ietf:params:rtp-hdrext:sdes:rtp-stream-id
   a=rtcp-fb:100 ccm fir
   a=rtcp-fb:100 nack
   a=rtcp-fb:100 nack pli

   m=video 12100 UDP/TLS/RTP/SAVPF 100 101 102 103
   c=IN IP4 192.0.2.100
   a=mid:v2
   a=recvonly
   a=rtpmap:100 VP8/90000
   a=rtpmap:101 H264/90000
   a=fmtp:101 packetization-mode=1;profile-level-id=42e01f
   a=rtpmap:102 rtx/90000
   a=fmtp:102 apt=100
   a=rtpmap:103 rtx/90000
   a=fmtp:103 apt=101
   a=imageattr:100 recv [x=[48:1920],y=[48:1080],q=1.0]
   a=extmap:1 urn:ietf:params:rtp-hdrext:sdes:mid
   a=extmap:3 urn:ietf:params:rtp-hdrext:sdes:rtp-stream-id
   a=rtcp-fb:100 ccm fir
   a=rtcp-fb:100 nack
   a=rtcp-fb:100 nack pli

<span class="h3"><a class="selflink" id="section-7.3" href="https://datatracker.ietf.org/doc/html/rfc8829#section-7.3">7.3</a>.  Early Transport Warmup Example</span>

   This example demonstrates the early-warmup technique described in
   <a href="https://datatracker.ietf.org/doc/html/rfc8829#section-4.1.10.1">Section 4.1.10.1</a>.  Here, Alice's endpoint sends an offer to Bob's
   endpoint to start an audio/video call.  Bob immediately responds with
   an answer that accepts the audio/video "m=" sections but marks them
   as sendonly (from his perspective), meaning that Alice will not yet
   send media.  This allows the JSEP implementation to start negotiating
   ICE and DTLS immediately.  Bob's endpoint then prompts him to answer
   the call, and when he does, his endpoint sends a second offer, which
   enables the audio and video "m=" sections, and thereby bidirectional
   media transmission.  The advantage of such a flow is that as soon as
   the first answer is received, the implementation can proceed with ICE
   and DTLS negotiation and establish the session transport.  If the
   transport setup completes before the second offer is sent, then media
   can be transmitted by the callee immediately upon answering the call,
   minimizing perceived post-dial delay.  The second offer/answer
   exchange can also change the preferred codecs or other session
   parameters.

   This example also makes use of the "relay" ICE candidate policy
   described in <a href="https://datatracker.ietf.org/doc/html/rfc8829#section-3.5.3">Section 3.5.3</a> to minimize the ICE gathering and checking
   needed.

   //                  set up local media state
   AliceJS-&gt;AliceUA:   create new PeerConnection with "relay" ICE policy
   AliceJS-&gt;AliceUA:   addTrack with two tracks: audio and video
   AliceJS-&gt;AliceUA:   createOffer to get |offer-C1|
   AliceJS-&gt;AliceUA:   setLocalDescription with |offer-C1|

   //                  |offer-C1| is sent over signaling protocol to Bob
   AliceJS-&gt;WebServer: signaling with |offer-C1|
   WebServer-&gt;BobJS:   signaling with |offer-C1|

   //                  |offer-C1| arrives at Bob
   BobJS-&gt;BobUA:       create new PeerConnection with "relay" ICE policy
   BobJS-&gt;BobUA:       setRemoteDescription with |offer-C1|
   BobUA-&gt;BobJS:       ontrack events for audio and video

   //                  a relay candidate is sent to Bob
   AliceUA-&gt;AliceJS:   onicecandidate (relay) |offer-C1-candidate-1|
   AliceJS-&gt;WebServer: signaling with |offer-C1-candidate-1|

   WebServer-&gt;BobJS:   signaling with |offer-C1-candidate-1|
   BobJS-&gt;BobUA:       addIceCandidate with |offer-C1-candidate-1|

   //                  Bob prepares an early answer to warm up the
   //                  transport
   BobJS-&gt;BobUA:       addTransceiver with null audio and video tracks
   BobJS-&gt;BobUA:       transceiver.setDirection(sendonly) for both
   BobJS-&gt;BobUA:       createAnswer
   BobJS-&gt;BobUA:       setLocalDescription with answer

   //                  |answer-C1| is sent over signaling protocol
   //                  to Alice
   BobJS-&gt;WebServer:   signaling with |answer-C1|
   WebServer-&gt;AliceJS: signaling with |answer-C1|

   //                  |answer-C1| (sendonly) arrives at Alice
   AliceJS-&gt;AliceUA:   setRemoteDescription with |answer-C1|
   AliceUA-&gt;AliceJS:   ontrack events for audio and video

   //                  a relay candidate is sent to Alice
   BobUA-&gt;BobJS:       onicecandidate (relay) |answer-B1-candidate-1|
   BobJS-&gt;WebServer:   signaling with |answer-B1-candidate-1|

   WebServer-&gt;AliceJS: signaling with |answer-B1-candidate-1|
   AliceJS-&gt;AliceUA:   addIceCandidate with |answer-B1-candidate-1|

   //                  ICE and DTLS establish while call is ringing

   //                  Bob accepts call, starts media, and sends
   //                  new offer
   BobJS-&gt;BobUA:       transceiver.setTrack with audio and video tracks
   BobUA-&gt;AliceUA:     media sent from Bob to Alice
   BobJS-&gt;BobUA:       transceiver.setDirection(sendrecv) for both
                       transceivers
   BobJS-&gt;BobUA:       createOffer
   BobJS-&gt;BobUA:       setLocalDescription with offer

   //                  |offer-C2| is sent over signaling protocol
   //                  to Alice
   BobJS-&gt;WebServer:   signaling with |offer-C2|
   WebServer-&gt;AliceJS: signaling with |offer-C2|

   //                  |offer-C2| (sendrecv) arrives at Alice
   AliceJS-&gt;AliceUA:   setRemoteDescription with |offer-C2|
   AliceJS-&gt;AliceUA:   createAnswer
   AliceJS-&gt;AliceUA:   setLocalDescription with |answer-C2|
   AliceUA-&gt;BobUA:     media sent from Alice to Bob

   //                  |answer-C2| is sent over signaling protocol
   //                  to Bob
   AliceJS-&gt;WebServer: signaling with |answer-C2|
   WebServer-&gt;BobJS:   signaling with |answer-C2|
   BobJS-&gt;BobUA:       setRemoteDescription with |answer-C2|

   The SDP for |offer-C1| looks like:

   v=0
   o=- 1070771854436052752 1 IN IP4 0.0.0.0
   s=-
   t=0 0
   a=ice-options:trickle ice2
   a=group:BUNDLE a1 v1
   a=group:LS a1 v1

   m=audio 9 UDP/TLS/RTP/SAVPF 96 0 8 97 98
   c=IN IP4 0.0.0.0
   a=mid:a1
   a=sendrecv
   a=rtpmap:96 opus/48000/2
   a=rtpmap:0 PCMU/8000
   a=rtpmap:8 PCMA/8000
   a=rtpmap:97 telephone-event/8000
   a=rtpmap:98 telephone-event/48000
   a=fmtp:97 0-15
   a=fmtp:98 0-15
   a=maxptime:120
   a=extmap:1 urn:ietf:params:rtp-hdrext:sdes:mid
   a=extmap:2 urn:ietf:params:rtp-hdrext:ssrc-audio-level
   a=msid:bbce3ba6-abfc-ac63-d00a-e15b286f8fce
   a=ice-ufrag:4ZcD
   a=ice-pwd:ZaaG6OG7tCn4J/lehAGz+HHD
   a=fingerprint:sha-256
                 C4:68:F8:77:6A:44:F1:98:6D:7C:9F:47:EB:E3:34:A4:
                 0A:AA:2D:49:08:28:70:2E:1F:AE:18:7D:4E:3E:66:BF
   a=setup:actpass
   a=tls-id:9e5b948ade9c3d41de6617b68f769e55
   a=rtcp-mux
   a=rtcp-mux-only
   a=rtcp-rsize

   m=video 0 UDP/TLS/RTP/SAVPF 100 101 102 103
   c=IN IP4 0.0.0.0
   a=mid:v1
   a=sendrecv
   a=rtpmap:100 VP8/90000
   a=rtpmap:101 H264/90000
   a=fmtp:101 packetization-mode=1;profile-level-id=42e01f
   a=rtpmap:102 rtx/90000
   a=fmtp:102 apt=100
   a=rtpmap:103 rtx/90000
   a=fmtp:103 apt=101
   a=extmap:1 urn:ietf:params:rtp-hdrext:sdes:mid
   a=extmap:3 urn:ietf:params:rtp-hdrext:sdes:rtp-stream-id
   a=rtcp-fb:100 ccm fir
   a=rtcp-fb:100 nack
   a=rtcp-fb:100 nack pli
   a=msid:bbce3ba6-abfc-ac63-d00a-e15b286f8fce
   a=bundle-only

   |offer-C1-candidate-1| looks like:

   ufrag 4ZcD
   index 0
   mid   a1
   attr  candidate:1 1 udp 255 192.0.2.100 12100 typ relay
                   raddr 0.0.0.0 rport 0

   The SDP for |answer-C1| looks like:

   v=0
   o=- 6386516489780559513 1 IN IP4 0.0.0.0
   s=-
   t=0 0
   a=ice-options:trickle ice2
   a=group:BUNDLE a1 v1
   a=group:LS a1 v1

   m=audio 9 UDP/TLS/RTP/SAVPF 96 0 8 97 98
   c=IN IP4 0.0.0.0
   a=mid:a1
   a=sendonly
   a=rtpmap:96 opus/48000/2
   a=rtpmap:0 PCMU/8000
   a=rtpmap:8 PCMA/8000
   a=rtpmap:97 telephone-event/8000
   a=rtpmap:98 telephone-event/48000
   a=fmtp:97 0-15
   a=fmtp:98 0-15
   a=maxptime:120
   a=extmap:1 urn:ietf:params:rtp-hdrext:sdes:mid
   a=extmap:2 urn:ietf:params:rtp-hdrext:ssrc-audio-level
   a=msid:751f239e-4ae0-c549-aa3d-890de772998b
   a=ice-ufrag:TpaA
   a=ice-pwd:t2Ouhc67y8JcCaYZxUUTgKw/
   a=fingerprint:sha-256
                 A2:F3:A5:6D:4C:8C:1E:B2:62:10:4A:F6:70:61:C4:FC:
                 3C:E0:01:D6:F3:24:80:74:DA:7C:3E:50:18:7B:CE:4D
   a=setup:active
   a=tls-id:55e967f86b7166ed14d3c9eda849b5e9
   a=rtcp-mux
   a=rtcp-mux-only
   a=rtcp-rsize

   m=video 9 UDP/TLS/RTP/SAVPF 100 101 102 103
   c=IN IP4 0.0.0.0
   a=mid:v1
   a=sendonly
   a=rtpmap:100 VP8/90000
   a=rtpmap:101 H264/90000
   a=fmtp:101 packetization-mode=1;profile-level-id=42e01f
   a=rtpmap:102 rtx/90000
   a=fmtp:102 apt=100
   a=rtpmap:103 rtx/90000
   a=fmtp:103 apt=101
   a=extmap:1 urn:ietf:params:rtp-hdrext:sdes:mid
   a=extmap:3 urn:ietf:params:rtp-hdrext:sdes:rtp-stream-id
   a=rtcp-fb:100 ccm fir
   a=rtcp-fb:100 nack
   a=rtcp-fb:100 nack pli
   a=msid:751f239e-4ae0-c549-aa3d-890de772998b

   |answer-C1-candidate-1| looks like:

   ufrag TpaA
   index 0
   mid   a1
   attr  candidate:1 1 udp 255 192.0.2.200 12200 typ relay
                   raddr 0.0.0.0 rport 0

   The SDP for |offer-C2| looks like:

   v=0
   o=- 6386516489780559513 2 IN IP4 0.0.0.0
   s=-
   t=0 0
   a=ice-options:trickle ice2
   a=group:BUNDLE a1 v1
   a=group:LS a1 v1

   m=audio 12200 UDP/TLS/RTP/SAVPF 96 0 8 97 98
   c=IN IP4 192.0.2.200
   a=mid:a1
   a=sendrecv
   a=rtpmap:96 opus/48000/2
   a=rtpmap:0 PCMU/8000
   a=rtpmap:8 PCMA/8000
   a=rtpmap:97 telephone-event/8000
   a=rtpmap:98 telephone-event/48000
   a=fmtp:97 0-15
   a=fmtp:98 0-15
   a=maxptime:120
   a=extmap:1 urn:ietf:params:rtp-hdrext:sdes:mid
   a=extmap:2 urn:ietf:params:rtp-hdrext:ssrc-audio-level
   a=msid:751f239e-4ae0-c549-aa3d-890de772998b
   a=ice-ufrag:TpaA
   a=ice-pwd:t2Ouhc67y8JcCaYZxUUTgKw/
   a=fingerprint:sha-256
                 A2:F3:A5:6D:4C:8C:1E:B2:62:10:4A:F6:70:61:C4:FC:
                 3C:E0:01:D6:F3:24:80:74:DA:7C:3E:50:18:7B:CE:4D
   a=setup:actpass
   a=tls-id:55e967f86b7166ed14d3c9eda849b5e9
   a=rtcp-mux
   a=rtcp-mux-only
   a=rtcp-rsize
   a=candidate:1 1 udp 255 192.0.2.200 12200 typ relay
               raddr 0.0.0.0 rport 0
   a=end-of-candidates

   m=video 12200 UDP/TLS/RTP/SAVPF 100 101 102 103
   c=IN IP4 192.0.2.200
   a=mid:v1
   a=sendrecv
   a=rtpmap:100 VP8/90000
   a=rtpmap:101 H264/90000
   a=fmtp:101 packetization-mode=1;profile-level-id=42e01f
   a=rtpmap:102 rtx/90000
   a=fmtp:102 apt=100
   a=rtpmap:103 rtx/90000
   a=fmtp:103 apt=101
   a=extmap:1 urn:ietf:params:rtp-hdrext:sdes:mid
   a=extmap:3 urn:ietf:params:rtp-hdrext:sdes:rtp-stream-id
   a=rtcp-fb:100 ccm fir
   a=rtcp-fb:100 nack
   a=rtcp-fb:100 nack pli
   a=msid:751f239e-4ae0-c549-aa3d-890de772998b

   The SDP for |answer-C2| looks like:

   v=0
   o=- 1070771854436052752 2 IN IP4 0.0.0.0
   s=-
   t=0 0
   a=ice-options:trickle ice2
   a=group:BUNDLE a1 v1
   a=group:LS a1 v1

   m=audio 12100 UDP/TLS/RTP/SAVPF 96 0 8 97 98
   c=IN IP4 192.0.2.100
   a=mid:a1
   a=sendrecv
   a=rtpmap:96 opus/48000/2
   a=rtpmap:0 PCMU/8000
   a=rtpmap:8 PCMA/8000
   a=rtpmap:97 telephone-event/8000
   a=rtpmap:98 telephone-event/48000
   a=fmtp:97 0-15
   a=fmtp:98 0-15
   a=maxptime:120
   a=extmap:1 urn:ietf:params:rtp-hdrext:sdes:mid
   a=extmap:2 urn:ietf:params:rtp-hdrext:ssrc-audio-level
   a=msid:bbce3ba6-abfc-ac63-d00a-e15b286f8fce
   a=ice-ufrag:4ZcD
   a=ice-pwd:ZaaG6OG7tCn4J/lehAGz+HHD
   a=fingerprint:sha-256
                 C4:68:F8:77:6A:44:F1:98:6D:7C:9F:47:EB:E3:34:A4:
                 0A:AA:2D:49:08:28:70:2E:1F:AE:18:7D:4E:3E:66:BF
   a=setup:passive
   a=tls-id:9e5b948ade9c3d41de6617b68f769e55
   a=rtcp-mux
   a=rtcp-mux-only
   a=rtcp-rsize
   a=candidate:1 1 udp 255 192.0.2.100 12100 typ relay
               raddr 0.0.0.0 rport 0
   a=end-of-candidates

   m=video 12100 UDP/TLS/RTP/SAVPF 100 101 102 103
   c=IN IP4 192.0.2.100
   a=mid:v1
   a=sendrecv
   a=rtpmap:100 VP8/90000
   a=rtpmap:101 H264/90000
   a=fmtp:101 packetization-mode=1;profile-level-id=42e01f
   a=rtpmap:102 rtx/90000
   a=fmtp:102 apt=100
   a=rtpmap:103 rtx/90000
   a=fmtp:103 apt=101
   a=extmap:1 urn:ietf:params:rtp-hdrext:sdes:mid
   a=extmap:3 urn:ietf:params:rtp-hdrext:sdes:rtp-stream-id
   a=rtcp-fb:100 ccm fir
   a=rtcp-fb:100 nack
   a=rtcp-fb:100 nack pli
   a=msid:bbce3ba6-abfc-ac63-d00a-e15b286f8fce

<span class="h2"><a class="selflink" id="section-8" href="https://datatracker.ietf.org/doc/html/rfc8829#section-8">8</a>.  Security Considerations</span>

   The IETF has published separate documents [<a href="https://datatracker.ietf.org/doc/html/rfc8827" title="&quot;WebRTC Security Architecture&quot;">RFC8827</a>] [<a href="https://datatracker.ietf.org/doc/html/rfc8826" title="&quot;Security Considerations for WebRTC&quot;">RFC8826</a>]
   describing the security architecture for WebRTC as a whole.  The
   remainder of this section describes security considerations for this
   document.

   While formally the JSEP interface is an API, it is better to think of
   it as an Internet protocol, with the application JavaScript being
   untrustworthy from the perspective of the JSEP implementation.  Thus,
   the threat model of [<a href="https://datatracker.ietf.org/doc/html/rfc3552" title="&quot;Guidelines for Writing RFC Text on Security Considerations&quot;">RFC3552</a>] applies.  In particular, JavaScript can
   call the API in any order and with any inputs, including malicious
   ones.  This is particularly relevant when we consider the SDP that is
   passed to setLocalDescription.  While correct API usage requires that
   the application pass in SDP that was derived from createOffer or
   createAnswer, there is no guarantee that applications do so.  The
   JSEP implementation MUST be prepared for the JavaScript to pass in
   bogus data instead.

   Conversely, the application programmer needs to be aware that the
   JavaScript does not have complete control of endpoint behavior.  One
   case that bears particular mention is that editing ICE candidates out
   of the SDP or suppressing trickled candidates does not have the
   expected behavior: implementations will still perform checks from
   those candidates even if they are not sent to the other side.  Thus,
   for instance, it is not possible to prevent the remote peer from
   learning your public IP address by removing server-reflexive
   candidates.  Applications that wish to conceal their public IP
   address MUST instead configure the ICE agent to use only relay
   candidates.

<span class="h2"><a class="selflink" id="section-9" href="https://datatracker.ietf.org/doc/html/rfc8829#section-9">9</a>.  IANA 考量</span>

   本文档没有 IANA 操作。

<span class="h2"><a class="selflink" id="section-10" href="https://datatracker.ietf.org/doc/html/rfc8829#section-10">10</a>.  参考文献</span>

<span class="h3"><a class="selflink" id="section-10.1" href="https://datatracker.ietf.org/doc/html/rfc8829#section-10.1">10.1</a>.  标准引用</span>

   [<a id="ref-RFC2119">RFC2119</a>]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", <a href="https://datatracker.ietf.org/doc/html/bcp14">BCP 14</a>, <a href="https://datatracker.ietf.org/doc/html/rfc2119">RFC 2119</a>,
              DOI 10.17487/RFC2119, March 1997,
              &lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;.

   [<a id="ref-RFC3261">RFC3261</a>]  Rosenberg, J., Schulzrinne, H., Camarillo, G., Johnston,
              A., Peterson, J., Sparks, R., Handley, M., and E.
              Schooler, "SIP: Session Initiation Protocol", <a href="https://datatracker.ietf.org/doc/html/rfc3261">RFC 3261</a>,
              DOI 10.17487/RFC3261, June 2002,
              &lt;<a href="https://www.rfc-editor.org/info/rfc3261">https://www.rfc-editor.org/info/rfc3261</a>&gt;.

   [<a id="ref-RFC3264">RFC3264</a>]  Rosenberg, J. and H. Schulzrinne, "An Offer/Answer Model
              with Session Description Protocol (SDP)", <a href="https://datatracker.ietf.org/doc/html/rfc3264">RFC 3264</a>,
              DOI 10.17487/RFC3264, June 2002,
              &lt;<a href="https://www.rfc-editor.org/info/rfc3264">https://www.rfc-editor.org/info/rfc3264</a>&gt;.

   [<a id="ref-RFC3552">RFC3552</a>]  Rescorla, E. and B. Korver, "Guidelines for Writing RFC
              Text on Security Considerations", <a href="https://datatracker.ietf.org/doc/html/bcp72">BCP 72</a>, <a href="https://datatracker.ietf.org/doc/html/rfc3552">RFC 3552</a>,
              DOI 10.17487/RFC3552, July 2003,
              &lt;<a href="https://www.rfc-editor.org/info/rfc3552">https://www.rfc-editor.org/info/rfc3552</a>&gt;.

   [<a id="ref-RFC3605">RFC3605</a>]  Huitema, C., "Real Time Control Protocol (RTCP) attribute
              in Session Description Protocol (SDP)", <a href="https://datatracker.ietf.org/doc/html/rfc3605">RFC 3605</a>,
              DOI 10.17487/RFC3605, October 2003,
              &lt;<a href="https://www.rfc-editor.org/info/rfc3605">https://www.rfc-editor.org/info/rfc3605</a>&gt;.

   [<a id="ref-RFC3711">RFC3711</a>]  Baugher, M., McGrew, D., Naslund, M., Carrara, E., and K.
              Norrman, "The Secure Real-time Transport Protocol (SRTP)",
              <a href="https://datatracker.ietf.org/doc/html/rfc3711">RFC 3711</a>, DOI 10.17487/RFC3711, March 2004,
              &lt;<a href="https://www.rfc-editor.org/info/rfc3711">https://www.rfc-editor.org/info/rfc3711</a>&gt;.

   [<a id="ref-RFC3890">RFC3890</a>]  Westerlund, M., "A Transport Independent Bandwidth
              Modifier for the Session Description Protocol (SDP)",
              <a href="https://datatracker.ietf.org/doc/html/rfc3890">RFC 3890</a>, DOI 10.17487/RFC3890, September 2004,
              &lt;<a href="https://www.rfc-editor.org/info/rfc3890">https://www.rfc-editor.org/info/rfc3890</a>&gt;.

   [<a id="ref-RFC4145">RFC4145</a>]  Yon, D. and G. Camarillo, "TCP-Based Media Transport in
              the Session Description Protocol (SDP)", <a href="https://datatracker.ietf.org/doc/html/rfc4145">RFC 4145</a>,
              DOI 10.17487/RFC4145, September 2005,
              &lt;<a href="https://www.rfc-editor.org/info/rfc4145">https://www.rfc-editor.org/info/rfc4145</a>&gt;.

   [<a id="ref-RFC4566">RFC4566</a>]  Handley, M., Jacobson, V., and C. Perkins, "SDP: Session
              Description Protocol", <a href="https://datatracker.ietf.org/doc/html/rfc4566">RFC 4566</a>, DOI 10.17487/RFC4566,
              July 2006, &lt;<a href="https://www.rfc-editor.org/info/rfc4566">https://www.rfc-editor.org/info/rfc4566</a>&gt;.

   [<a id="ref-RFC4585">RFC4585</a>]  Ott, J., Wenger, S., Sato, N., Burmeister, C., and J. Rey,
              "Extended RTP Profile for Real-time Transport Control
              Protocol (RTCP)-Based Feedback (RTP/AVPF)", <a href="https://datatracker.ietf.org/doc/html/rfc4585">RFC 4585</a>,
              DOI 10.17487/RFC4585, July 2006,
              &lt;<a href="https://www.rfc-editor.org/info/rfc4585">https://www.rfc-editor.org/info/rfc4585</a>&gt;.

   [<a id="ref-RFC5124">RFC5124</a>]  Ott, J. and E. Carrara, "Extended Secure RTP Profile for
              Real-time Transport Control Protocol (RTCP)-Based Feedback
              (RTP/SAVPF)", <a href="https://datatracker.ietf.org/doc/html/rfc5124">RFC 5124</a>, DOI 10.17487/RFC5124, February
              2008, &lt;<a href="https://www.rfc-editor.org/info/rfc5124">https://www.rfc-editor.org/info/rfc5124</a>&gt;.

   [<a id="ref-RFC5285">RFC5285</a>]  Singer, D. and H. Desineni, "A General Mechanism for RTP
              Header Extensions", <a href="https://datatracker.ietf.org/doc/html/rfc5285">RFC 5285</a>, DOI 10.17487/RFC5285, July
              2008, &lt;<a href="https://www.rfc-editor.org/info/rfc5285">https://www.rfc-editor.org/info/rfc5285</a>&gt;.

   [<a id="ref-RFC5761">RFC5761</a>]  Perkins, C. and M. Westerlund, "Multiplexing RTP Data and
              Control Packets on a Single Port", <a href="https://datatracker.ietf.org/doc/html/rfc5761">RFC 5761</a>,
              DOI 10.17487/RFC5761, April 2010,
              &lt;<a href="https://www.rfc-editor.org/info/rfc5761">https://www.rfc-editor.org/info/rfc5761</a>&gt;.

   [<a id="ref-RFC5888">RFC5888</a>]  Camarillo, G. and H. Schulzrinne, "The Session Description
              Protocol (SDP) Grouping Framework", <a href="https://datatracker.ietf.org/doc/html/rfc5888">RFC 5888</a>,
              DOI 10.17487/RFC5888, June 2010,
              &lt;<a href="https://www.rfc-editor.org/info/rfc5888">https://www.rfc-editor.org/info/rfc5888</a>&gt;.

   [<a id="ref-RFC6236">RFC6236</a>]  Johansson, I. and K. Jung, "Negotiation of Generic Image
              Attributes in the Session Description Protocol (SDP)",
              <a href="https://datatracker.ietf.org/doc/html/rfc6236">RFC 6236</a>, DOI 10.17487/RFC6236, May 2011,
              &lt;<a href="https://www.rfc-editor.org/info/rfc6236">https://www.rfc-editor.org/info/rfc6236</a>&gt;.

   [<a id="ref-RFC6347">RFC6347</a>]  Rescorla, E. and N. Modadugu, "Datagram Transport Layer
              Security Version 1.2", <a href="https://datatracker.ietf.org/doc/html/rfc6347">RFC 6347</a>, DOI 10.17487/RFC6347,
              January 2012, &lt;<a href="https://www.rfc-editor.org/info/rfc6347">https://www.rfc-editor.org/info/rfc6347</a>&gt;.

   [<a id="ref-RFC6716">RFC6716</a>]  Valin, JM., Vos, K., and T. Terriberry, "Definition of the
              Opus Audio Codec", <a href="https://datatracker.ietf.org/doc/html/rfc6716">RFC 6716</a>, DOI 10.17487/RFC6716,
              September 2012, &lt;<a href="https://www.rfc-editor.org/info/rfc6716">https://www.rfc-editor.org/info/rfc6716</a>&gt;.

   [<a id="ref-RFC6904">RFC6904</a>]  Lennox, J., "Encryption of Header Extensions in the Secure
              Real-time Transport Protocol (SRTP)", <a href="https://datatracker.ietf.org/doc/html/rfc6904">RFC 6904</a>,
              DOI 10.17487/RFC6904, April 2013,
              &lt;<a href="https://www.rfc-editor.org/info/rfc6904">https://www.rfc-editor.org/info/rfc6904</a>&gt;.

   [<a id="ref-RFC7160">RFC7160</a>]  Petit-Huguenin, M. and G. Zorn, Ed., "Support for Multiple
              Clock Rates in an RTP Session", <a href="https://datatracker.ietf.org/doc/html/rfc7160">RFC 7160</a>,
              DOI 10.17487/RFC7160, April 2014,
              &lt;<a href="https://www.rfc-editor.org/info/rfc7160">https://www.rfc-editor.org/info/rfc7160</a>&gt;.

   [<a id="ref-RFC7587">RFC7587</a>]  Spittka, J., Vos, K., and JM. Valin, "RTP Payload Format
              for the Opus Speech and Audio Codec", <a href="https://datatracker.ietf.org/doc/html/rfc7587">RFC 7587</a>,
              DOI 10.17487/RFC7587, June 2015,
              &lt;<a href="https://www.rfc-editor.org/info/rfc7587">https://www.rfc-editor.org/info/rfc7587</a>&gt;.

   [<a id="ref-RFC7742">RFC7742</a>]  Roach, A.B., "WebRTC Video Processing and Codec
              Requirements", <a href="https://datatracker.ietf.org/doc/html/rfc7742">RFC 7742</a>, DOI 10.17487/RFC7742, March 2016,
              &lt;<a href="https://www.rfc-editor.org/info/rfc7742">https://www.rfc-editor.org/info/rfc7742</a>&gt;.

   [<a id="ref-RFC7850">RFC7850</a>]  Nandakumar, S., "Registering Values of the SDP 'proto'
              Field for Transporting RTP Media over TCP under Various
              RTP Profiles", <a href="https://datatracker.ietf.org/doc/html/rfc7850">RFC 7850</a>, DOI 10.17487/RFC7850, April 2016,
              &lt;<a href="https://www.rfc-editor.org/info/rfc7850">https://www.rfc-editor.org/info/rfc7850</a>&gt;.

   [<a id="ref-RFC7874">RFC7874</a>]  Valin, JM. and C. Bran, "WebRTC Audio Codec and Processing
              Requirements", <a href="https://datatracker.ietf.org/doc/html/rfc7874">RFC 7874</a>, DOI 10.17487/RFC7874, May 2016,
              &lt;<a href="https://www.rfc-editor.org/info/rfc7874">https://www.rfc-editor.org/info/rfc7874</a>&gt;.

   [<a id="ref-RFC8108">RFC8108</a>]  Lennox, J., Westerlund, M., Wu, Q., and C. Perkins,
              "Sending Multiple RTP Streams in a Single RTP Session",
              <a href="https://datatracker.ietf.org/doc/html/rfc8108">RFC 8108</a>, DOI 10.17487/RFC8108, March 2017,
              &lt;<a href="https://www.rfc-editor.org/info/rfc8108">https://www.rfc-editor.org/info/rfc8108</a>&gt;.

   [<a id="ref-RFC8122">RFC8122</a>]  Lennox, J. and C. Holmberg, "Connection-Oriented Media
              Transport over the Transport Layer Security (TLS) Protocol
              in the Session Description Protocol (SDP)", <a href="https://datatracker.ietf.org/doc/html/rfc8122">RFC 8122</a>,
              DOI 10.17487/RFC8122, March 2017,
              &lt;<a href="https://www.rfc-editor.org/info/rfc8122">https://www.rfc-editor.org/info/rfc8122</a>&gt;.

   [<a id="ref-RFC8174">RFC8174</a>]  Leiba, B., "Ambiguity of Uppercase vs Lowercase in <a href="https://datatracker.ietf.org/doc/html/rfc2119">RFC</a>
              <a href="https://datatracker.ietf.org/doc/html/rfc2119">2119</a> Key Words", <a href="https://datatracker.ietf.org/doc/html/bcp14">BCP 14</a>, <a href="https://datatracker.ietf.org/doc/html/rfc8174">RFC 8174</a>, DOI 10.17487/RFC8174,
              May 2017, &lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;.

   [<a id="ref-RFC8445">RFC8445</a>]  Keranen, A., Holmberg, C., and J. Rosenberg, "Interactive
              Connectivity Establishment (ICE): A Protocol for Network
              Address Translator (NAT) Traversal", <a href="https://datatracker.ietf.org/doc/html/rfc8445">RFC 8445</a>,
              DOI 10.17487/RFC8445, July 2018,
              &lt;<a href="https://www.rfc-editor.org/info/rfc8445">https://www.rfc-editor.org/info/rfc8445</a>&gt;.

   [<a id="ref-RFC8826">RFC8826</a>]  Rescorla, E., "Security Considerations for WebRTC",
              <a href="https://datatracker.ietf.org/doc/html/rfc8826">RFC 8826</a>, DOI 10.17487/RFC8826, January 2021,
              &lt;<a href="https://www.rfc-editor.org/info/rfc8826">https://www.rfc-editor.org/info/rfc8826</a>&gt;.

   [<a id="ref-RFC8827">RFC8827</a>]  Rescorla, E., "WebRTC Security Architecture", <a href="https://datatracker.ietf.org/doc/html/rfc8827">RFC 8827</a>,
              DOI 10.17487/RFC8827, January 2021,
              &lt;<a href="https://www.rfc-editor.org/info/rfc8827">https://www.rfc-editor.org/info/rfc8827</a>&gt;.

   [<a id="ref-RFC8830">RFC8830</a>]  Alvestrand, H., "WebRTC MediaStream Identification in the
              Session Description Protocol", <a href="https://datatracker.ietf.org/doc/html/rfc8830">RFC 8830</a>,
              DOI 10.17487/RFC8830, January 2021,
              &lt;<a href="https://www.rfc-editor.org/info/rfc8830">https://www.rfc-editor.org/info/rfc8830</a>&gt;.

   [<a id="ref-RFC8834">RFC8834</a>]  Perkins, C., Westerlund, M., and J. Ott, "Media Transport
              and Use of RTP in WebRTC", <a href="https://datatracker.ietf.org/doc/html/rfc8834">RFC 8834</a>, DOI 10.17487/RFC8834,
              January 2021, &lt;<a href="https://www.rfc-editor.org/info/rfc8834">https://www.rfc-editor.org/info/rfc8834</a>&gt;.

   [<a id="ref-RFC8838">RFC8838</a>]  Ivov, E., Uberti, J., and P. Saint-Andre, "Trickle ICE:
              Incremental Provisioning of Candidates for the Interactive
              Connectivity Establishment (ICE) Protocol", <a href="https://datatracker.ietf.org/doc/html/rfc8838">RFC 8838</a>,
              DOI 10.17487/RFC8838, January 2021,
              &lt;<a href="https://www.rfc-editor.org/info/rfc8838">https://www.rfc-editor.org/info/rfc8838</a>&gt;.

   [<a id="ref-RFC8839">RFC8839</a>]  Petit-Huguenin, M., Nandakumar, S., Holmberg, C., Keränen,
              A., and R. Shpount, "Session Description Protocol (SDP)
              Offer/Answer Procedures for Interactive Connectivity
              Establishment (ICE)", <a href="https://datatracker.ietf.org/doc/html/rfc8839">RFC 8839</a>, DOI 10.17487/RFC8839,
              January 2021, &lt;<a href="https://www.rfc-editor.org/info/rfc8839">https://www.rfc-editor.org/info/rfc8839</a>&gt;.

   [<a id="ref-RFC8840">RFC8840</a>]  Ivov, E., Stach, T., Marocco, E., and C. Holmberg, "A
              Session Initiation Protocol (SIP) Usage for Incremental
              Provisioning of Candidates for the Interactive
              Connectivity Establishment (Trickle ICE)", <a href="https://datatracker.ietf.org/doc/html/rfc8840">RFC 8840</a>,
              DOI 10.17487/RFC8840, January 2021,
              &lt;<a href="https://www.rfc-editor.org/info/rfc8840">https://www.rfc-editor.org/info/rfc8840</a>&gt;.

   [<a id="ref-RFC8841">RFC8841</a>]  Holmberg, C., Shpount, R., Loreto, S., and G. Camarillo,
              "Session Description Protocol (SDP) Offer/Answer
              Procedures for Stream Control Transmission Protocol (SCTP)
              over Datagram Transport Layer Security (DTLS) Transport",
              <a href="https://datatracker.ietf.org/doc/html/rfc8841">RFC 8841</a>, DOI 10.17487/RFC8841, January 2021,
              &lt;<a href="https://www.rfc-editor.org/info/rfc8841">https://www.rfc-editor.org/info/rfc8841</a>&gt;.

   [<a id="ref-RFC8842">RFC8842</a>]  Holmberg, C. and R. Shpount, "Session Description Protocol
              (SDP) Offer/Answer Considerations for Datagram Transport
              Layer Security (DTLS) and Transport Layer Security (TLS)",
              <a href="https://datatracker.ietf.org/doc/html/rfc8842">RFC 8842</a>, DOI 10.17487/RFC8842, January 2021,
              &lt;<a href="https://www.rfc-editor.org/info/rfc8842">https://www.rfc-editor.org/info/rfc8842</a>&gt;.

   [<a id="ref-RFC8843">RFC8843</a>]  Holmberg, C., Alvestrand, H., and C. Jennings,
              "Negotiating Media Multiplexing Using the Session
              Description Protocol (SDP)", <a href="https://datatracker.ietf.org/doc/html/rfc8843">RFC 8843</a>,
              DOI 10.17487/RFC8843, January 2021,
              &lt;<a href="https://www.rfc-editor.org/info/rfc8843">https://www.rfc-editor.org/info/rfc8843</a>&gt;.

   [<a id="ref-RFC8851">RFC8851</a>]  Roach, A.B., Ed., "RTP Payload Format Restrictions",
              <a href="https://datatracker.ietf.org/doc/html/rfc8851">RFC 8851</a>, DOI 10.17487/RFC8851, January 2021,
              &lt;<a href="https://www.rfc-editor.org/info/rfc8851">https://www.rfc-editor.org/info/rfc8851</a>&gt;.

   [<a id="ref-RFC8852">RFC8852</a>]  Roach, A.B., Nandakumar, S., and P. Thatcher, "RTP Stream
              Identifier Source Description (SDES)", <a href="https://datatracker.ietf.org/doc/html/rfc8852">RFC 8852</a>,
              DOI 10.17487/RFC8852, January 2021,
              &lt;<a href="https://www.rfc-editor.org/info/rfc8852">https://www.rfc-editor.org/info/rfc8852</a>&gt;.

   [<a id="ref-RFC8853">RFC8853</a>]  Burman, B., Westerlund, M., Nandakumar, S., and M. Zanaty,
              "Using Simulcast in Session Description Protocol (SDP) and
              RTP Sessions", <a href="https://datatracker.ietf.org/doc/html/rfc8853">RFC 8853</a>, DOI 10.17487/RFC8853, January
              2021, &lt;<a href="https://www.rfc-editor.org/info/rfc8853">https://www.rfc-editor.org/info/rfc8853</a>&gt;.

   [<a id="ref-RFC8854">RFC8854</a>]  Uberti, J., "WebRTC Forward Error Correction
              Requirements", <a href="https://datatracker.ietf.org/doc/html/rfc8854">RFC 8854</a>, DOI 10.17487/RFC8854, January
              2021, &lt;<a href="https://www.rfc-editor.org/info/rfc8854">https://www.rfc-editor.org/info/rfc8854</a>&gt;.

   [<a id="ref-RFC8858">RFC8858</a>]  Holmberg, C., "Indicating Exclusive Support of RTP and RTP
              Control Protocol (RTCP) Multiplexing Using the Session
              Description Protocol (SDP)", <a href="https://datatracker.ietf.org/doc/html/rfc8858">RFC 8858</a>,
              DOI 10.17487/RFC8858, January 2021,
              &lt;<a href="https://www.rfc-editor.org/info/rfc8858">https://www.rfc-editor.org/info/rfc8858</a>&gt;.

   [<a id="ref-RFC8859">RFC8859</a>]  Nandakumar, S., "A Framework for Session Description
              Protocol (SDP) Attributes When Multiplexing", <a href="https://datatracker.ietf.org/doc/html/rfc8859">RFC 8859</a>,
              DOI 10.17487/RFC8859, January 2021,
              &lt;<a href="https://www.rfc-editor.org/info/rfc8859">https://www.rfc-editor.org/info/rfc8859</a>&gt;.

<span class="h3"><a class="selflink" id="section-10.2" href="https://datatracker.ietf.org/doc/html/rfc8829#section-10.2">10.2</a>.  Informative References</span>

   [<a id="ref-RFC3389">RFC3389</a>]  Zopf, R., "Real-time Transport Protocol (RTP) Payload for
              Comfort Noise (CN)", <a href="https://datatracker.ietf.org/doc/html/rfc3389">RFC 3389</a>, DOI 10.17487/RFC3389,
              September 2002, &lt;<a href="https://www.rfc-editor.org/info/rfc3389">https://www.rfc-editor.org/info/rfc3389</a>&gt;.

   [<a id="ref-RFC3556">RFC3556</a>]  Casner, S., "Session Description Protocol (SDP) Bandwidth
              Modifiers for RTP Control Protocol (RTCP) Bandwidth",
              <a href="https://datatracker.ietf.org/doc/html/rfc3556">RFC 3556</a>, DOI 10.17487/RFC3556, July 2003,
              &lt;<a href="https://www.rfc-editor.org/info/rfc3556">https://www.rfc-editor.org/info/rfc3556</a>&gt;.

   [<a id="ref-RFC3960">RFC3960</a>]  Camarillo, G. and H. Schulzrinne, "Early Media and Ringing
              Tone Generation in the Session Initiation Protocol (SIP)",
              <a href="https://datatracker.ietf.org/doc/html/rfc3960">RFC 3960</a>, DOI 10.17487/RFC3960, December 2004,
              &lt;<a href="https://www.rfc-editor.org/info/rfc3960">https://www.rfc-editor.org/info/rfc3960</a>&gt;.

   [<a id="ref-RFC4568">RFC4568</a>]  Andreasen, F., Baugher, M., and D. Wing, "Session
              Description Protocol (SDP) Security Descriptions for Media
              Streams", <a href="https://datatracker.ietf.org/doc/html/rfc4568">RFC 4568</a>, DOI 10.17487/RFC4568, July 2006,
              &lt;<a href="https://www.rfc-editor.org/info/rfc4568">https://www.rfc-editor.org/info/rfc4568</a>&gt;.

   [<a id="ref-RFC4588">RFC4588</a>]  Rey, J., Leon, D., Miyazaki, A., Varsa, V., and R.
              Hakenberg, "RTP Retransmission Payload Format", <a href="https://datatracker.ietf.org/doc/html/rfc4588">RFC 4588</a>,
              DOI 10.17487/RFC4588, July 2006,
              &lt;<a href="https://www.rfc-editor.org/info/rfc4588">https://www.rfc-editor.org/info/rfc4588</a>&gt;.

   [<a id="ref-RFC4733">RFC4733</a>]  Schulzrinne, H. and T. Taylor, "RTP Payload for DTMF
              Digits, Telephony Tones, and Telephony Signals", <a href="https://datatracker.ietf.org/doc/html/rfc4733">RFC 4733</a>,
              DOI 10.17487/RFC4733, December 2006,
              &lt;<a href="https://www.rfc-editor.org/info/rfc4733">https://www.rfc-editor.org/info/rfc4733</a>&gt;.

   [<a id="ref-RFC5245">RFC5245</a>]  Rosenberg, J., "Interactive Connectivity Establishment
              (ICE): A Protocol for Network Address Translator (NAT)
              Traversal for Offer/Answer Protocols", <a href="https://datatracker.ietf.org/doc/html/rfc5245">RFC 5245</a>,
              DOI 10.17487/RFC5245, April 2010,
              &lt;<a href="https://www.rfc-editor.org/info/rfc5245">https://www.rfc-editor.org/info/rfc5245</a>&gt;.

   [<a id="ref-RFC5506">RFC5506</a>]  Johansson, I. and M. Westerlund, "Support for Reduced-Size
              Real-Time Transport Control Protocol (RTCP): Opportunities
              and Consequences", <a href="https://datatracker.ietf.org/doc/html/rfc5506">RFC 5506</a>, DOI 10.17487/RFC5506, April
              2009, &lt;<a href="https://www.rfc-editor.org/info/rfc5506">https://www.rfc-editor.org/info/rfc5506</a>&gt;.

   [<a id="ref-RFC5576">RFC5576</a>]  Lennox, J., Ott, J., and T. Schierl, "Source-Specific
              Media Attributes in the Session Description Protocol
              (SDP)", <a href="https://datatracker.ietf.org/doc/html/rfc5576">RFC 5576</a>, DOI 10.17487/RFC5576, June 2009,
              &lt;<a href="https://www.rfc-editor.org/info/rfc5576">https://www.rfc-editor.org/info/rfc5576</a>&gt;.

   [<a id="ref-RFC5763">RFC5763</a>]  Fischl, J., Tschofenig, H., and E. Rescorla, "Framework
              for Establishing a Secure Real-time Transport Protocol
              (SRTP) Security Context Using Datagram Transport Layer
              Security (DTLS)", <a href="https://datatracker.ietf.org/doc/html/rfc5763">RFC 5763</a>, DOI 10.17487/RFC5763, May
              2010, &lt;<a href="https://www.rfc-editor.org/info/rfc5763">https://www.rfc-editor.org/info/rfc5763</a>&gt;.

   [<a id="ref-RFC5764">RFC5764</a>]  McGrew, D. and E. Rescorla, "Datagram Transport Layer
              Security (DTLS) Extension to Establish Keys for the Secure
              Real-time Transport Protocol (SRTP)", <a href="https://datatracker.ietf.org/doc/html/rfc5764">RFC 5764</a>,
              DOI 10.17487/RFC5764, May 2010,
              &lt;<a href="https://www.rfc-editor.org/info/rfc5764">https://www.rfc-editor.org/info/rfc5764</a>&gt;.

   [<a id="ref-RFC6120">RFC6120</a>]  Saint-Andre, P., "Extensible Messaging and Presence
              Protocol (XMPP): Core", <a href="https://datatracker.ietf.org/doc/html/rfc6120">RFC 6120</a>, DOI 10.17487/RFC6120,
              March 2011, &lt;<a href="https://www.rfc-editor.org/info/rfc6120">https://www.rfc-editor.org/info/rfc6120</a>&gt;.

   [<a id="ref-RFC6464">RFC6464</a>]  Lennox, J., Ed., Ivov, E., and E. Marocco, "A Real-time
              Transport Protocol (RTP) Header Extension for Client-to-
              Mixer Audio Level Indication", <a href="https://datatracker.ietf.org/doc/html/rfc6464">RFC 6464</a>,
              DOI 10.17487/RFC6464, December 2011,
              &lt;<a href="https://www.rfc-editor.org/info/rfc6464">https://www.rfc-editor.org/info/rfc6464</a>&gt;.

   [<a id="ref-RFC8828">RFC8828</a>]  Uberti, J. and G. Shieh, "WebRTC IP Address Handling
              Requirements", <a href="https://datatracker.ietf.org/doc/html/rfc8828">RFC 8828</a>, DOI 10.17487/RFC8828, January
              2021, &lt;<a href="https://www.rfc-editor.org/info/rfc8828">https://www.rfc-editor.org/info/rfc8828</a>&gt;.

   [<a id="ref-SDP4WebRTC">SDP4WebRTC</a>]
              Nandakumar, S. and C. Jennings, "Annotated Example SDP for
              WebRTC", Work in Progress, Internet-Draft, <a href="https://datatracker.ietf.org/doc/html/draft-ietf-rtcweb-sdp-14">draft-ietf-</a>
              <a href="https://datatracker.ietf.org/doc/html/draft-ietf-rtcweb-sdp-14">rtcweb-sdp-14</a>, 17 December 2020,
              &lt;<a href="https://tools.ietf.org/html/draft-ietf-rtcweb-sdp-14">https://tools.ietf.org/html/draft-ietf-rtcweb-sdp-14</a>&gt;.

   [<a id="ref-TS26.114">TS26.114</a>] 3GPP, "3rd Generation Partnership Project; Technical
              Specification Group Services and System Aspects; IP
              Multimedia Subsystem (IMS); Multimedia Telephony; Media
              handling and interaction (Release 16)", 3GPP TS 26.114
              V16.3.0, September 2019,
              &lt;<a href="https://www.3gpp.org/DynaReport/26114.htm">https://www.3gpp.org/DynaReport/26114.htm</a>&gt;.

   [<a id="ref-W3C.webrtc">W3C.webrtc</a>]
              Jennings, C., Ed., Boström, H., Ed., and J. Bruaroey, Ed.,
              "WebRTC 1.0: Real-time Communication Between Browsers",
              World Wide Web Consortium PR PR-webrtc-20201215, December
              2020, &lt;<a href="https://www.w3.org/TR/2020/PR-webrtc-20201215/">https://www.w3.org/TR/2020/PR-webrtc-20201215/</a>&gt;.

<span class="h2"><a class="selflink" id="appendix-A" href="https://datatracker.ietf.org/doc/html/rfc8829#appendix-A">Appendix A</a>.  SDP ABNF Syntax</span>

   For the syntax validation performed in <a href="https://datatracker.ietf.org/doc/html/rfc8829#section-5.8">Section 5.8</a>, the following
   list of ABNF definitions is used:

          +=========================+==========================+
          | Attribute               | Reference                |
          +=========================+==========================+
          | ptime                   | <a href="https://datatracker.ietf.org/doc/html/rfc4566#section-6">Section&nbsp;6 of [RFC4566]</a>   |
          +-------------------------+--------------------------+
          | maxptime                | <a href="https://datatracker.ietf.org/doc/html/rfc4566#section-6">Section&nbsp;6 of [RFC4566]</a>   |
          +-------------------------+--------------------------+
          | rtpmap                  | <a href="https://datatracker.ietf.org/doc/html/rfc4566#section-6">Section&nbsp;6 of [RFC4566]</a>   |
          +-------------------------+--------------------------+
          | recvonly                | <a href="https://datatracker.ietf.org/doc/html/rfc4566#section-9">Section&nbsp;9 of [RFC4566]</a>   |
          +-------------------------+--------------------------+
          | sendrecv                | <a href="https://datatracker.ietf.org/doc/html/rfc4566#section-9">Section&nbsp;9 of [RFC4566]</a>   |
          +-------------------------+--------------------------+
          | sendonly                | <a href="https://datatracker.ietf.org/doc/html/rfc4566#section-9">Section&nbsp;9 of [RFC4566]</a>   |
          +-------------------------+--------------------------+
          | inactive                | <a href="https://datatracker.ietf.org/doc/html/rfc4566#section-9">Section&nbsp;9 of [RFC4566]</a>   |
          +-------------------------+--------------------------+
          | fmtp                    | <a href="https://datatracker.ietf.org/doc/html/rfc4566#section-9">Section&nbsp;9 of [RFC4566]</a>   |
          +-------------------------+--------------------------+
          | rtcp                    | <a href="https://datatracker.ietf.org/doc/html/rfc3605#section-2.1">Section&nbsp;2.1 of [RFC3605]</a> |
          +-------------------------+--------------------------+
          | setup                   | <a href="https://datatracker.ietf.org/doc/html/rfc4145#section-4">Section&nbsp;4 of [RFC4145]</a>   |
          +-------------------------+--------------------------+
          | fingerprint             | <a href="https://datatracker.ietf.org/doc/html/rfc8122#section-5">Section&nbsp;5 of [RFC8122]</a>   |
          +-------------------------+--------------------------+
          | rtcp-fb                 | <a href="https://datatracker.ietf.org/doc/html/rfc4585#section-4.2">Section&nbsp;4.2 of [RFC4585]</a> |
          +-------------------------+--------------------------+
          | extmap                  | <a href="https://datatracker.ietf.org/doc/html/rfc5285#section-7">Section&nbsp;7 of [RFC5285]</a>   |
          +-------------------------+--------------------------+
          | mid                     | <a href="https://datatracker.ietf.org/doc/html/rfc5888#section-4">Section&nbsp;4 of [RFC5888]</a>   |
          +-------------------------+--------------------------+
          | group                   | <a href="https://datatracker.ietf.org/doc/html/rfc5888#section-5">Section&nbsp;5 of [RFC5888]</a>   |
          +-------------------------+--------------------------+
          | imageattr               | <a href="https://datatracker.ietf.org/doc/html/rfc6236#section-3.1">Section&nbsp;3.1 of [RFC6236]</a> |
          +-------------------------+--------------------------+
          | extmap (encrypt option) | <a href="https://datatracker.ietf.org/doc/html/rfc6904#section-4">Section&nbsp;4 of [RFC6904]</a>   |
          +-------------------------+--------------------------+
          | candidate               | <a href="https://datatracker.ietf.org/doc/html/rfc8839#section-5.1">Section&nbsp;5.1 of [RFC8839]</a> |
          +-------------------------+--------------------------+
          | remote-candidates       | <a href="https://datatracker.ietf.org/doc/html/rfc8839#section-5.2">Section&nbsp;5.2 of [RFC8839]</a> |
          +-------------------------+--------------------------+
          | ice-lite                | <a href="https://datatracker.ietf.org/doc/html/rfc8839#section-5.3">Section&nbsp;5.3 of [RFC8839]</a> |
          +-------------------------+--------------------------+
          | ice-ufrag               | <a href="https://datatracker.ietf.org/doc/html/rfc8839#section-5.4">Section&nbsp;5.4 of [RFC8839]</a> |
          +-------------------------+--------------------------+
          | ice-pwd                 | <a href="https://datatracker.ietf.org/doc/html/rfc8839#section-5.4">Section&nbsp;5.4 of [RFC8839]</a> |
          +-------------------------+--------------------------+
          | ice-options             | <a href="https://datatracker.ietf.org/doc/html/rfc8839#section-5.6">Section&nbsp;5.6 of [RFC8839]</a> |
          +-------------------------+--------------------------+
          | msid                    | <a href="https://datatracker.ietf.org/doc/html/rfc8830#section-3">Section&nbsp;3 of [RFC8830]</a>   |
          +-------------------------+--------------------------+
          | rid                     | <a href="https://datatracker.ietf.org/doc/html/rfc8851#section-10">Section&nbsp;10 of [RFC8851]</a>  |
          +-------------------------+--------------------------+
          | simulcast               | <a href="https://datatracker.ietf.org/doc/html/rfc8853#section-5.1">Section&nbsp;5.1 of [RFC8853]</a> |
          +-------------------------+--------------------------+
          | tls-id                  | <a href="https://datatracker.ietf.org/doc/html/rfc8842#section-4">Section&nbsp;4 of [RFC8842]</a>   |
          +-------------------------+--------------------------+

                       Table 1: SDP ABNF References

Acknowledgements

   Harald Alvestrand, Taylor Brandstetter, Suhas Nandakumar, and Peter
   Thatcher provided significant text for this document.  Bernard Aboba,
   Adam Bergkvist, Jan-Ivar Bruaroey, Dan Burnett, Ben Campbell, Alissa
   Cooper, Richard Ejzak, Stefan Håkansson, Ted Hardie, Christer
   Holmberg, Andrew Hutton, Randell Jesup, Matthew Kaufman, Anant
   Narayanan, Adam Roach, Robert Sparks, Neil Stratford, Martin Thomson,
   Sean Turner, and Magnus Westerlund all provided valuable feedback on
   this document.

Authors' Addresses

   Justin Uberti
   Google
   747 6th Street South
   Kirkland, WA 98033
   United States of America

   Email: justin@uberti.name


   Cullen Jennings
   Cisco
   400 3rd Avenue SW
   Calgary AB T2P 4H2
   Canada

   Email: fluffy@iii.ca


   Eric Rescorla (editor)
   Mozilla

   Email: ekr@rtfm.com
</pre>
    </div>

  </div>



	  </div>








    <script type="text/javascript"><!--
    var legend_html = "Colour legend:<br /> \
     <table> \
        <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
    </table>";
    function showLegend() {
        var elem = document.getElementById('legend');
        elem.innerHTML = legend_html
        elem.style.visibility='visible';
    }
    function hideLegend() {
        var elem = document.getElementById('legend');
        elem.style.visibility='hidden';
        elem.innerHTML = "";
    }
    // -->
    </script>


</body></html>